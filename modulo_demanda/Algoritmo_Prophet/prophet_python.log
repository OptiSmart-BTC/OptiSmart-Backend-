Combinación BMX_1727-BMX_AUTOSERVICIOS-BMX_3203 descartada por tener menos de 100 registros.
Combinación BMX_1727-BMX_HOGAR-BMX_3207 descartada por tener menos de 100 registros.
Combinación BMX_1727-BMX_HOGAR-BMX_3402 descartada por tener menos de 100 registros.
Combinación BMX_1727-BMX_OXXO-BMX_3001 descartada por tener más del 10.0% de ceros.
Combinación BMX_1727-BMX_OXXO-BMX_3207 descartada por tener más del 10.0% de ceros.
Combinación BMX_1727-BMX_OXXO-BMX_3402 descartada por tener más del 10.0% de ceros.
Combinación BMX_1727-BMX_OXXO-BMX_3931 descartada por tener más del 10.0% de ceros.
Combinación BMX_1727-BMX_OXXO-BMX_3203 descartada por tener menos de 100 registros.
Combinación BMX_1727-BMX_TRADICIONAL-BMX_3001 descartada por tener más del 10.0% de ceros.
Combinación BMX_1727-BMX_TRADICIONAL-BMX_3207 descartada por tener más del 10.0% de ceros.
Combinación BMX_1727-BMX_TRADICIONAL-BMX_3402 descartada por tener más del 10.0% de ceros.
Combinación BMX_1727-BMX_TRADICIONAL-BMX_3931 descartada por tener más del 10.0% de ceros.
Combinación BMX_1727-BMX_TRADICIONAL-BMX_3203 descartada por tener menos de 100 registros.
Combinación BMX_2-BMX_AUTOSERVICIOS-BMX_3207 descartada por tener menos de 100 registros.
Combinación BMX_2-BMX_AUTOSERVICIOS-BMX_3402 descartada por tener menos de 100 registros.
Combinación BMX_2-BMX_AUTOSERVICIOS-BMX_3931 descartada por tener menos de 100 registros.
Combinación BMX_2-BMX_AUTOSERVICIOS-BMX_3203 descartada por tener menos de 100 registros.
Combinación BMX_2-BMX_HOGAR-BMX_3207 descartada por tener más del 10.0% de ceros.
Combinación BMX_2-BMX_HOGAR-BMX_3402 descartada por tener menos de 100 registros.
Combinación BMX_2-BMX_OXXO-BMX_3203 descartada por tener menos de 100 registros.
Combinación BMX_2-BMX_TRADICIONAL-BMX_3203 descartada por tener menos de 100 registros.
Combinación BMX_310-BMX_AUTOSERVICIOS-BMX_3203 descartada por tener menos de 100 registros.
Combinación BMX_310-BMX_HOGAR-BMX_3402 descartada por tener menos de 100 registros.
Combinación BMX_310-BMX_OXXO-BMX_3203 descartada por tener menos de 100 registros.
Combinación BMX_310-BMX_TRADICIONAL-BMX_3203 descartada por tener menos de 100 registros.
Combinación BMX_6-BMX_AUTOSERVICIOS-BMX_3001 descartada por tener menos de 100 registros.
Combinación BMX_6-BMX_AUTOSERVICIOS-BMX_3207 descartada por tener menos de 100 registros.
Combinación BMX_6-BMX_AUTOSERVICIOS-BMX_3402 descartada por tener menos de 100 registros.
Combinación BMX_6-BMX_AUTOSERVICIOS-BMX_3931 descartada por tener menos de 100 registros.
Combinación BMX_6-BMX_AUTOSERVICIOS-BMX_3203 descartada por tener menos de 100 registros.
Combinación BMX_6-BMX_HOGAR-BMX_3207 descartada por tener más del 10.0% de ceros.
Combinación BMX_6-BMX_HOGAR-BMX_3402 descartada por tener menos de 100 registros.
Combinación BMX_6-BMX_OXXO-BMX_3402 descartada por tener más del 10.0% de ceros.
Combinación BMX_6-BMX_OXXO-BMX_3203 descartada por tener menos de 100 registros.
Combinación BMX_6-BMX_TRADICIONAL-BMX_3203 descartada por tener menos de 100 registros.
Combinación BMX_997-BMX_AUTOSERVICIOS-BMX_3001 descartada por tener menos de 100 registros.
Combinación BMX_997-BMX_AUTOSERVICIOS-BMX_3207 descartada por tener menos de 100 registros.
Combinación BMX_997-BMX_AUTOSERVICIOS-BMX_3402 descartada por tener menos de 100 registros.
Combinación BMX_997-BMX_AUTOSERVICIOS-BMX_3931 descartada por tener menos de 100 registros.
Combinación BMX_997-BMX_AUTOSERVICIOS-BMX_3203 descartada por tener menos de 100 registros.
Combinación BMX_997-BMX_HOGAR-BMX_3207 descartada por tener menos de 100 registros.
Combinación BMX_997-BMX_HOGAR-BMX_3402 descartada por tener menos de 100 registros.
Combinación BMX_997-BMX_OXXO-BMX_3001 descartada por tener más del 10.0% de ceros.
Combinación BMX_997-BMX_OXXO-BMX_3207 descartada por tener menos de 100 registros.
Combinación BMX_997-BMX_OXXO-BMX_3402 descartada por tener más del 10.0% de ceros.
Combinación BMX_997-BMX_OXXO-BMX_3931 descartada por tener más del 10.0% de ceros.
Combinación BMX_997-BMX_OXXO-BMX_3203 descartada por tener menos de 100 registros.
Combinación BMX_997-BMX_TRADICIONAL-BMX_3203 descartada por tener menos de 100 registros.
Total de combinaciones válidas: 52
Contenido de df_prophet antes de model.fit:
            ds      y  day_of_week  week_of_year  month
0   2021-01-04  435.0            0             1      1
1   2021-01-11  809.0            0             2      1
2   2021-01-18  641.0            0             3      1
3   2021-01-25  777.0            0             4      1
4   2021-02-01  770.0            0             5      2
..         ...    ...          ...           ...    ...
151 2023-11-27  507.0            0            48     11
152 2023-12-04  718.0            0            49     12
153 2023-12-11  462.0            0            50     12
154 2023-12-18  554.0            0            51     12
155 2023-12-25  751.0            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:20:14,228] A new study created in memory with name: no-name-9bee684d-2127-48b7-8b5a-e75331544c7a
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.41s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.62s/it]100%|##########| 2/2 [00:03<00:00,  1.59s/it]
[I 2025-05-23 20:20:19,160] Trial 0 finished with value: 228.61373415492753 and parameters: {'changepoint_prior_scale': 0.00337829871896594, 'seasonality_prior_scale': 0.4567674911900522, 'n_changepoints': 21}. Best is trial 0 with value: 228.61373415492753.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.39s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.57s/it]100%|##########| 2/2 [00:03<00:00,  1.54s/it]
[I 2025-05-23 20:20:23,757] Trial 1 finished with value: 227.9064594668527 and parameters: {'changepoint_prior_scale': 0.007697921714855544, 'seasonality_prior_scale': 0.24445456918501446, 'n_changepoints': 19}. Best is trial 1 with value: 227.9064594668527.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.44s/it]100%|##########| 2/2 [00:03<00:00,  1.46s/it]100%|##########| 2/2 [00:03<00:00,  1.61s/it]
[I 2025-05-23 20:20:28,679] Trial 2 finished with value: 270.35139333924974 and parameters: {'changepoint_prior_scale': 0.16673155137620632, 'seasonality_prior_scale': 2.658158555160279, 'n_changepoints': 18}. Best is trial 1 with value: 227.9064594668527.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.32s/it]100%|##########| 2/2 [00:04<00:00,  1.87s/it]100%|##########| 2/2 [00:04<00:00,  2.09s/it]
[I 2025-05-23 20:20:34,558] Trial 3 finished with value: 299.6267019709393 and parameters: {'changepoint_prior_scale': 0.3836553212085182, 'seasonality_prior_scale': 0.32556893999947023, 'n_changepoints': 35}. Best is trial 1 with value: 227.9064594668527.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.78s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.76s/it]100%|##########| 2/2 [00:03<00:00,  1.76s/it]
[I 2025-05-23 20:20:39,710] Trial 4 finished with value: 178.64054997557292 and parameters: {'changepoint_prior_scale': 0.004801582203636634, 'seasonality_prior_scale': 0.011018498302295714, 'n_changepoints': 39}. Best is trial 4 with value: 178.64054997557292.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.72s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.60s/it]100%|##########| 2/2 [00:03<00:00,  1.62s/it]
[I 2025-05-23 20:20:44,603] Trial 5 finished with value: 216.21065872651195 and parameters: {'changepoint_prior_scale': 0.0023658547988432716, 'seasonality_prior_scale': 0.048616957981055135, 'n_changepoints': 6}. Best is trial 4 with value: 178.64054997557292.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.48s/it]100%|##########| 2/2 [00:03<00:00,  1.50s/it]100%|##########| 2/2 [00:03<00:00,  1.65s/it]
[I 2025-05-23 20:20:49,321] Trial 6 finished with value: 227.19277004050892 and parameters: {'changepoint_prior_scale': 0.022413387709562346, 'seasonality_prior_scale': 4.27442018967027, 'n_changepoints': 25}. Best is trial 4 with value: 178.64054997557292.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:04<00:04,  4.00s/it]100%|##########| 2/2 [00:04<00:00,  2.09s/it]100%|##########| 2/2 [00:04<00:00,  2.38s/it]
[I 2025-05-23 20:20:55,714] Trial 7 finished with value: 275.216863014794 and parameters: {'changepoint_prior_scale': 0.4195434332161158, 'seasonality_prior_scale': 0.0525965849410747, 'n_changepoints': 46}. Best is trial 4 with value: 178.64054997557292.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.59s/it]100%|##########| 2/2 [00:02<00:00,  1.05s/it]100%|##########| 2/2 [00:02<00:00,  1.13s/it]
[I 2025-05-23 20:20:59,343] Trial 8 finished with value: 243.26994702310975 and parameters: {'changepoint_prior_scale': 0.2250704709420427, 'seasonality_prior_scale': 0.012759112147767667, 'n_changepoints': 16}. Best is trial 4 with value: 178.64054997557292.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:05<00:05,  5.08s/it]100%|##########| 2/2 [00:05<00:00,  2.57s/it]100%|##########| 2/2 [00:05<00:00,  2.95s/it]
[I 2025-05-23 20:21:06,502] Trial 9 finished with value: 315.0126199496506 and parameters: {'changepoint_prior_scale': 0.4376258255646863, 'seasonality_prior_scale': 1.2355395457153948, 'n_changepoints': 42}. Best is trial 4 with value: 178.64054997557292.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.22s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.28s/it]100%|##########| 2/2 [00:02<00:00,  1.27s/it]
Rendimiento para la combinación BMX_1727-BMX_AUTOSERVICIOS-BMX_3001:
  horizon           mse        rmse  ...     mdape     smape  coverage
0 21 days  22227.601610  149.089240  ...  0.129085  0.163998  0.833333
1 28 days  25022.047907  158.183589  ...  0.184889  0.189240  0.833333
2 35 days  52339.468107  228.778207  ...  0.253677  0.443033  0.666667
3 42 days  80093.646330  283.008209  ...  0.322427  0.542033  0.500000
4 49 days  83870.582994  289.604183  ...  0.302671  0.539981  0.333333

[5 rows x 8 columns]
          ds        yhat  yhat_lower  yhat_upper      y     cutoff
0 2022-10-24  664.905779  511.488962  829.423606  614.0 2022-10-17
1 2022-10-31  608.051892  451.326634  763.421254  668.0 2022-10-17
2 2022-11-07  684.678648  524.213569  837.028683  607.0 2022-10-17
3 2022-11-14  697.276108  546.928083  860.370182  550.0 2022-10-17
4 2022-11-21  456.443595  303.370608  606.448188   59.0 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds      y  day_of_week  week_of_year  month
0   2021-01-04  123.0            0             1      1
1   2021-01-11   98.0            0             2      1
2   2021-01-18  107.0            0             3      1
3   2021-01-25  121.0            0             4      1
4   2021-02-01   98.0            0             5      2
..         ...    ...          ...           ...    ...
151 2023-11-27   49.0            0            48     11
152 2023-12-04  111.0            0            49     12
153 2023-12-11  112.0            0            50     12
154 2023-12-18  114.0            0            51     12
155 2023-12-25   75.0            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:21:09,914] A new study created in memory with name: no-name-dbaccf7d-eb90-4f1e-89c2-ffa562027f9c
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:05<00:05,  5.03s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:06<00:00,  2.72s/it]100%|##########| 2/2 [00:06<00:00,  3.07s/it]
[I 2025-05-23 20:21:16,792] Trial 0 finished with value: 59.73875501492009 and parameters: {'changepoint_prior_scale': 0.0024533307085751136, 'seasonality_prior_scale': 2.0852936733519014, 'n_changepoints': 20}. Best is trial 0 with value: 59.73875501492009.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.05s/it]100%|##########| 2/2 [00:01<00:00,  1.22it/s]100%|##########| 2/2 [00:01<00:00,  1.17it/s]
[I 2025-05-23 20:21:19,540] Trial 1 finished with value: 59.48568789607501 and parameters: {'changepoint_prior_scale': 0.1275312348206572, 'seasonality_prior_scale': 0.12982231770499697, 'n_changepoints': 14}. Best is trial 1 with value: 59.48568789607501.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.07s/it]100%|##########| 2/2 [00:01<00:00,  1.20it/s]100%|##########| 2/2 [00:01<00:00,  1.15it/s]
[I 2025-05-23 20:21:22,079] Trial 2 finished with value: 52.84347489203507 and parameters: {'changepoint_prior_scale': 0.007158165280740889, 'seasonality_prior_scale': 0.010555647498960923, 'n_changepoints': 28}. Best is trial 2 with value: 52.84347489203507.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.33s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:04<00:00,  2.16s/it]100%|##########| 2/2 [00:04<00:00,  2.34s/it]
[I 2025-05-23 20:21:27,781] Trial 3 finished with value: 51.25525711222855 and parameters: {'changepoint_prior_scale': 0.004177088633237376, 'seasonality_prior_scale': 0.01566553110938722, 'n_changepoints': 42}. Best is trial 3 with value: 51.25525711222855.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.10it/s]100%|##########| 2/2 [00:01<00:00,  1.45it/s]100%|##########| 2/2 [00:01<00:00,  1.38it/s]
[I 2025-05-23 20:21:30,153] Trial 4 finished with value: 57.948934857832 and parameters: {'changepoint_prior_scale': 0.052228891272746165, 'seasonality_prior_scale': 0.065436379222725, 'n_changepoints': 13}. Best is trial 3 with value: 51.25525711222855.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.12s/it]100%|##########| 2/2 [00:01<00:00,  1.18it/s]100%|##########| 2/2 [00:01<00:00,  1.13it/s]
[I 2025-05-23 20:21:32,947] Trial 5 finished with value: 58.626298955433924 and parameters: {'changepoint_prior_scale': 0.015030656005016907, 'seasonality_prior_scale': 0.03962650616585914, 'n_changepoints': 41}. Best is trial 3 with value: 51.25525711222855.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.23s/it]100%|##########| 2/2 [00:01<00:00,  1.10it/s]100%|##########| 2/2 [00:01<00:00,  1.04it/s]
[I 2025-05-23 20:21:35,888] Trial 6 finished with value: 62.09947170734877 and parameters: {'changepoint_prior_scale': 0.1130267204218307, 'seasonality_prior_scale': 2.7555678787698157, 'n_changepoints': 33}. Best is trial 3 with value: 51.25525711222855.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.63s/it]100%|##########| 2/2 [00:02<00:00,  1.02it/s]100%|##########| 2/2 [00:02<00:00,  1.08s/it]
[I 2025-05-23 20:21:38,830] Trial 7 finished with value: 68.10991009655451 and parameters: {'changepoint_prior_scale': 0.004330944170282588, 'seasonality_prior_scale': 0.9261403237148829, 'n_changepoints': 11}. Best is trial 3 with value: 51.25525711222855.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.17it/s]100%|##########| 2/2 [00:01<00:00,  1.26it/s]100%|##########| 2/2 [00:01<00:00,  1.25it/s]
[I 2025-05-23 20:21:41,281] Trial 8 finished with value: 69.0288156474288 and parameters: {'changepoint_prior_scale': 0.02193526554478495, 'seasonality_prior_scale': 9.155302934190324, 'n_changepoints': 15}. Best is trial 3 with value: 51.25525711222855.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.08s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.33s/it]100%|##########| 2/2 [00:02<00:00,  1.29s/it]
[I 2025-05-23 20:21:44,575] Trial 9 finished with value: 60.865700258116505 and parameters: {'changepoint_prior_scale': 0.0027641546387415514, 'seasonality_prior_scale': 3.948839401376478, 'n_changepoints': 27}. Best is trial 3 with value: 51.25525711222855.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.77s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:05<00:00,  2.35s/it]100%|##########| 2/2 [00:05<00:00,  2.56s/it]
Rendimiento para la combinación BMX_1727-BMX_AUTOSERVICIOS-BMX_3207:
  horizon          mse       rmse        mae     mdape     smape  coverage
0 21 days  4533.236859  67.329316  58.006535  0.817704  0.727857  0.500000
1 28 days  3805.122406  61.685674  48.666550  0.547842  0.621894  0.666667
2 35 days  3254.522776  57.048425  42.429403  0.371121  0.594526  0.666667
3 42 days  1020.283170  31.941872  26.739984  0.328200  0.317710  0.833333
4 49 days  1338.987120  36.592173  31.637658  0.391440  0.376333  0.833333
          ds        yhat  yhat_lower  yhat_upper      y     cutoff
0 2022-10-24  107.009728   54.115510  161.263006   55.0 2022-10-17
1 2022-10-31  116.744498   65.206158  171.196840   71.0 2022-10-17
2 2022-11-07  130.878399   78.626172  186.741160  134.0 2022-10-17
3 2022-11-14  121.917139   67.512929  177.113002   84.0 2022-10-17
4 2022-11-21   43.094269  -10.192892   95.424442  101.0 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds     y  day_of_week  week_of_year  month
0   2021-01-04  37.0            0             1      1
1   2021-01-11  51.0            0             2      1
2   2021-01-18  36.0            0             3      1
3   2021-01-25  45.0            0             4      1
4   2021-02-01  37.0            0             5      2
..         ...   ...          ...           ...    ...
151 2023-11-27  20.0            0            48     11
152 2023-12-04  22.0            0            49     12
153 2023-12-11  20.0            0            50     12
154 2023-12-18  30.0            0            51     12
155 2023-12-25  35.0            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:21:50,679] A new study created in memory with name: no-name-038f3b71-a1b2-49ca-8704-501617c9c4af
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.04s/it]100%|##########| 2/2 [00:02<00:00,  1.30s/it]100%|##########| 2/2 [00:02<00:00,  1.41s/it]
[I 2025-05-23 20:21:54,332] Trial 0 finished with value: 15.404176044514482 and parameters: {'changepoint_prior_scale': 0.028883805888496348, 'seasonality_prior_scale': 1.7840778568506994, 'n_changepoints': 47}. Best is trial 0 with value: 15.404176044514482.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.04s/it]100%|##########| 2/2 [00:01<00:00,  1.18it/s]100%|##########| 2/2 [00:01<00:00,  1.14it/s]
[I 2025-05-23 20:21:57,575] Trial 1 finished with value: 15.20668000183975 and parameters: {'changepoint_prior_scale': 0.014737133646570814, 'seasonality_prior_scale': 0.34401110069919255, 'n_changepoints': 13}. Best is trial 1 with value: 15.20668000183975.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.42s/it]100%|##########| 2/2 [00:01<00:00,  1.10it/s]100%|##########| 2/2 [00:01<00:00,  1.01it/s]
[I 2025-05-23 20:22:00,482] Trial 2 finished with value: 14.238443508329523 and parameters: {'changepoint_prior_scale': 0.04748329632740527, 'seasonality_prior_scale': 0.03947987796802551, 'n_changepoints': 32}. Best is trial 2 with value: 14.238443508329523.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.21it/s]100%|##########| 2/2 [00:01<00:00,  1.49it/s]100%|##########| 2/2 [00:01<00:00,  1.44it/s]
[I 2025-05-23 20:22:02,772] Trial 3 finished with value: 12.305589600655601 and parameters: {'changepoint_prior_scale': 0.11276293663463403, 'seasonality_prior_scale': 0.027486501141355237, 'n_changepoints': 6}. Best is trial 3 with value: 12.305589600655601.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.29s/it]100%|##########| 2/2 [00:01<00:00,  1.08it/s]100%|##########| 2/2 [00:01<00:00,  1.02it/s]
[I 2025-05-23 20:22:05,742] Trial 4 finished with value: 14.166351735967497 and parameters: {'changepoint_prior_scale': 0.16926714660529674, 'seasonality_prior_scale': 2.7254351147984335, 'n_changepoints': 6}. Best is trial 3 with value: 12.305589600655601.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.04s/it]100%|##########| 2/2 [00:01<00:00,  1.28it/s]100%|##########| 2/2 [00:01<00:00,  1.22it/s]
[I 2025-05-23 20:22:09,079] Trial 5 finished with value: 17.23420964264773 and parameters: {'changepoint_prior_scale': 0.001251807812416186, 'seasonality_prior_scale': 0.0109017199572802, 'n_changepoints': 29}. Best is trial 3 with value: 12.305589600655601.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.06it/s]100%|##########| 2/2 [00:01<00:00,  1.38it/s]100%|##########| 2/2 [00:01<00:00,  1.32it/s]
[I 2025-05-23 20:22:12,356] Trial 6 finished with value: 15.918348533713655 and parameters: {'changepoint_prior_scale': 0.005892209978728923, 'seasonality_prior_scale': 0.2664255859687305, 'n_changepoints': 35}. Best is trial 3 with value: 12.305589600655601.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.02s/it]100%|##########| 2/2 [00:02<00:00,  1.26s/it]100%|##########| 2/2 [00:02<00:00,  1.38s/it]
[I 2025-05-23 20:22:16,117] Trial 7 finished with value: 16.308079553961853 and parameters: {'changepoint_prior_scale': 0.05959938692199408, 'seasonality_prior_scale': 7.61653386575292, 'n_changepoints': 44}. Best is trial 3 with value: 12.305589600655601.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.17s/it]100%|##########| 2/2 [00:02<00:00,  1.34s/it]100%|##########| 2/2 [00:02<00:00,  1.46s/it]
[I 2025-05-23 20:22:19,860] Trial 8 finished with value: 9.358800335682966 and parameters: {'changepoint_prior_scale': 0.28385369130676735, 'seasonality_prior_scale': 0.012342321593935612, 'n_changepoints': 34}. Best is trial 8 with value: 9.358800335682966.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.28s/it]100%|##########| 2/2 [00:01<00:00,  1.08it/s]100%|##########| 2/2 [00:01<00:00,  1.02it/s]
[I 2025-05-23 20:22:24,019] Trial 9 finished with value: 16.156658147323846 and parameters: {'changepoint_prior_scale': 0.004903396586801107, 'seasonality_prior_scale': 0.6362830284758072, 'n_changepoints': 40}. Best is trial 8 with value: 9.358800335682966.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.13s/it]100%|##########| 2/2 [00:02<00:00,  1.35s/it]100%|##########| 2/2 [00:02<00:00,  1.47s/it]
Rendimiento para la combinación BMX_1727-BMX_AUTOSERVICIOS-BMX_3402:
  horizon        mse      rmse       mae     mdape     smape  coverage
0 21 days  14.357096  3.789076  2.937132  0.081644  0.140249  1.000000
1 28 days  56.367767  7.507847  5.295323  0.168523  0.230959  0.833333
2 35 days  80.947749  8.997097  7.723518  0.342297  0.362259  0.833333
3 42 days  76.467952  8.744596  7.444405  0.330634  0.355910  0.833333
4 49 days  82.541458  9.085233  8.004966  0.317132  0.377900  1.000000
          ds       yhat  yhat_lower  yhat_upper     y     cutoff
0 2022-10-24  19.496862    3.203292   35.107794  14.0 2022-10-17
1 2022-10-31  17.424771    0.759947   33.611006  17.0 2022-10-17
2 2022-11-07  19.622423    3.017817   33.879727  18.0 2022-10-17
3 2022-11-14  18.689879    1.928544   35.073780  13.0 2022-10-17
4 2022-11-21  32.917653   15.713925   50.018448  38.0 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds      y  day_of_week  week_of_year  month
0   2021-01-04  197.0            0             1      1
1   2021-01-11  137.0            0             2      1
2   2021-01-18  244.0            0             3      1
3   2021-01-25  113.0            0             4      1
4   2021-02-01  171.0            0             5      2
..         ...    ...          ...           ...    ...
151 2023-11-27   86.0            0            48     11
152 2023-12-04   48.0            0            49     12
153 2023-12-11   97.0            0            50     12
154 2023-12-18  159.0            0            51     12
155 2023-12-25  134.0            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:22:27,925] A new study created in memory with name: no-name-8cef6e00-611a-413e-a92e-a3fc92014eea
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.87s/it]100%|##########| 2/2 [00:02<00:00,  1.17s/it]100%|##########| 2/2 [00:02<00:00,  1.27s/it]
[I 2025-05-23 20:22:32,068] Trial 0 finished with value: 48.19306469344046 and parameters: {'changepoint_prior_scale': 0.21687853900390477, 'seasonality_prior_scale': 0.09085925333146226, 'n_changepoints': 36}. Best is trial 0 with value: 48.19306469344046.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.75s/it]100%|##########| 2/2 [00:02<00:00,  1.19s/it]100%|##########| 2/2 [00:02<00:00,  1.28s/it]
[I 2025-05-23 20:22:35,705] Trial 1 finished with value: 51.042989780270275 and parameters: {'changepoint_prior_scale': 0.010182387591429415, 'seasonality_prior_scale': 0.04497069611524377, 'n_changepoints': 19}. Best is trial 0 with value: 48.19306469344046.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.42s/it]100%|##########| 2/2 [00:02<00:00,  1.07it/s]100%|##########| 2/2 [00:02<00:00,  1.01s/it]
[I 2025-05-23 20:22:38,981] Trial 2 finished with value: 54.35191309770059 and parameters: {'changepoint_prior_scale': 0.0086895433078192, 'seasonality_prior_scale': 3.7410675016860178, 'n_changepoints': 20}. Best is trial 0 with value: 48.19306469344046.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.56s/it]100%|##########| 2/2 [00:02<00:00,  1.01it/s]100%|##########| 2/2 [00:02<00:00,  1.07s/it]
[I 2025-05-23 20:22:42,246] Trial 3 finished with value: 49.83496455011662 and parameters: {'changepoint_prior_scale': 0.09835760286744298, 'seasonality_prior_scale': 2.524865680926713, 'n_changepoints': 23}. Best is trial 0 with value: 48.19306469344046.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.24s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.14s/it]100%|##########| 2/2 [00:02<00:00,  1.16s/it]
[I 2025-05-23 20:22:45,736] Trial 4 finished with value: 47.38547527437329 and parameters: {'changepoint_prior_scale': 0.001379936142257974, 'seasonality_prior_scale': 0.03309465157389637, 'n_changepoints': 25}. Best is trial 4 with value: 47.38547527437329.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.22s/it]100%|##########| 2/2 [00:01<00:00,  1.10it/s]100%|##########| 2/2 [00:01<00:00,  1.05it/s]
[I 2025-05-23 20:22:48,603] Trial 5 finished with value: 55.31362147549095 and parameters: {'changepoint_prior_scale': 0.02011545344543864, 'seasonality_prior_scale': 9.228225837948674, 'n_changepoints': 38}. Best is trial 4 with value: 47.38547527437329.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.21s/it]100%|##########| 2/2 [00:01<00:00,  1.18it/s]100%|##########| 2/2 [00:01<00:00,  1.11it/s]
[I 2025-05-23 20:22:51,356] Trial 6 finished with value: 55.225035812292816 and parameters: {'changepoint_prior_scale': 0.004881298328919357, 'seasonality_prior_scale': 8.945801219288967, 'n_changepoints': 13}. Best is trial 4 with value: 47.38547527437329.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.19s/it]100%|##########| 2/2 [00:01<00:00,  1.19it/s]100%|##########| 2/2 [00:01<00:00,  1.12it/s]
[I 2025-05-23 20:22:54,158] Trial 7 finished with value: 54.73919941679346 and parameters: {'changepoint_prior_scale': 0.015749924744059295, 'seasonality_prior_scale': 3.481269322346457, 'n_changepoints': 24}. Best is trial 4 with value: 47.38547527437329.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.46s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.54s/it]100%|##########| 2/2 [00:03<00:00,  1.53s/it]
[I 2025-05-23 20:22:58,096] Trial 8 finished with value: 53.6164544502572 and parameters: {'changepoint_prior_scale': 0.0011615387443236593, 'seasonality_prior_scale': 2.294001294108245, 'n_changepoints': 49}. Best is trial 4 with value: 47.38547527437329.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.35s/it]100%|##########| 2/2 [00:01<00:00,  1.11it/s]100%|##########| 2/2 [00:01<00:00,  1.03it/s]
[I 2025-05-23 20:23:00,929] Trial 9 finished with value: 53.48755992522848 and parameters: {'changepoint_prior_scale': 0.019117543127657337, 'seasonality_prior_scale': 0.11460375326945864, 'n_changepoints': 49}. Best is trial 4 with value: 47.38547527437329.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.07s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.24s/it]100%|##########| 2/2 [00:02<00:00,  1.22s/it]
Rendimiento para la combinación BMX_1727-BMX_AUTOSERVICIOS-BMX_3931:
  horizon          mse       rmse  ...     mdape     smape  coverage
0 21 days  6052.012343  77.794681  ...  0.175801  0.266038  0.833333
1 28 days  6971.396014  83.494886  ...  0.251080  0.335756  0.666667
2 35 days  3523.167077  59.356272  ...  0.179593  0.283731  0.666667
3 42 days  4334.674460  65.838245  ...  0.328685  0.318645  0.500000
4 49 days  3718.615319  60.980450  ...  0.252269  0.305619  0.666667

[5 rows x 8 columns]
          ds        yhat  yhat_lower  yhat_upper      y     cutoff
0 2022-10-24  195.404871  126.317999  266.253527  196.0 2022-10-17
1 2022-10-31  289.412378  217.103379  359.677717  111.0 2022-10-17
2 2022-11-07  189.525278  115.845465  255.563021  150.0 2022-10-17
3 2022-11-14  209.476881  141.204888  277.407415  135.0 2022-10-17
4 2022-11-21  206.184077  137.285400  278.029475   90.0 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds       y  day_of_week  week_of_year  month
0   2021-01-04  121.75            0             1      1
1   2021-01-11  103.00            0             2      1
2   2021-01-18  111.00            0             3      1
3   2021-01-25  148.00            0             4      1
4   2021-02-01  150.00            0             5      2
..         ...     ...          ...           ...    ...
151 2023-11-27   18.00            0            48     11
152 2023-12-04   21.00            0            49     12
153 2023-12-11   23.00            0            50     12
154 2023-12-18    6.00            0            51     12
155 2023-12-25    7.00            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:23:04,402] A new study created in memory with name: no-name-ccb6db4d-f06a-46d3-ae69-918927e33c3f
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.35s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.51s/it]100%|##########| 2/2 [00:02<00:00,  1.49s/it]
[I 2025-05-23 20:23:08,960] Trial 0 finished with value: 68.60719126084206 and parameters: {'changepoint_prior_scale': 0.27323388221081407, 'seasonality_prior_scale': 0.039762438031309716, 'n_changepoints': 7}. Best is trial 0 with value: 68.60719126084206.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.19s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.33s/it]100%|##########| 2/2 [00:02<00:00,  1.31s/it]
[I 2025-05-23 20:23:13,706] Trial 1 finished with value: 44.45289298279484 and parameters: {'changepoint_prior_scale': 0.0010729729542751964, 'seasonality_prior_scale': 0.026345942862213503, 'n_changepoints': 29}. Best is trial 1 with value: 44.45289298279484.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.26s/it]100%|##########| 2/2 [00:01<00:00,  1.16it/s]100%|##########| 2/2 [00:01<00:00,  1.09it/s]
[I 2025-05-23 20:23:16,412] Trial 2 finished with value: 54.25016212646027 and parameters: {'changepoint_prior_scale': 0.011521465703164844, 'seasonality_prior_scale': 0.2484592824876418, 'n_changepoints': 45}. Best is trial 1 with value: 44.45289298279484.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.02s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:05<00:00,  2.73s/it]100%|##########| 2/2 [00:05<00:00,  2.62s/it]
[I 2025-05-23 20:23:24,130] Trial 3 finished with value: 51.20875220257103 and parameters: {'changepoint_prior_scale': 0.0026947522711488693, 'seasonality_prior_scale': 4.254561671451779, 'n_changepoints': 36}. Best is trial 1 with value: 44.45289298279484.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.18s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.61s/it]100%|##########| 2/2 [00:03<00:00,  1.55s/it]
[I 2025-05-23 20:23:29,897] Trial 4 finished with value: 50.46677169191142 and parameters: {'changepoint_prior_scale': 0.0016998035811752583, 'seasonality_prior_scale': 0.09311602402951334, 'n_changepoints': 24}. Best is trial 1 with value: 44.45289298279484.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.24s/it]100%|##########| 2/2 [00:01<00:00,  1.28it/s]100%|##########| 2/2 [00:01<00:00,  1.18it/s]
[I 2025-05-23 20:23:32,462] Trial 5 finished with value: 53.017275479725996 and parameters: {'changepoint_prior_scale': 0.019303152156583007, 'seasonality_prior_scale': 6.571958160407938, 'n_changepoints': 41}. Best is trial 1 with value: 44.45289298279484.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.02s/it]100%|##########| 2/2 [00:01<00:00,  1.19it/s]100%|##########| 2/2 [00:01<00:00,  1.15it/s]
[I 2025-05-23 20:23:35,122] Trial 6 finished with value: 45.68026369659677 and parameters: {'changepoint_prior_scale': 0.00887466654396923, 'seasonality_prior_scale': 0.013831177303929324, 'n_changepoints': 19}. Best is trial 1 with value: 44.45289298279484.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.85s/it]100%|##########| 2/2 [00:02<00:00,  1.26s/it]100%|##########| 2/2 [00:02<00:00,  1.35s/it]
[I 2025-05-23 20:23:38,884] Trial 7 finished with value: 57.68698479384077 and parameters: {'changepoint_prior_scale': 0.1754826643650562, 'seasonality_prior_scale': 0.06559954521305039, 'n_changepoints': 16}. Best is trial 1 with value: 44.45289298279484.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.10s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.33s/it]100%|##########| 2/2 [00:02<00:00,  1.30s/it]
[I 2025-05-23 20:23:43,185] Trial 8 finished with value: 53.03048655328078 and parameters: {'changepoint_prior_scale': 0.0016274672696739707, 'seasonality_prior_scale': 0.25919577260743254, 'n_changepoints': 39}. Best is trial 1 with value: 44.45289298279484.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.01it/s]100%|##########| 2/2 [00:01<00:00,  1.34it/s]100%|##########| 2/2 [00:01<00:00,  1.28it/s]
[I 2025-05-23 20:23:45,704] Trial 9 finished with value: 50.21535365439968 and parameters: {'changepoint_prior_scale': 0.10223981507023884, 'seasonality_prior_scale': 0.022986702875520123, 'n_changepoints': 5}. Best is trial 1 with value: 44.45289298279484.
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.02s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.28s/it]100%|##########| 2/2 [00:02<00:00,  1.24s/it]
Rendimiento para la combinación BMX_1727-BMX_HOGAR-BMX_3001:
  horizon          mse       rmse  ...     mdape     smape  coverage
0 21 days   411.270860  20.279814  ...  0.323049  0.395775  1.000000
1 28 days   655.681051  25.606270  ...  0.342143  0.408302  1.000000
2 35 days   733.951732  27.091544  ...  0.377189  0.454651  1.000000
3 42 days   403.424459  20.085429  ...  0.303483  0.315552  1.000000
4 49 days  1068.708083  32.691101  ...  0.338529  0.327557  0.833333

[5 rows x 8 columns]
          ds       yhat  yhat_lower  yhat_upper        y     cutoff
0 2022-10-24  93.044630   51.073394  133.173615  103.000 2022-10-17
1 2022-10-31  92.980746   52.448903  132.493186  103.000 2022-10-17
2 2022-11-07  78.031385   36.818511  121.861371  120.000 2022-10-17
3 2022-11-14  75.196152   31.694012  117.371494  113.000 2022-10-17
4 2022-11-21  63.349329   21.751083  105.989365   85.875 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds     y  day_of_week  week_of_year  month
0   2021-01-04   3.0            0             1      1
1   2021-01-11   6.0            0             2      1
2   2021-01-18   6.0            0             3      1
3   2021-01-25   6.0            0             4      1
4   2021-02-01   5.0            0             5      2
..         ...   ...          ...           ...    ...
151 2023-11-27  21.0            0            48     11
152 2023-12-04  12.0            0            49     12
153 2023-12-11   7.0            0            50     12
154 2023-12-18  10.0            0            51     12
155 2023-12-25   4.0            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:23:50,351] A new study created in memory with name: no-name-56c2f18c-5a06-45c6-b3e6-ca477e68d7c1
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.39s/it]100%|##########| 2/2 [00:01<00:00,  1.10it/s]100%|##########| 2/2 [00:01<00:00,  1.02it/s]
[I 2025-05-23 20:23:54,124] Trial 0 finished with value: 9.44370932416844 and parameters: {'changepoint_prior_scale': 0.003524295190903489, 'seasonality_prior_scale': 0.2091147893458185, 'n_changepoints': 21}. Best is trial 0 with value: 9.44370932416844.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.43s/it]100%|##########| 2/2 [00:03<00:00,  1.37s/it]100%|##########| 2/2 [00:03<00:00,  1.53s/it]
[I 2025-05-23 20:23:58,346] Trial 1 finished with value: 11.129758845027915 and parameters: {'changepoint_prior_scale': 0.04832314402569498, 'seasonality_prior_scale': 1.727083713159019, 'n_changepoints': 39}. Best is trial 0 with value: 9.44370932416844.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.28s/it]100%|##########| 2/2 [00:04<00:00,  1.78s/it]100%|##########| 2/2 [00:04<00:00,  2.01s/it]
[I 2025-05-23 20:24:03,356] Trial 2 finished with value: 11.185380172142136 and parameters: {'changepoint_prior_scale': 0.3510278091149359, 'seasonality_prior_scale': 0.027215196679050847, 'n_changepoints': 24}. Best is trial 0 with value: 9.44370932416844.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.32s/it]100%|##########| 2/2 [00:02<00:00,  1.01s/it]100%|##########| 2/2 [00:02<00:00,  1.06s/it]
[I 2025-05-23 20:24:06,493] Trial 3 finished with value: 11.019271454037282 and parameters: {'changepoint_prior_scale': 0.06932789145106566, 'seasonality_prior_scale': 0.08419366477092437, 'n_changepoints': 7}. Best is trial 0 with value: 9.44370932416844.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.46s/it]100%|##########| 2/2 [00:02<00:00,  1.02it/s]100%|##########| 2/2 [00:02<00:00,  1.05s/it]
[I 2025-05-23 20:24:09,738] Trial 4 finished with value: 13.574573857340852 and parameters: {'changepoint_prior_scale': 0.09812301921373781, 'seasonality_prior_scale': 3.4191199633343055, 'n_changepoints': 16}. Best is trial 0 with value: 9.44370932416844.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.21s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.27s/it]100%|##########| 2/2 [00:02<00:00,  1.26s/it]
[I 2025-05-23 20:24:13,971] Trial 5 finished with value: 10.003523720706998 and parameters: {'changepoint_prior_scale': 0.0022046027498294363, 'seasonality_prior_scale': 2.890820523945213, 'n_changepoints': 38}. Best is trial 0 with value: 9.44370932416844.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.33s/it]100%|##########| 2/2 [00:01<00:00,  1.08it/s]100%|##########| 2/2 [00:01<00:00,  1.01it/s]
[I 2025-05-23 20:24:16,863] Trial 6 finished with value: 9.65040502586989 and parameters: {'changepoint_prior_scale': 0.008747991725731112, 'seasonality_prior_scale': 2.3900043987869743, 'n_changepoints': 37}. Best is trial 0 with value: 9.44370932416844.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.01s/it]100%|##########| 2/2 [00:02<00:00,  1.18s/it]100%|##########| 2/2 [00:02<00:00,  1.30s/it]
[I 2025-05-23 20:24:20,419] Trial 7 finished with value: 11.596441361795176 and parameters: {'changepoint_prior_scale': 0.17090131234873576, 'seasonality_prior_scale': 0.07969120297926811, 'n_changepoints': 36}. Best is trial 0 with value: 9.44370932416844.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.08s/it]100%|##########| 2/2 [00:01<00:00,  1.16it/s]100%|##########| 2/2 [00:01<00:00,  1.12it/s]
[I 2025-05-23 20:24:23,203] Trial 8 finished with value: 10.82535266816394 and parameters: {'changepoint_prior_scale': 0.01112349164536359, 'seasonality_prior_scale': 5.100870790076099, 'n_changepoints': 14}. Best is trial 0 with value: 9.44370932416844.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.80s/it]100%|##########| 2/2 [00:02<00:00,  1.18s/it]100%|##########| 2/2 [00:02<00:00,  1.28s/it]
[I 2025-05-23 20:24:26,825] Trial 9 finished with value: 9.484662671047305 and parameters: {'changepoint_prior_scale': 0.0214930999041313, 'seasonality_prior_scale': 0.2593926907356952, 'n_changepoints': 25}. Best is trial 0 with value: 9.44370932416844.
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.05s/it]100%|##########| 2/2 [00:01<00:00,  1.10it/s]100%|##########| 2/2 [00:01<00:00,  1.08it/s]
Rendimiento para la combinación BMX_1727-BMX_HOGAR-BMX_3931:
  horizon        mse      rmse  ...     mdape     smape  coverage
0 21 days  75.249518  8.674648  ...  0.473821  0.537826  0.500000
1 28 days  46.676849  6.832046  ...  0.375804  0.370949  0.500000
2 35 days  36.252872  6.021036  ...  0.159615  0.290001  0.666667
3 42 days  23.956235  4.894511  ...  0.310111  0.278817  0.833333
4 49 days   9.131451  3.021829  ...  0.195119  0.224665  1.000000

[5 rows x 8 columns]
          ds       yhat  yhat_lower  yhat_upper     y     cutoff
0 2022-10-24  17.250537   10.182730   24.020826  29.5 2022-10-17
1 2022-10-31  21.453693   14.510437   27.681307  14.0 2022-10-17
2 2022-11-07  18.782203   11.783922   25.326789   9.0 2022-10-17
3 2022-11-14  22.195209   15.392248   28.870451  12.0 2022-10-17
4 2022-11-21   6.085116   -0.471391   12.459805   6.0 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds     y  day_of_week  week_of_year  month
0   2021-01-04  52.0            0             1      1
1   2021-01-11  29.0            0             2      1
2   2021-01-18  23.0            0             3      1
3   2021-01-25  61.0            0             4      1
4   2021-02-01  30.0            0             5      2
..         ...   ...          ...           ...    ...
151 2023-11-27  42.0            0            48     11
152 2023-12-04  35.0            0            49     12
153 2023-12-11  40.0            0            50     12
154 2023-12-18  47.0            0            51     12
155 2023-12-25  24.0            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:24:30,971] A new study created in memory with name: no-name-eaeb97b6-e17c-4f8c-9e34-b62862816575
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.25s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.34s/it]100%|##########| 2/2 [00:02<00:00,  1.32s/it]
[I 2025-05-23 20:24:35,892] Trial 0 finished with value: 11.298240279441202 and parameters: {'changepoint_prior_scale': 0.003952182724200997, 'seasonality_prior_scale': 1.385335598108597, 'n_changepoints': 22}. Best is trial 0 with value: 11.298240279441202.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.03s/it]100%|##########| 2/2 [00:02<00:00,  1.22s/it]100%|##########| 2/2 [00:02<00:00,  1.34s/it]
[I 2025-05-23 20:24:39,611] Trial 1 finished with value: 8.929564508493282 and parameters: {'changepoint_prior_scale': 0.011786362079467181, 'seasonality_prior_scale': 0.014313426391933661, 'n_changepoints': 48}. Best is trial 1 with value: 8.929564508493282.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.25s/it]100%|##########| 2/2 [00:01<00:00,  1.20it/s]100%|##########| 2/2 [00:01<00:00,  1.12it/s]
[I 2025-05-23 20:24:42,503] Trial 2 finished with value: 11.126491829381738 and parameters: {'changepoint_prior_scale': 0.02268168587029498, 'seasonality_prior_scale': 1.0368282750625848, 'n_changepoints': 39}. Best is trial 1 with value: 8.929564508493282.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:09<00:09,  9.80s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:11<00:00,  4.84s/it]100%|##########| 2/2 [00:11<00:00,  5.58s/it]
[I 2025-05-23 20:24:55,933] Trial 3 finished with value: 10.864416685500931 and parameters: {'changepoint_prior_scale': 0.0017517070486925332, 'seasonality_prior_scale': 0.2923642855026361, 'n_changepoints': 33}. Best is trial 1 with value: 8.929564508493282.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.98s/it]100%|##########| 2/2 [00:04<00:00,  1.95s/it]100%|##########| 2/2 [00:04<00:00,  2.10s/it]
[I 2025-05-23 20:25:01,793] Trial 4 finished with value: 13.588281517362464 and parameters: {'changepoint_prior_scale': 0.48990380712189147, 'seasonality_prior_scale': 0.5800847363180304, 'n_changepoints': 17}. Best is trial 1 with value: 8.929564508493282.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.03s/it]100%|##########| 2/2 [00:01<00:00,  1.25it/s]100%|##########| 2/2 [00:01<00:00,  1.20it/s]
[I 2025-05-23 20:25:04,401] Trial 5 finished with value: 9.660787524155472 and parameters: {'changepoint_prior_scale': 0.01019589075735509, 'seasonality_prior_scale': 0.024063126806471574, 'n_changepoints': 34}. Best is trial 1 with value: 8.929564508493282.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.28it/s]100%|##########| 2/2 [00:01<00:00,  1.41it/s]100%|##########| 2/2 [00:01<00:00,  1.39it/s]
[I 2025-05-23 20:25:06,790] Trial 6 finished with value: 9.274799355030304 and parameters: {'changepoint_prior_scale': 0.007280228499794927, 'seasonality_prior_scale': 0.015674257839408977, 'n_changepoints': 5}. Best is trial 1 with value: 8.929564508493282.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.52s/it]100%|##########| 2/2 [00:02<00:00,  1.05s/it]100%|##########| 2/2 [00:02<00:00,  1.12s/it]
[I 2025-05-23 20:25:09,892] Trial 7 finished with value: 11.000698646475277 and parameters: {'changepoint_prior_scale': 0.10576021978643375, 'seasonality_prior_scale': 0.2115641444739966, 'n_changepoints': 49}. Best is trial 1 with value: 8.929564508493282.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.07s/it]100%|##########| 2/2 [00:01<00:00,  1.21it/s]100%|##########| 2/2 [00:01<00:00,  1.16it/s]
[I 2025-05-23 20:25:12,672] Trial 8 finished with value: 11.111289731685742 and parameters: {'changepoint_prior_scale': 0.049579057842770245, 'seasonality_prior_scale': 0.5107801550939616, 'n_changepoints': 13}. Best is trial 1 with value: 8.929564508493282.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.25s/it]100%|##########| 2/2 [00:01<00:00,  1.05it/s]100%|##########| 2/2 [00:01<00:00,  1.00it/s]
[I 2025-05-23 20:25:15,809] Trial 9 finished with value: 9.558674322100536 and parameters: {'changepoint_prior_scale': 0.06412141898298158, 'seasonality_prior_scale': 0.017005609568664738, 'n_changepoints': 45}. Best is trial 1 with value: 8.929564508493282.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.52s/it]100%|##########| 2/2 [00:03<00:00,  1.40s/it]100%|##########| 2/2 [00:03<00:00,  1.57s/it]
Rendimiento para la combinación BMX_1727-BMX_HOGAR-BMX_3203:
  horizon        mse      rmse  ...     mdape     smape  coverage
0 21 days  81.025973  9.001443  ...  0.168103  0.202504  0.833333
1 28 days  57.115881  7.557505  ...  0.151796  0.165992  0.833333
2 35 days  50.548178  7.109724  ...  0.147851  0.146673  0.833333
3 42 days  50.012611  7.071959  ...  0.124729  0.136990  0.666667
4 49 days  24.459892  4.945694  ...  0.076321  0.084367  0.833333

[5 rows x 8 columns]
          ds       yhat  yhat_lower  yhat_upper     y     cutoff
0 2022-10-24  43.776459   34.066670   54.038680  29.0 2022-10-17
1 2022-10-31  43.200604   32.649994   53.239762  50.0 2022-10-17
2 2022-11-07  40.979441   31.506032   51.108246  47.0 2022-10-17
3 2022-11-14  37.613005   27.903236   47.940452  48.0 2022-10-17
4 2022-11-21  41.316566   31.506218   51.680851  45.0 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds      y  day_of_week  week_of_year  month
0   2021-01-04   29.0            0             1      1
1   2021-01-11   12.0            0             2      1
2   2021-01-18   20.0            0             3      1
3   2021-01-25   43.0            0             4      1
4   2021-02-01   45.0            0             5      2
..         ...    ...          ...           ...    ...
151 2023-11-27  372.0            0            48     11
152 2023-12-04  414.0            0            49     12
153 2023-12-11  434.0            0            50     12
154 2023-12-18  427.0            0            51     12
155 2023-12-25  542.0            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:25:19,942] A new study created in memory with name: no-name-db0b34e3-f7ad-462b-93ad-5caf30c83e94
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.15s/it]100%|##########| 2/2 [00:01<00:00,  1.08it/s]100%|##########| 2/2 [00:01<00:00,  1.05it/s]
[I 2025-05-23 20:25:22,793] Trial 0 finished with value: 93.47532229056469 and parameters: {'changepoint_prior_scale': 0.0813124429974555, 'seasonality_prior_scale': 6.788634012921457, 'n_changepoints': 13}. Best is trial 0 with value: 93.47532229056469.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.22s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.36s/it]100%|##########| 2/2 [00:02<00:00,  1.34s/it]
[I 2025-05-23 20:25:27,582] Trial 1 finished with value: 137.87355725061894 and parameters: {'changepoint_prior_scale': 0.0012881298190212016, 'seasonality_prior_scale': 2.2340247352315963, 'n_changepoints': 46}. Best is trial 0 with value: 93.47532229056469.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.10s/it]100%|##########| 2/2 [00:01<00:00,  1.22it/s]100%|##########| 2/2 [00:01<00:00,  1.16it/s]
[I 2025-05-23 20:25:30,227] Trial 2 finished with value: 134.90434143301343 and parameters: {'changepoint_prior_scale': 0.01477993680042157, 'seasonality_prior_scale': 0.23119498042685102, 'n_changepoints': 12}. Best is trial 0 with value: 93.47532229056469.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.01it/s]100%|##########| 2/2 [00:01<00:00,  1.23it/s]100%|##########| 2/2 [00:01<00:00,  1.19it/s]
[I 2025-05-23 20:25:32,793] Trial 3 finished with value: 134.51068053502607 and parameters: {'changepoint_prior_scale': 0.014475359275156603, 'seasonality_prior_scale': 8.660066910276417, 'n_changepoints': 5}. Best is trial 0 with value: 93.47532229056469.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.21s/it]100%|##########| 2/2 [00:01<00:00,  1.23it/s]100%|##########| 2/2 [00:01<00:00,  1.15it/s]
[I 2025-05-23 20:25:35,356] Trial 4 finished with value: 124.0529226535428 and parameters: {'changepoint_prior_scale': 0.010922268221961285, 'seasonality_prior_scale': 0.04255437491352219, 'n_changepoints': 27}. Best is trial 0 with value: 93.47532229056469.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.10s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.45s/it]100%|##########| 2/2 [00:02<00:00,  1.40s/it]
[I 2025-05-23 20:25:40,850] Trial 5 finished with value: 136.77164271252198 and parameters: {'changepoint_prior_scale': 0.0024076848576633095, 'seasonality_prior_scale': 1.1314221971731884, 'n_changepoints': 43}. Best is trial 0 with value: 93.47532229056469.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.05s/it]100%|##########| 2/2 [00:03<00:00,  1.62s/it]100%|##########| 2/2 [00:03<00:00,  1.84s/it]
[I 2025-05-23 20:25:45,474] Trial 6 finished with value: 60.65984039250604 and parameters: {'changepoint_prior_scale': 0.3245993459421328, 'seasonality_prior_scale': 1.3957455664520757, 'n_changepoints': 49}. Best is trial 6 with value: 60.65984039250604.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.01s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.15s/it]100%|##########| 2/2 [00:02<00:00,  1.13s/it]
[I 2025-05-23 20:25:48,542] Trial 7 finished with value: 139.2878290939897 and parameters: {'changepoint_prior_scale': 0.001817578118205518, 'seasonality_prior_scale': 4.12092359559053, 'n_changepoints': 12}. Best is trial 6 with value: 60.65984039250604.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.90s/it]100%|##########| 2/2 [00:02<00:00,  1.22s/it]100%|##########| 2/2 [00:02<00:00,  1.32s/it]
[I 2025-05-23 20:25:52,856] Trial 8 finished with value: 60.26458831424464 and parameters: {'changepoint_prior_scale': 0.43269270891293293, 'seasonality_prior_scale': 1.5700550933882929, 'n_changepoints': 26}. Best is trial 8 with value: 60.26458831424464.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.01s/it]100%|##########| 2/2 [00:03<00:00,  1.66s/it]100%|##########| 2/2 [00:03<00:00,  1.86s/it]
[I 2025-05-23 20:25:57,674] Trial 9 finished with value: 60.60805363368914 and parameters: {'changepoint_prior_scale': 0.2500616175087877, 'seasonality_prior_scale': 0.0430487248842569, 'n_changepoints': 25}. Best is trial 8 with value: 60.26458831424464.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.82s/it]100%|##########| 2/2 [00:03<00:00,  1.57s/it]100%|##########| 2/2 [00:03<00:00,  1.76s/it]
Rendimiento para la combinación BMX_2-BMX_AUTOSERVICIOS-BMX_3001:
  horizon          mse       rmse  ...     mdape     smape  coverage
0 21 days  1902.710234  43.620067  ...  0.092757  0.146673  0.500000
1 28 days  1797.299055  42.394564  ...  0.103372  0.147313  0.666667
2 35 days  1518.617460  38.969443  ...  0.101174  0.122666  0.666667
3 42 days   832.432890  28.851913  ...  0.101174  0.089074  0.833333
4 49 days   667.703721  25.839964  ...  0.061880  0.069885  0.833333

[5 rows x 8 columns]
          ds        yhat  yhat_lower  yhat_upper      y     cutoff
0 2022-10-24  201.280403  164.820950  239.609740  214.0 2022-10-17
1 2022-10-31  244.465952  208.586574  280.302541  185.0 2022-10-17
2 2022-11-07  173.161652  139.095327  211.002046  243.0 2022-10-17
3 2022-11-14  211.650759  174.546107  248.457686  188.0 2022-10-17
4 2022-11-21  164.561230  128.721101  200.714460  180.0 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds        y  day_of_week  week_of_year  month
0   2021-01-04   44.750            0             1      1
1   2021-01-11   40.875            0             2      1
2   2021-01-18   42.625            0             3      1
3   2021-01-25   40.750            0             4      1
4   2021-02-01   45.375            0             5      2
..         ...      ...          ...           ...    ...
151 2023-11-27   63.500            0            48     11
152 2023-12-04   87.875            0            49     12
153 2023-12-11  113.250            0            50     12
154 2023-12-18   96.500            0            51     12
155 2023-12-25  124.250            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:26:02,577] A new study created in memory with name: no-name-8f167221-e0b7-408d-8e63-4daa80666056
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.39s/it]100%|##########| 2/2 [00:01<00:00,  1.13it/s]100%|##########| 2/2 [00:01<00:00,  1.04it/s]
[I 2025-05-23 20:26:05,392] Trial 0 finished with value: 77.69707993677164 and parameters: {'changepoint_prior_scale': 0.3640947845373943, 'seasonality_prior_scale': 0.6742083629033859, 'n_changepoints': 8}. Best is trial 0 with value: 77.69707993677164.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.18s/it]100%|##########| 2/2 [00:02<00:00,  1.27s/it]100%|##########| 2/2 [00:02<00:00,  1.41s/it]
[I 2025-05-23 20:26:08,990] Trial 1 finished with value: 69.31501203744182 and parameters: {'changepoint_prior_scale': 0.24980059877059752, 'seasonality_prior_scale': 0.5674821138098072, 'n_changepoints': 27}. Best is trial 1 with value: 69.31501203744182.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.29s/it]100%|##########| 2/2 [00:01<00:00,  1.13it/s]100%|##########| 2/2 [00:01<00:00,  1.06it/s]
[I 2025-05-23 20:26:11,852] Trial 2 finished with value: 56.489297364531964 and parameters: {'changepoint_prior_scale': 0.005212296411282513, 'seasonality_prior_scale': 0.053366787690472026, 'n_changepoints': 24}. Best is trial 2 with value: 56.489297364531964.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.16s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.45s/it]100%|##########| 2/2 [00:02<00:00,  1.41s/it]
[I 2025-05-23 20:26:16,538] Trial 3 finished with value: 71.59876985279041 and parameters: {'changepoint_prior_scale': 0.0016871082948787801, 'seasonality_prior_scale': 4.650562285031016, 'n_changepoints': 32}. Best is trial 2 with value: 56.489297364531964.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.33s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.42s/it]100%|##########| 2/2 [00:02<00:00,  1.40s/it]
[I 2025-05-23 20:26:21,208] Trial 4 finished with value: 61.40457625036159 and parameters: {'changepoint_prior_scale': 0.0011956055517700769, 'seasonality_prior_scale': 0.46943266411142, 'n_changepoints': 48}. Best is trial 2 with value: 56.489297364531964.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.64s/it]100%|##########| 2/2 [00:03<00:00,  1.45s/it]100%|##########| 2/2 [00:03<00:00,  1.63s/it]
[I 2025-05-23 20:26:25,415] Trial 5 finished with value: 82.53829986802384 and parameters: {'changepoint_prior_scale': 0.4282018349081824, 'seasonality_prior_scale': 0.8238704215603152, 'n_changepoints': 23}. Best is trial 2 with value: 56.489297364531964.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.21s/it]100%|##########| 2/2 [00:02<00:00,  1.26s/it]100%|##########| 2/2 [00:02<00:00,  1.41s/it]
[I 2025-05-23 20:26:29,147] Trial 6 finished with value: 63.34747036936883 and parameters: {'changepoint_prior_scale': 0.15712817905060272, 'seasonality_prior_scale': 0.7517070584435024, 'n_changepoints': 35}. Best is trial 2 with value: 56.489297364531964.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.39s/it]100%|##########| 2/2 [00:02<00:00,  1.03it/s]100%|##########| 2/2 [00:02<00:00,  1.03s/it]
[I 2025-05-23 20:26:32,086] Trial 7 finished with value: 59.91206836451381 and parameters: {'changepoint_prior_scale': 0.030022604458203327, 'seasonality_prior_scale': 0.2110570748449645, 'n_changepoints': 23}. Best is trial 2 with value: 56.489297364531964.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.45s/it]100%|##########| 2/2 [00:04<00:00,  1.85s/it]100%|##########| 2/2 [00:04<00:00,  2.09s/it]
[I 2025-05-23 20:26:37,264] Trial 8 finished with value: 61.91116560797612 and parameters: {'changepoint_prior_scale': 0.113010747332912, 'seasonality_prior_scale': 0.28384294206293587, 'n_changepoints': 40}. Best is trial 2 with value: 56.489297364531964.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.09it/s]100%|##########| 2/2 [00:01<00:00,  1.37it/s]100%|##########| 2/2 [00:01<00:00,  1.32it/s]
[I 2025-05-23 20:26:39,603] Trial 9 finished with value: 60.12590179459896 and parameters: {'changepoint_prior_scale': 0.011311938464346184, 'seasonality_prior_scale': 1.1183349251607593, 'n_changepoints': 12}. Best is trial 2 with value: 56.489297364531964.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.05s/it]100%|##########| 2/2 [00:01<00:00,  1.33it/s]100%|##########| 2/2 [00:01<00:00,  1.26it/s]
Rendimiento para la combinación BMX_2-BMX_HOGAR-BMX_3001:
  horizon          mse       rmse  ...     mdape     smape  coverage
0 21 days  2782.088644  52.745508  ...  0.457241  0.501557  0.166667
1 28 days  2479.509757  49.794676  ...  0.804080  0.585272  0.000000
2 35 days  4017.674647  63.385130  ...  1.163939  0.769400  0.000000
3 42 days  3866.340288  62.179903  ...  1.364231  0.800872  0.000000
4 49 days  2844.220872  53.331237  ...  0.795869  0.583557  0.333333

[5 rows x 8 columns]
          ds        yhat  yhat_lower  yhat_upper        y     cutoff
0 2022-10-24   76.312386   58.459787   92.854551  163.750 2022-10-17
1 2022-10-31   80.992536   64.685901   99.596876  117.125 2022-10-17
2 2022-11-07  102.104562   84.144767  119.488624  161.375 2022-10-17
3 2022-11-14  105.616633   87.074368  122.334178   41.750 2022-10-17
4 2022-11-21   86.415224   67.830589  104.623398   37.750 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds        y  day_of_week  week_of_year  month
0   2021-01-04   54.625            0             1      1
1   2021-01-11   50.250            0             2      1
2   2021-01-18   47.750            0             3      1
3   2021-01-25   45.375            0             4      1
4   2021-02-01   44.250            0             5      2
..         ...      ...          ...           ...    ...
151 2023-11-27  402.000            0            48     11
152 2023-12-04  389.375            0            49     12
153 2023-12-11  438.375            0            50     12
154 2023-12-18  428.750            0            51     12
155 2023-12-25  433.500            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:26:42,181] A new study created in memory with name: no-name-f320064c-4566-4713-8f70-ff4a702836b2
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.13it/s]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.08s/it]100%|##########| 2/2 [00:02<00:00,  1.05s/it]
[I 2025-05-23 20:26:45,240] Trial 0 finished with value: 233.57699575850958 and parameters: {'changepoint_prior_scale': 0.001599369159082115, 'seasonality_prior_scale': 0.40319669665679464, 'n_changepoints': 8}. Best is trial 0 with value: 233.57699575850958.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.06s/it]100%|##########| 2/2 [00:01<00:00,  1.03it/s]100%|##########| 2/2 [00:01<00:00,  1.01it/s]
[I 2025-05-23 20:26:48,011] Trial 1 finished with value: 229.89018558483795 and parameters: {'changepoint_prior_scale': 0.008453588226591889, 'seasonality_prior_scale': 1.153792899099277, 'n_changepoints': 11}. Best is trial 1 with value: 229.89018558483795.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.69s/it]100%|##########| 2/2 [00:02<00:00,  1.14s/it]100%|##########| 2/2 [00:02<00:00,  1.22s/it]
[I 2025-05-23 20:26:51,465] Trial 2 finished with value: 178.9792144014557 and parameters: {'changepoint_prior_scale': 0.11027505560900572, 'seasonality_prior_scale': 0.38636752163567334, 'n_changepoints': 16}. Best is trial 2 with value: 178.9792144014557.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.70s/it]100%|##########| 2/2 [00:04<00:00,  1.89s/it]100%|##########| 2/2 [00:04<00:00,  2.16s/it]
[I 2025-05-23 20:26:56,941] Trial 3 finished with value: 169.5029325922657 and parameters: {'changepoint_prior_scale': 0.17665300334944978, 'seasonality_prior_scale': 1.385830651977861, 'n_changepoints': 39}. Best is trial 3 with value: 169.5029325922657.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.32s/it]100%|##########| 2/2 [00:02<00:00,  1.33s/it]100%|##########| 2/2 [00:02<00:00,  1.48s/it]
[I 2025-05-23 20:27:00,836] Trial 4 finished with value: 151.4525506411351 and parameters: {'changepoint_prior_scale': 0.07298586380274404, 'seasonality_prior_scale': 0.4990668675613423, 'n_changepoints': 44}. Best is trial 4 with value: 151.4525506411351.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.01s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.24s/it]100%|##########| 2/2 [00:02<00:00,  1.20s/it]
[I 2025-05-23 20:27:04,911] Trial 5 finished with value: 235.36731264617498 and parameters: {'changepoint_prior_scale': 0.0034895636942128927, 'seasonality_prior_scale': 1.825177764291581, 'n_changepoints': 23}. Best is trial 4 with value: 151.4525506411351.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.03s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.05s/it]100%|##########| 2/2 [00:02<00:00,  1.05s/it]
[I 2025-05-23 20:27:08,475] Trial 6 finished with value: 230.17856117999838 and parameters: {'changepoint_prior_scale': 0.0010348656230646652, 'seasonality_prior_scale': 0.1643470522606402, 'n_changepoints': 11}. Best is trial 4 with value: 151.4525506411351.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.04it/s]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.16s/it]100%|##########| 2/2 [00:02<00:00,  1.13s/it]
[I 2025-05-23 20:27:12,561] Trial 7 finished with value: 232.27726280633186 and parameters: {'changepoint_prior_scale': 0.004097114326346456, 'seasonality_prior_scale': 0.44442894145959494, 'n_changepoints': 29}. Best is trial 4 with value: 151.4525506411351.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.55s/it]100%|##########| 2/2 [00:02<00:00,  1.06s/it]100%|##########| 2/2 [00:02<00:00,  1.13s/it]
[I 2025-05-23 20:27:15,719] Trial 8 finished with value: 161.49286906550552 and parameters: {'changepoint_prior_scale': 0.17981851325419868, 'seasonality_prior_scale': 7.872995969622857, 'n_changepoints': 12}. Best is trial 4 with value: 151.4525506411351.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.32s/it]100%|##########| 2/2 [00:03<00:00,  1.39s/it]100%|##########| 2/2 [00:03<00:00,  1.53s/it]
[I 2025-05-23 20:27:19,687] Trial 9 finished with value: 229.84736692752662 and parameters: {'changepoint_prior_scale': 0.05418094573939288, 'seasonality_prior_scale': 0.2407524695351551, 'n_changepoints': 45}. Best is trial 4 with value: 151.4525506411351.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.34s/it]100%|##########| 2/2 [00:03<00:00,  1.43s/it]100%|##########| 2/2 [00:03<00:00,  1.56s/it]
Rendimiento para la combinación BMX_2-BMX_HOGAR-BMX_3931:
  horizon           mse        rmse  ...     mdape     smape  coverage
0 21 days  20244.731836  142.283983  ...  0.340500  0.340470       0.0
1 28 days  26007.599597  161.268719  ...  0.368002  0.395402       0.0
2 35 days  28275.024396  168.151790  ...  0.368002  0.397546       0.0
3 42 days  28294.779452  168.210521  ...  0.397247  0.396402       0.0
4 49 days  30846.188588  175.630830  ...  0.308038  0.389308       0.0

[5 rows x 8 columns]
          ds        yhat  yhat_lower  yhat_upper        y     cutoff
0 2022-10-24  503.324604  463.341736  546.519827  354.375 2022-10-17
1 2022-10-31  530.262857  490.097573  571.133135  343.000 2022-10-17
2 2022-11-07  527.420137  483.345397  567.831381  396.000 2022-10-17
3 2022-11-14  473.443923  432.230027  516.824944  341.375 2022-10-17
4 2022-11-21  398.364095  357.534910  439.486229  332.750 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds       y  day_of_week  week_of_year  month
0   2021-01-04  73.875            0             1      1
1   2021-01-11  66.250            0             2      1
2   2021-01-18  77.625            0             3      1
3   2021-01-25  92.625            0             4      1
4   2021-02-01  86.000            0             5      2
..         ...     ...          ...           ...    ...
151 2023-11-27  79.000            0            48     11
152 2023-12-04  86.000            0            49     12
153 2023-12-11  75.000            0            50     12
154 2023-12-18  92.000            0            51     12
155 2023-12-25  75.000            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:27:23,638] A new study created in memory with name: no-name-d59c9abc-8fed-4d24-888f-a25c77529c24
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.34s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.63s/it]100%|##########| 2/2 [00:03<00:00,  1.58s/it]
[I 2025-05-23 20:27:28,950] Trial 0 finished with value: 42.80692936479696 and parameters: {'changepoint_prior_scale': 0.0024299605478595616, 'seasonality_prior_scale': 6.564616896366791, 'n_changepoints': 46}. Best is trial 0 with value: 42.80692936479696.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.26s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.38s/it]100%|##########| 2/2 [00:02<00:00,  1.36s/it]
[I 2025-05-23 20:27:33,606] Trial 1 finished with value: 42.432210617664225 and parameters: {'changepoint_prior_scale': 0.0016206595794783368, 'seasonality_prior_scale': 0.027603223007007, 'n_changepoints': 46}. Best is trial 1 with value: 42.432210617664225.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.29s/it]100%|##########| 2/2 [00:01<00:00,  1.08it/s]100%|##########| 2/2 [00:01<00:00,  1.02it/s]
[I 2025-05-23 20:27:36,379] Trial 2 finished with value: 41.643281410393385 and parameters: {'changepoint_prior_scale': 0.00891236036023495, 'seasonality_prior_scale': 2.4330299205744272, 'n_changepoints': 42}. Best is trial 2 with value: 41.643281410393385.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.39s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:04<00:00,  2.01s/it]100%|##########| 2/2 [00:04<00:00,  2.07s/it]
[I 2025-05-23 20:27:43,163] Trial 3 finished with value: 42.520983921544996 and parameters: {'changepoint_prior_scale': 0.004273205023215504, 'seasonality_prior_scale': 0.8652229975259276, 'n_changepoints': 49}. Best is trial 2 with value: 41.643281410393385.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.29s/it]100%|##########| 2/2 [00:02<00:00,  1.31s/it]100%|##########| 2/2 [00:02<00:00,  1.46s/it]
[I 2025-05-23 20:27:47,081] Trial 4 finished with value: 33.798195194169914 and parameters: {'changepoint_prior_scale': 0.047616349383183466, 'seasonality_prior_scale': 0.10697168206615541, 'n_changepoints': 38}. Best is trial 4 with value: 33.798195194169914.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.92s/it]100%|##########| 2/2 [00:02<00:00,  1.12s/it]100%|##########| 2/2 [00:02<00:00,  1.24s/it]
[I 2025-05-23 20:27:50,762] Trial 5 finished with value: 29.43360098909065 and parameters: {'changepoint_prior_scale': 0.3546532503461769, 'seasonality_prior_scale': 0.10358599166121905, 'n_changepoints': 15}. Best is trial 5 with value: 29.43360098909065.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.02s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.11s/it]100%|##########| 2/2 [00:02<00:00,  1.10s/it]
[I 2025-05-23 20:27:54,826] Trial 6 finished with value: 42.803431550656846 and parameters: {'changepoint_prior_scale': 0.001030278435284192, 'seasonality_prior_scale': 4.3460157091974905, 'n_changepoints': 12}. Best is trial 5 with value: 29.43360098909065.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.15s/it]100%|##########| 2/2 [00:01<00:00,  1.39it/s]100%|##########| 2/2 [00:01<00:00,  1.27it/s]
[I 2025-05-23 20:27:57,181] Trial 7 finished with value: 33.35038396051642 and parameters: {'changepoint_prior_scale': 0.12125398928318865, 'seasonality_prior_scale': 0.01974897968442705, 'n_changepoints': 7}. Best is trial 5 with value: 29.43360098909065.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.29s/it]100%|##########| 2/2 [00:01<00:00,  1.10it/s]100%|##########| 2/2 [00:01<00:00,  1.03it/s]
[I 2025-05-23 20:28:00,466] Trial 8 finished with value: 41.643988225304504 and parameters: {'changepoint_prior_scale': 0.005931697443104155, 'seasonality_prior_scale': 2.38213933689219, 'n_changepoints': 29}. Best is trial 5 with value: 29.43360098909065.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.06it/s]100%|##########| 2/2 [00:01<00:00,  1.60it/s]100%|##########| 2/2 [00:01<00:00,  1.49it/s]
[I 2025-05-23 20:28:02,611] Trial 9 finished with value: 42.33866958804957 and parameters: {'changepoint_prior_scale': 0.020314315864272712, 'seasonality_prior_scale': 0.01922101373020853, 'n_changepoints': 7}. Best is trial 5 with value: 29.43360098909065.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.68s/it]100%|##########| 2/2 [00:02<00:00,  1.04it/s]100%|##########| 2/2 [00:02<00:00,  1.07s/it]
Rendimiento para la combinación BMX_2-BMX_HOGAR-BMX_3203:
  horizon          mse       rmse  ...     mdape     smape  coverage
0 21 days   188.592555  13.732900  ...  0.149622  0.149960  0.333333
1 28 days   459.464994  21.435135  ...  0.187213  0.201939  0.333333
2 35 days  1950.499805  44.164463  ...  0.262958  0.390815  0.333333
3 42 days  2222.988795  47.148582  ...  0.358313  0.472670  0.166667
4 49 days  2469.686669  49.695942  ...  0.382868  0.477349  0.166667

[5 rows x 8 columns]
          ds       yhat  yhat_lower  yhat_upper      y     cutoff
0 2022-10-24  69.441708   61.751195   77.325422  63.00 2022-10-17
1 2022-10-31  67.838968   60.591886   75.479424  56.00 2022-10-17
2 2022-11-07  63.607857   56.066643   71.594390  65.25 2022-10-17
3 2022-11-14  63.202851   55.724451   70.887479  56.50 2022-10-17
4 2022-11-21  62.270426   54.590626   70.169060  27.00 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds         y  day_of_week  week_of_year  month
0   2021-01-04  1760.000            0             1      1
1   2021-01-11  1372.000            0             2      1
2   2021-01-18  1478.000            0             3      1
3   2021-01-25  1742.875            0             4      1
4   2021-02-01  1738.000            0             5      2
..         ...       ...          ...           ...    ...
151 2023-11-27  2665.000            0            48     11
152 2023-12-04  3017.875            0            49     12
153 2023-12-11  2829.375            0            50     12
154 2023-12-18  3421.500            0            51     12
155 2023-12-25  3055.125            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:28:05,591] A new study created in memory with name: no-name-e2ce68a5-743b-4394-b397-483c9fa83334
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.51s/it]100%|##########| 2/2 [00:02<00:00,  1.04s/it]100%|##########| 2/2 [00:02<00:00,  1.11s/it]
[I 2025-05-23 20:28:08,734] Trial 0 finished with value: 662.3537259363368 and parameters: {'changepoint_prior_scale': 0.011077354404195373, 'seasonality_prior_scale': 0.025953744398120992, 'n_changepoints': 49}. Best is trial 0 with value: 662.3537259363368.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.57s/it]100%|##########| 2/2 [00:03<00:00,  1.40s/it]100%|##########| 2/2 [00:03<00:00,  1.58s/it]
[I 2025-05-23 20:28:12,805] Trial 1 finished with value: 884.3496530095915 and parameters: {'changepoint_prior_scale': 0.23688327869151157, 'seasonality_prior_scale': 0.0646912252132336, 'n_changepoints': 43}. Best is trial 0 with value: 662.3537259363368.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.85s/it]100%|##########| 2/2 [00:02<00:00,  1.28s/it]100%|##########| 2/2 [00:02<00:00,  1.37s/it]
[I 2025-05-23 20:28:16,446] Trial 2 finished with value: 648.3872734667175 and parameters: {'changepoint_prior_scale': 0.07814874287644485, 'seasonality_prior_scale': 0.6289178742297766, 'n_changepoints': 42}. Best is trial 2 with value: 648.3872734667175.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.70s/it]100%|##########| 2/2 [00:02<00:00,  1.09s/it]100%|##########| 2/2 [00:02<00:00,  1.18s/it]
[I 2025-05-23 20:28:19,653] Trial 3 finished with value: 670.23640691655 and parameters: {'changepoint_prior_scale': 0.04132896987676634, 'seasonality_prior_scale': 0.4254705595243256, 'n_changepoints': 37}. Best is trial 2 with value: 648.3872734667175.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.87s/it]100%|##########| 2/2 [00:02<00:00,  1.14s/it]100%|##########| 2/2 [00:02<00:00,  1.25s/it]
[I 2025-05-23 20:28:23,836] Trial 4 finished with value: 560.7659597914266 and parameters: {'changepoint_prior_scale': 0.0027923622244860123, 'seasonality_prior_scale': 0.5362494577777578, 'n_changepoints': 25}. Best is trial 4 with value: 560.7659597914266.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.41s/it]100%|##########| 2/2 [00:02<00:00,  1.02s/it]100%|##########| 2/2 [00:02<00:00,  1.08s/it]
[I 2025-05-23 20:28:26,889] Trial 5 finished with value: 873.2036718630683 and parameters: {'changepoint_prior_scale': 0.49135682687941723, 'seasonality_prior_scale': 0.01970458318785137, 'n_changepoints': 12}. Best is trial 4 with value: 560.7659597914266.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.19s/it]100%|##########| 2/2 [00:01<00:00,  1.18it/s]100%|##########| 2/2 [00:01<00:00,  1.11it/s]
[I 2025-05-23 20:28:29,607] Trial 6 finished with value: 665.7463148064923 and parameters: {'changepoint_prior_scale': 0.04814271595247636, 'seasonality_prior_scale': 0.7242838074122256, 'n_changepoints': 25}. Best is trial 4 with value: 560.7659597914266.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.44s/it]100%|##########| 2/2 [00:02<00:00,  1.04it/s]100%|##########| 2/2 [00:02<00:00,  1.03s/it]
[I 2025-05-23 20:28:32,913] Trial 7 finished with value: 670.7452382528999 and parameters: {'changepoint_prior_scale': 0.07077284072356867, 'seasonality_prior_scale': 1.0675766313970145, 'n_changepoints': 17}. Best is trial 4 with value: 560.7659597914266.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.44s/it]100%|##########| 2/2 [00:02<00:00,  1.04it/s]100%|##########| 2/2 [00:02<00:00,  1.04s/it]
[I 2025-05-23 20:28:35,927] Trial 8 finished with value: 684.4273065732484 and parameters: {'changepoint_prior_scale': 0.07435520224919384, 'seasonality_prior_scale': 4.1010969038536595, 'n_changepoints': 41}. Best is trial 4 with value: 560.7659597914266.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.66s/it]100%|##########| 2/2 [00:02<00:00,  1.06s/it]100%|##########| 2/2 [00:02<00:00,  1.15s/it]
[I 2025-05-23 20:28:39,246] Trial 9 finished with value: 662.1705597818832 and parameters: {'changepoint_prior_scale': 0.07157229467708036, 'seasonality_prior_scale': 0.5768454104516595, 'n_changepoints': 32}. Best is trial 4 with value: 560.7659597914266.
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.75s/it]100%|##########| 2/2 [00:02<00:00,  1.01it/s]100%|##########| 2/2 [00:02<00:00,  1.10s/it]
Rendimiento para la combinación BMX_2-BMX_OXXO-BMX_3001:
  horizon            mse        rmse  ...     mdape     smape  coverage
0 21 days   51403.495817  226.723391  ...  0.061270  0.060861  1.000000
1 28 days  140475.099902  374.800080  ...  0.082546  0.104974  0.666667
2 35 days  358566.089242  598.803882  ...  0.122307  0.185325  0.500000
3 42 days  387848.759148  622.775047  ...  0.193645  0.204440  0.333333
4 49 days  324057.738588  569.260695  ...  0.113648  0.176906  0.500000

[5 rows x 8 columns]
          ds         yhat   yhat_lower   yhat_upper         y     cutoff
0 2022-10-24  2901.368196  2611.531159  3214.689682  2618.125 2022-10-17
1 2022-10-31  2644.088834  2367.584261  2941.633669  2492.500 2022-10-17
2 2022-11-07  2601.260236  2318.089700  2879.466908  2772.375 2022-10-17
3 2022-11-14  2585.803861  2310.057636  2871.471665  2057.750 2022-10-17
4 2022-11-21  2853.000648  2558.417888  3123.057718  1735.875 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds        y  day_of_week  week_of_year  month
0   2021-01-04  184.000            0             1      1
1   2021-01-11  148.000            0             2      1
2   2021-01-18  165.000            0             3      1
3   2021-01-25  181.000            0             4      1
4   2021-02-01  186.000            0             5      2
..         ...      ...          ...           ...    ...
151 2023-11-27  696.500            0            48     11
152 2023-12-04  792.000            0            49     12
153 2023-12-11  676.750            0            50     12
154 2023-12-18  789.750            0            51     12
155 2023-12-25  677.875            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:28:43,501] A new study created in memory with name: no-name-fd271a13-134f-4921-8441-ba7e880b0fe0
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.08s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.40s/it]100%|##########| 2/2 [00:02<00:00,  1.35s/it]
[I 2025-05-23 20:28:47,942] Trial 0 finished with value: 361.7989334357471 and parameters: {'changepoint_prior_scale': 0.002479567958621288, 'seasonality_prior_scale': 1.0378239452003957, 'n_changepoints': 23}. Best is trial 0 with value: 361.7989334357471.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.65s/it]100%|##########| 2/2 [00:02<00:00,  1.04it/s]100%|##########| 2/2 [00:02<00:00,  1.06s/it]
[I 2025-05-23 20:28:50,909] Trial 1 finished with value: 356.20435311311985 and parameters: {'changepoint_prior_scale': 0.02739456189061551, 'seasonality_prior_scale': 0.02441048956174504, 'n_changepoints': 22}. Best is trial 1 with value: 356.20435311311985.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.09s/it]100%|##########| 2/2 [00:02<00:00,  1.17s/it]100%|##########| 2/2 [00:02<00:00,  1.31s/it]
[I 2025-05-23 20:28:54,424] Trial 2 finished with value: 257.1703674447101 and parameters: {'changepoint_prior_scale': 0.15804188807205355, 'seasonality_prior_scale': 2.5099366579563784, 'n_changepoints': 14}. Best is trial 2 with value: 257.1703674447101.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.23s/it]100%|##########| 2/2 [00:01<00:00,  1.13it/s]100%|##########| 2/2 [00:01<00:00,  1.07it/s]
[I 2025-05-23 20:28:57,197] Trial 3 finished with value: 351.7453071206864 and parameters: {'changepoint_prior_scale': 0.007115971875374118, 'seasonality_prior_scale': 0.12690390985692057, 'n_changepoints': 22}. Best is trial 2 with value: 257.1703674447101.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.33s/it]100%|##########| 2/2 [00:04<00:00,  1.80s/it]100%|##########| 2/2 [00:04<00:00,  2.03s/it]
[I 2025-05-23 20:29:02,072] Trial 4 finished with value: 255.8389463458244 and parameters: {'changepoint_prior_scale': 0.22047956569043725, 'seasonality_prior_scale': 0.1316468521652621, 'n_changepoints': 44}. Best is trial 4 with value: 255.8389463458244.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.03s/it]100%|##########| 2/2 [00:01<00:00,  1.21it/s]100%|##########| 2/2 [00:01<00:00,  1.16it/s]
[I 2025-05-23 20:29:04,723] Trial 5 finished with value: 355.83812828465807 and parameters: {'changepoint_prior_scale': 0.0070721376517082326, 'seasonality_prior_scale': 1.1526670518713393, 'n_changepoints': 6}. Best is trial 4 with value: 255.8389463458244.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.31s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.60s/it]100%|##########| 2/2 [00:03<00:00,  1.56s/it]
[I 2025-05-23 20:29:08,673] Trial 6 finished with value: 368.8461547990383 and parameters: {'changepoint_prior_scale': 0.007686428655166952, 'seasonality_prior_scale': 0.011121763030734024, 'n_changepoints': 37}. Best is trial 4 with value: 255.8389463458244.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.61s/it]100%|##########| 2/2 [00:02<00:00,  1.03it/s]100%|##########| 2/2 [00:02<00:00,  1.07s/it]
[I 2025-05-23 20:29:11,658] Trial 7 finished with value: 360.31394343686355 and parameters: {'changepoint_prior_scale': 0.013640083681672596, 'seasonality_prior_scale': 1.8901481153735948, 'n_changepoints': 43}. Best is trial 4 with value: 255.8389463458244.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.29s/it]100%|##########| 2/2 [00:01<00:00,  1.22it/s]100%|##########| 2/2 [00:01<00:00,  1.13it/s]
[I 2025-05-23 20:29:14,221] Trial 8 finished with value: 338.8082891164791 and parameters: {'changepoint_prior_scale': 0.002564413687306222, 'seasonality_prior_scale': 0.047988430701808464, 'n_changepoints': 6}. Best is trial 4 with value: 255.8389463458244.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.20it/s]100%|##########| 2/2 [00:01<00:00,  1.44it/s]100%|##########| 2/2 [00:01<00:00,  1.40it/s]
[I 2025-05-23 20:29:16,678] Trial 9 finished with value: 344.4126114810207 and parameters: {'changepoint_prior_scale': 0.0028322482883927674, 'seasonality_prior_scale': 0.499118437534561, 'n_changepoints': 6}. Best is trial 4 with value: 255.8389463458244.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.34s/it]100%|##########| 2/2 [00:04<00:00,  1.78s/it]100%|##########| 2/2 [00:04<00:00,  2.01s/it]
Rendimiento para la combinación BMX_2-BMX_OXXO-BMX_3207:
  horizon           mse        rmse  ...     mdape     smape  coverage
0 21 days   2639.956322   51.380505  ...  0.067186  0.101235  0.333333
1 28 days   5034.014618   70.950790  ...  0.108737  0.128375  0.166667
2 35 days   7621.862672   87.303280  ...  0.145973  0.143710  0.166667
3 42 days   8645.121564   92.979146  ...  0.145973  0.155278  0.166667
4 49 days  13268.277158  115.188008  ...  0.155066  0.183089  0.000000

[5 rows x 8 columns]
          ds        yhat  yhat_lower  yhat_upper        y     cutoff
0 2022-10-24  340.134735  318.484858  363.189123  332.250 2022-10-17
1 2022-10-31  281.128908  256.693138  303.765361  327.625 2022-10-17
2 2022-11-07  288.093672  265.399476  311.003851  374.500 2022-10-17
3 2022-11-14  268.655090  244.901085  291.799384  286.750 2022-10-17
4 2022-11-21  291.088585  269.411844  315.159068  252.375 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds        y  day_of_week  week_of_year  month
0   2021-01-04   30.000            0             1      1
1   2021-01-11   33.000            0             2      1
2   2021-01-18   40.125            0             3      1
3   2021-01-25   21.000            0             4      1
4   2021-02-01   34.000            0             5      2
..         ...      ...          ...           ...    ...
151 2023-11-27  115.625            0            48     11
152 2023-12-04  111.500            0            49     12
153 2023-12-11  102.625            0            50     12
154 2023-12-18  109.375            0            51     12
155 2023-12-25   93.750            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:29:21,684] A new study created in memory with name: no-name-c4f3cb98-012b-4498-9b35-394c656191d1
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.05it/s]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.11s/it]100%|##########| 2/2 [00:02<00:00,  1.08s/it]
[I 2025-05-23 20:29:25,610] Trial 0 finished with value: 59.60798180001513 and parameters: {'changepoint_prior_scale': 0.0012090113832451208, 'seasonality_prior_scale': 5.732471701891444, 'n_changepoints': 25}. Best is trial 0 with value: 59.60798180001513.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.29s/it]100%|##########| 2/2 [00:01<00:00,  1.10it/s]100%|##########| 2/2 [00:01<00:00,  1.03it/s]
[I 2025-05-23 20:29:28,429] Trial 1 finished with value: 58.103073746630166 and parameters: {'changepoint_prior_scale': 0.015570979516588939, 'seasonality_prior_scale': 2.352288237976041, 'n_changepoints': 17}. Best is trial 1 with value: 58.103073746630166.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.02it/s]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.15s/it]100%|##########| 2/2 [00:02<00:00,  1.13s/it]
[I 2025-05-23 20:29:32,063] Trial 2 finished with value: 59.60490917738172 and parameters: {'changepoint_prior_scale': 0.0013021168662792361, 'seasonality_prior_scale': 5.694052740785135, 'n_changepoints': 11}. Best is trial 1 with value: 58.103073746630166.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.71s/it]100%|##########| 2/2 [00:03<00:00,  1.49s/it]100%|##########| 2/2 [00:03<00:00,  1.68s/it]
[I 2025-05-23 20:29:36,435] Trial 3 finished with value: 19.387653718122763 and parameters: {'changepoint_prior_scale': 0.1752239154301222, 'seasonality_prior_scale': 2.133406647140271, 'n_changepoints': 50}. Best is trial 3 with value: 19.387653718122763.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.42s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.54s/it]100%|##########| 2/2 [00:03<00:00,  1.52s/it]
[I 2025-05-23 20:29:41,235] Trial 4 finished with value: 58.670603080694356 and parameters: {'changepoint_prior_scale': 0.001274453097166407, 'seasonality_prior_scale': 0.643063591884484, 'n_changepoints': 28}. Best is trial 3 with value: 19.387653718122763.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.02it/s]100%|##########| 2/2 [00:01<00:00,  1.34it/s]100%|##########| 2/2 [00:01<00:00,  1.28it/s]
[I 2025-05-23 20:29:43,720] Trial 5 finished with value: 61.427321625188185 and parameters: {'changepoint_prior_scale': 0.001999212804974864, 'seasonality_prior_scale': 0.6740466186214801, 'n_changepoints': 5}. Best is trial 3 with value: 19.387653718122763.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.64s/it]100%|##########| 2/2 [00:02<00:00,  1.04s/it]100%|##########| 2/2 [00:02<00:00,  1.13s/it]
[I 2025-05-23 20:29:46,740] Trial 6 finished with value: 55.024201331836395 and parameters: {'changepoint_prior_scale': 0.021163307697996122, 'seasonality_prior_scale': 0.2915536085966682, 'n_changepoints': 31}. Best is trial 3 with value: 19.387653718122763.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.87s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:04<00:00,  2.25s/it]100%|##########| 2/2 [00:04<00:00,  2.19s/it]
[I 2025-05-23 20:29:52,195] Trial 7 finished with value: 58.84303941914711 and parameters: {'changepoint_prior_scale': 0.01201832352169541, 'seasonality_prior_scale': 1.9186218942864193, 'n_changepoints': 39}. Best is trial 3 with value: 19.387653718122763.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.05s/it]100%|##########| 2/2 [00:01<00:00,  1.07it/s]100%|##########| 2/2 [00:01<00:00,  1.05it/s]
[I 2025-05-23 20:29:55,053] Trial 8 finished with value: 57.78201962389176 and parameters: {'changepoint_prior_scale': 0.01254360816631551, 'seasonality_prior_scale': 0.38497132322601313, 'n_changepoints': 7}. Best is trial 3 with value: 19.387653718122763.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.00s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.20s/it]100%|##########| 2/2 [00:02<00:00,  1.17s/it]
[I 2025-05-23 20:29:59,103] Trial 9 finished with value: 58.875925016349655 and parameters: {'changepoint_prior_scale': 0.0023451444677873383, 'seasonality_prior_scale': 2.07173570866365, 'n_changepoints': 32}. Best is trial 3 with value: 19.387653718122763.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.79s/it]100%|##########| 2/2 [00:03<00:00,  1.51s/it]100%|##########| 2/2 [00:03<00:00,  1.70s/it]
Rendimiento para la combinación BMX_2-BMX_OXXO-BMX_3402:
  horizon         mse       rmse  ...     mdape     smape  coverage
0 21 days   52.202171   7.225107  ...  0.071441  0.107704  0.500000
1 28 days   57.585240   7.588494  ...  0.061847  0.108606  0.333333
2 35 days   81.707012   9.039193  ...  0.065658  0.133107  0.333333
3 42 days  165.645065  12.870317  ...  0.114933  0.171270  0.166667
4 49 days  205.968669  14.351609  ...  0.217402  0.217238  0.000000

[5 rows x 8 columns]
          ds       yhat  yhat_lower  yhat_upper       y     cutoff
0 2022-10-24  52.659321   47.716510   57.789407  49.000 2022-10-17
1 2022-10-31  52.643635   48.017050   57.943871  39.000 2022-10-17
2 2022-11-07  45.138840   39.624608   50.338271  38.625 2022-10-17
3 2022-11-14  46.803671   41.614448   52.266767  44.875 2022-10-17
4 2022-11-21  47.922684   42.804063   53.313733  30.750 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds         y  day_of_week  week_of_year  month
0   2021-01-04   515.000            0             1      1
1   2021-01-11   470.000            0             2      1
2   2021-01-18   523.000            0             3      1
3   2021-01-25   640.000            0             4      1
4   2021-02-01   562.000            0             5      2
..         ...       ...          ...           ...    ...
151 2023-11-27  1244.750            0            48     11
152 2023-12-04  1237.375            0            49     12
153 2023-12-11  1438.500            0            50     12
154 2023-12-18  1452.375            0            51     12
155 2023-12-25  1512.875            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:30:03,487] A new study created in memory with name: no-name-a20f6df5-0b3e-4cd8-b4d9-8c3ded056252
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.88s/it]100%|##########| 2/2 [00:03<00:00,  1.63s/it]100%|##########| 2/2 [00:03<00:00,  1.82s/it]
[I 2025-05-23 20:30:08,317] Trial 0 finished with value: 393.83685679380557 and parameters: {'changepoint_prior_scale': 0.2638428560428277, 'seasonality_prior_scale': 1.5680048268790316, 'n_changepoints': 33}. Best is trial 0 with value: 393.83685679380557.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.18s/it]100%|##########| 2/2 [00:01<00:00,  1.22it/s]100%|##########| 2/2 [00:01<00:00,  1.14it/s]
[I 2025-05-23 20:30:10,999] Trial 1 finished with value: 527.065774468705 and parameters: {'changepoint_prior_scale': 0.005282183003944698, 'seasonality_prior_scale': 2.2040974935611968, 'n_changepoints': 15}. Best is trial 0 with value: 393.83685679380557.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.07s/it]100%|##########| 2/2 [00:02<00:00,  1.23s/it]100%|##########| 2/2 [00:02<00:00,  1.36s/it]
[I 2025-05-23 20:30:14,906] Trial 2 finished with value: 514.2460916860501 and parameters: {'changepoint_prior_scale': 0.027110203825518594, 'seasonality_prior_scale': 8.70374585765462, 'n_changepoints': 40}. Best is trial 0 with value: 393.83685679380557.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.44s/it]100%|##########| 2/2 [00:02<00:00,  1.26s/it]100%|##########| 2/2 [00:02<00:00,  1.29s/it]
[I 2025-05-23 20:30:19,272] Trial 3 finished with value: 526.0721975404442 and parameters: {'changepoint_prior_scale': 0.015425677195916348, 'seasonality_prior_scale': 1.1171128864842637, 'n_changepoints': 21}. Best is trial 0 with value: 393.83685679380557.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:04<00:04,  4.16s/it]100%|##########| 2/2 [00:05<00:00,  2.27s/it]100%|##########| 2/2 [00:05<00:00,  2.55s/it]
[I 2025-05-23 20:30:25,572] Trial 4 finished with value: 370.86568848079185 and parameters: {'changepoint_prior_scale': 0.40658415635572315, 'seasonality_prior_scale': 0.021879316691495832, 'n_changepoints': 30}. Best is trial 4 with value: 370.86568848079185.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.10s/it]100%|##########| 2/2 [00:02<00:00,  1.01it/s]100%|##########| 2/2 [00:02<00:00,  1.01s/it]
[I 2025-05-23 20:30:28,998] Trial 5 finished with value: 526.3352031053125 and parameters: {'changepoint_prior_scale': 0.016152314523763048, 'seasonality_prior_scale': 0.4833567718633106, 'n_changepoints': 6}. Best is trial 4 with value: 370.86568848079185.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.27s/it]100%|##########| 2/2 [00:03<00:00,  1.50s/it]100%|##########| 2/2 [00:03<00:00,  1.62s/it]
[I 2025-05-23 20:30:33,279] Trial 6 finished with value: 521.6546254358304 and parameters: {'changepoint_prior_scale': 0.018893647435647903, 'seasonality_prior_scale': 0.018737032397782606, 'n_changepoints': 47}. Best is trial 4 with value: 370.86568848079185.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.70s/it]100%|##########| 2/2 [00:04<00:00,  1.92s/it]100%|##########| 2/2 [00:04<00:00,  2.18s/it]
[I 2025-05-23 20:30:38,624] Trial 7 finished with value: 387.5085032877851 and parameters: {'changepoint_prior_scale': 0.25896691054842613, 'seasonality_prior_scale': 0.8272350311480855, 'n_changepoints': 21}. Best is trial 4 with value: 370.86568848079185.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.10s/it]100%|##########| 2/2 [00:04<00:00,  1.81s/it]100%|##########| 2/2 [00:04<00:00,  2.00s/it]
[I 2025-05-23 20:30:43,764] Trial 8 finished with value: 505.2718136537988 and parameters: {'changepoint_prior_scale': 0.031311711015589, 'seasonality_prior_scale': 6.249095792379976, 'n_changepoints': 41}. Best is trial 4 with value: 370.86568848079185.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.75s/it]100%|##########| 2/2 [00:02<00:00,  1.13s/it]100%|##########| 2/2 [00:02<00:00,  1.22s/it]
[I 2025-05-23 20:30:47,388] Trial 9 finished with value: 485.06444347024245 and parameters: {'changepoint_prior_scale': 0.04192119267193335, 'seasonality_prior_scale': 0.01004198775655341, 'n_changepoints': 26}. Best is trial 4 with value: 370.86568848079185.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.83s/it]100%|##########| 2/2 [00:03<00:00,  1.56s/it]100%|##########| 2/2 [00:03<00:00,  1.75s/it]
Rendimiento para la combinación BMX_2-BMX_OXXO-BMX_3931:
  horizon            mse        rmse  ...     mdape     smape  coverage
0 21 days   62023.867215  249.045914  ...  0.080438  0.136352  0.500000
1 28 days  155935.303404  394.886444  ...  0.209726  0.242069  0.166667
2 35 days  160142.953524  400.178652  ...  0.209726  0.263586  0.000000
3 42 days  159281.157369  399.100435  ...  0.207245  0.267941  0.000000
4 49 days  121203.338522  348.142699  ...  0.201238  0.246664  0.000000

[5 rows x 8 columns]
          ds        yhat  yhat_lower  yhat_upper        y     cutoff
0 2022-10-24  781.336300  706.354074  864.105907  811.125 2022-10-17
1 2022-10-31  691.439662  604.668146  775.060900  663.250 2022-10-17
2 2022-11-07  689.762959  611.151369  770.925666  782.375 2022-10-17
3 2022-11-14  622.050462  537.404960  707.284875  770.250 2022-10-17
4 2022-11-21  634.524639  551.625666  720.150047  750.375 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds          y  day_of_week  week_of_year  month
0   2021-01-04  31399.000            0             1      1
1   2021-01-11  24342.000            0             2      1
2   2021-01-18  29908.000            0             3      1
3   2021-01-25  37264.125            0             4      1
4   2021-02-01  33508.250            0             5      2
..         ...        ...          ...           ...    ...
151 2023-11-27  29397.875            0            48     11
152 2023-12-04  29347.500            0            49     12
153 2023-12-11  28290.750            0            50     12
154 2023-12-18  34358.625            0            51     12
155 2023-12-25  31072.500            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:30:51,788] A new study created in memory with name: no-name-a09ee442-a993-4b77-83a1-bc3c95bb32f2
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.09it/s]100%|##########| 2/2 [00:01<00:00,  1.35it/s]100%|##########| 2/2 [00:01<00:00,  1.30it/s]
[I 2025-05-23 20:30:55,110] Trial 0 finished with value: 5395.120950012249 and parameters: {'changepoint_prior_scale': 0.0017122668865382868, 'seasonality_prior_scale': 3.4031528138395104, 'n_changepoints': 18}. Best is trial 0 with value: 5395.120950012249.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.07it/s]100%|##########| 2/2 [00:01<00:00,  1.22it/s]100%|##########| 2/2 [00:01<00:00,  1.19it/s]
[I 2025-05-23 20:30:59,397] Trial 1 finished with value: 3708.546554677575 and parameters: {'changepoint_prior_scale': 0.0017161899257239484, 'seasonality_prior_scale': 0.11247474850276133, 'n_changepoints': 15}. Best is trial 1 with value: 3708.546554677575.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.91s/it]100%|##########| 2/2 [00:04<00:00,  2.07s/it]100%|##########| 2/2 [00:04<00:00,  2.35s/it]
[I 2025-05-23 20:31:05,334] Trial 2 finished with value: 4678.790199385556 and parameters: {'changepoint_prior_scale': 0.1400701128593552, 'seasonality_prior_scale': 0.168169727967238, 'n_changepoints': 46}. Best is trial 1 with value: 3708.546554677575.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.42s/it]100%|##########| 2/2 [00:03<00:00,  1.43s/it]100%|##########| 2/2 [00:03<00:00,  1.58s/it]
[I 2025-05-23 20:31:09,430] Trial 3 finished with value: 6928.185955200381 and parameters: {'changepoint_prior_scale': 0.47412830786212334, 'seasonality_prior_scale': 0.08045754873642062, 'n_changepoints': 22}. Best is trial 1 with value: 3708.546554677575.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.06s/it]100%|##########| 2/2 [00:01<00:00,  1.20it/s]100%|##########| 2/2 [00:01<00:00,  1.15it/s]
[I 2025-05-23 20:31:12,007] Trial 4 finished with value: 4889.252663560709 and parameters: {'changepoint_prior_scale': 0.005792558452236488, 'seasonality_prior_scale': 2.120394348739874, 'n_changepoints': 7}. Best is trial 1 with value: 3708.546554677575.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.19s/it]100%|##########| 2/2 [00:03<00:00,  1.45s/it]100%|##########| 2/2 [00:03<00:00,  1.56s/it]
[I 2025-05-23 20:31:16,680] Trial 5 finished with value: 4071.2481518367676 and parameters: {'changepoint_prior_scale': 0.023889968764437376, 'seasonality_prior_scale': 0.676161150132929, 'n_changepoints': 47}. Best is trial 1 with value: 3708.546554677575.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.47s/it]100%|##########| 2/2 [00:02<00:00,  1.02it/s]100%|##########| 2/2 [00:02<00:00,  1.05s/it]
[I 2025-05-23 20:31:19,713] Trial 6 finished with value: 4224.901681772268 and parameters: {'changepoint_prior_scale': 0.09685069600626844, 'seasonality_prior_scale': 0.07183032642003857, 'n_changepoints': 33}. Best is trial 1 with value: 3708.546554677575.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.24s/it]100%|##########| 2/2 [00:01<00:00,  1.09it/s]100%|##########| 2/2 [00:01<00:00,  1.04it/s]
[I 2025-05-23 20:31:22,677] Trial 7 finished with value: 5169.205465388096 and parameters: {'changepoint_prior_scale': 0.07765437056191057, 'seasonality_prior_scale': 1.8239628249405464, 'n_changepoints': 19}. Best is trial 1 with value: 3708.546554677575.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.48s/it]100%|##########| 2/2 [00:02<00:00,  1.15s/it]100%|##########| 2/2 [00:02<00:00,  1.20s/it]
[I 2025-05-23 20:31:26,081] Trial 8 finished with value: 5943.052127294469 and parameters: {'changepoint_prior_scale': 0.2609538931889947, 'seasonality_prior_scale': 0.010606549738685906, 'n_changepoints': 12}. Best is trial 1 with value: 3708.546554677575.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.63s/it]100%|##########| 2/2 [00:02<00:00,  1.01s/it]100%|##########| 2/2 [00:02<00:00,  1.10s/it]
[I 2025-05-23 20:31:29,182] Trial 9 finished with value: 5910.843111929616 and parameters: {'changepoint_prior_scale': 0.014722710899734582, 'seasonality_prior_scale': 9.808077030150809, 'n_changepoints': 33}. Best is trial 1 with value: 3708.546554677575.
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.05it/s]100%|##########| 2/2 [00:01<00:00,  1.22it/s]100%|##########| 2/2 [00:01<00:00,  1.19it/s]
Rendimiento para la combinación BMX_2-BMX_TRADICIONAL-BMX_3001:
  horizon           mse         rmse  ...     mdape     smape  coverage
0 21 days  2.648802e+07  5146.651548  ...  0.061973  0.093671  0.666667
1 28 days  2.043912e+07  4520.964412  ...  0.061973  0.095859  0.666667
2 35 days  3.532423e+07  5943.419219  ...  0.061973  0.133435  0.666667
3 42 days  3.560246e+07  5966.779379  ...  0.078932  0.135029  0.500000
4 49 days  3.025616e+07  5500.559576  ...  0.072076  0.117704  0.666667

[5 rows x 8 columns]
          ds          yhat    yhat_lower    yhat_upper          y     cutoff
0 2022-10-24  38817.543836  35767.676007  41566.383151  38568.375 2022-10-17
1 2022-10-31  32709.197156  29708.945538  35504.080414  31754.375 2022-10-17
2 2022-11-07  33955.427929  31108.726074  36857.505341  35435.750 2022-10-17
3 2022-11-14  34151.231959  31175.219288  36906.207237  27426.375 2022-10-17
4 2022-11-21  35621.901983  32673.772600  38596.058204  23349.625 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds         y  day_of_week  week_of_year  month
0   2021-01-04  1717.000            0             1      1
1   2021-01-11  1428.000            0             2      1
2   2021-01-18  1584.500            0             3      1
3   2021-01-25  1788.750            0             4      1
4   2021-02-01  2078.500            0             5      2
..         ...       ...          ...           ...    ...
151 2023-11-27  2066.000            0            48     11
152 2023-12-04  2284.375            0            49     12
153 2023-12-11  1881.500            0            50     12
154 2023-12-18  2315.375            0            51     12
155 2023-12-25  1932.750            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:31:33,460] A new study created in memory with name: no-name-d9c6d3cf-35f4-4cf9-a799-c93fa1eec11d
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.70s/it]100%|##########| 2/2 [00:02<00:00,  1.25s/it]100%|##########| 2/2 [00:02<00:00,  1.32s/it]
[I 2025-05-23 20:31:37,236] Trial 0 finished with value: 332.0065475587406 and parameters: {'changepoint_prior_scale': 0.04102100258199633, 'seasonality_prior_scale': 0.0940042943454142, 'n_changepoints': 24}. Best is trial 0 with value: 332.0065475587406.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.14s/it]100%|##########| 2/2 [00:01<00:00,  1.08it/s]100%|##########| 2/2 [00:01<00:00,  1.04it/s]
[I 2025-05-23 20:31:40,552] Trial 1 finished with value: 417.3324497747186 and parameters: {'changepoint_prior_scale': 0.013247027917802596, 'seasonality_prior_scale': 0.012499950323376446, 'n_changepoints': 24}. Best is trial 0 with value: 332.0065475587406.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.02s/it]100%|##########| 2/2 [00:03<00:00,  1.41s/it]100%|##########| 2/2 [00:03<00:00,  1.51s/it]
[I 2025-05-23 20:31:47,130] Trial 2 finished with value: 408.41106128377055 and parameters: {'changepoint_prior_scale': 0.008193010833278688, 'seasonality_prior_scale': 4.932831771422331, 'n_changepoints': 41}. Best is trial 0 with value: 332.0065475587406.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.83s/it]100%|##########| 2/2 [00:02<00:00,  1.16s/it]100%|##########| 2/2 [00:02<00:00,  1.26s/it]
[I 2025-05-23 20:31:51,427] Trial 3 finished with value: 353.02178146701806 and parameters: {'changepoint_prior_scale': 0.006959120445104947, 'seasonality_prior_scale': 0.01825681946634932, 'n_changepoints': 28}. Best is trial 0 with value: 332.0065475587406.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:05<00:05,  5.07s/it]100%|##########| 2/2 [00:05<00:00,  2.40s/it]100%|##########| 2/2 [00:05<00:00,  2.80s/it]
[I 2025-05-23 20:31:58,440] Trial 4 finished with value: 525.7124575015256 and parameters: {'changepoint_prior_scale': 0.444558383435771, 'seasonality_prior_scale': 0.01746115009313235, 'n_changepoints': 47}. Best is trial 0 with value: 332.0065475587406.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.81s/it]100%|##########| 2/2 [00:04<00:00,  2.18s/it]100%|##########| 2/2 [00:04<00:00,  2.42s/it]
[I 2025-05-23 20:32:04,395] Trial 5 finished with value: 409.42191448379873 and parameters: {'changepoint_prior_scale': 0.2316528117194721, 'seasonality_prior_scale': 2.6561781648854654, 'n_changepoints': 29}. Best is trial 0 with value: 332.0065475587406.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.49s/it]100%|##########| 2/2 [00:02<00:00,  1.09it/s]100%|##########| 2/2 [00:02<00:00,  1.00s/it]
[I 2025-05-23 20:32:07,149] Trial 6 finished with value: 328.7954521060286 and parameters: {'changepoint_prior_scale': 0.039616687875630996, 'seasonality_prior_scale': 0.20017371855360866, 'n_changepoints': 24}. Best is trial 6 with value: 328.7954521060286.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.75s/it]100%|##########| 2/2 [00:02<00:00,  1.12s/it]100%|##########| 2/2 [00:02<00:00,  1.21s/it]
[I 2025-05-23 20:32:10,439] Trial 7 finished with value: 459.015693471726 and parameters: {'changepoint_prior_scale': 0.1169218247077761, 'seasonality_prior_scale': 0.02016565124294248, 'n_changepoints': 37}. Best is trial 6 with value: 328.7954521060286.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.52s/it]100%|##########| 2/2 [00:02<00:00,  1.05s/it]100%|##########| 2/2 [00:02<00:00,  1.12s/it]
[I 2025-05-23 20:32:13,922] Trial 8 finished with value: 401.4250425635957 and parameters: {'changepoint_prior_scale': 0.005356677833402796, 'seasonality_prior_scale': 3.3570620239538504, 'n_changepoints': 10}. Best is trial 6 with value: 328.7954521060286.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.01it/s]100%|##########| 2/2 [00:01<00:00,  1.26it/s]100%|##########| 2/2 [00:01<00:00,  1.22it/s]
[I 2025-05-23 20:32:17,314] Trial 9 finished with value: 375.3919667574959 and parameters: {'changepoint_prior_scale': 0.16976682258934225, 'seasonality_prior_scale': 0.07091817886605516, 'n_changepoints': 5}. Best is trial 6 with value: 328.7954521060286.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.46s/it]100%|##########| 2/2 [00:02<00:00,  1.03it/s]100%|##########| 2/2 [00:02<00:00,  1.05s/it]
Rendimiento para la combinación BMX_2-BMX_TRADICIONAL-BMX_3207:
  horizon            mse        rmse  ...     mdape     smape  coverage
0 21 days   28477.025332  168.751371  ...  0.056908  0.062681  0.666667
1 28 days   28061.910645  167.516897  ...  0.056908  0.061198  0.666667
2 35 days  119258.447279  345.338164  ...  0.064840  0.121104  0.500000
3 42 days  111719.718988  334.244998  ...  0.040179  0.109739  0.666667
4 49 days  120434.055388  347.036101  ...  0.076944  0.126557  0.500000

[5 rows x 8 columns]
          ds         yhat   yhat_lower   yhat_upper         y     cutoff
0 2022-10-24  2411.167630  2222.597741  2589.550474  2343.125 2022-10-17
1 2022-10-31  2309.285875  2117.521180  2489.490887  2053.750 2022-10-17
2 2022-11-07  2214.396959  2030.505262  2404.177539  2321.875 2022-10-17
3 2022-11-14  2059.748181  1887.380510  2250.402626  2015.375 2022-10-17
4 2022-11-21  2098.339850  1906.053162  2294.591469  1359.625 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds        y  day_of_week  week_of_year  month
0   2021-01-04  651.000            0             1      1
1   2021-01-11  649.000            0             2      1
2   2021-01-18  714.000            0             3      1
3   2021-01-25  589.000            0             4      1
4   2021-02-01  720.000            0             5      2
..         ...      ...          ...           ...    ...
151 2023-11-27  678.125            0            48     11
152 2023-12-04  622.875            0            49     12
153 2023-12-11  694.375            0            50     12
154 2023-12-18  698.625            0            51     12
155 2023-12-25  602.125            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:32:20,396] A new study created in memory with name: no-name-c6161f43-a250-401d-87b3-db92bf3b068d
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.13s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.38s/it]100%|##########| 2/2 [00:02<00:00,  1.34s/it]
[I 2025-05-23 20:32:25,199] Trial 0 finished with value: 137.79918464220833 and parameters: {'changepoint_prior_scale': 0.0018142485909850008, 'seasonality_prior_scale': 0.1566869880795291, 'n_changepoints': 22}. Best is trial 0 with value: 137.79918464220833.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.76s/it]100%|##########| 2/2 [00:02<00:00,  1.30s/it]100%|##########| 2/2 [00:02<00:00,  1.37s/it]
[I 2025-05-23 20:32:29,334] Trial 1 finished with value: 135.43796869932785 and parameters: {'changepoint_prior_scale': 0.011589073006339183, 'seasonality_prior_scale': 0.3751868511627761, 'n_changepoints': 32}. Best is trial 1 with value: 135.43796869932785.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.06s/it]100%|##########| 2/2 [00:01<00:00,  1.11it/s]100%|##########| 2/2 [00:01<00:00,  1.08it/s]
[I 2025-05-23 20:32:32,366] Trial 2 finished with value: 88.79518192827896 and parameters: {'changepoint_prior_scale': 0.06914511577272758, 'seasonality_prior_scale': 1.6965229564942887, 'n_changepoints': 5}. Best is trial 2 with value: 88.79518192827896.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.79s/it]100%|##########| 2/2 [00:02<00:00,  1.21s/it]100%|##########| 2/2 [00:02<00:00,  1.30s/it]
[I 2025-05-23 20:32:36,270] Trial 3 finished with value: 87.51727868414531 and parameters: {'changepoint_prior_scale': 0.09916639495517705, 'seasonality_prior_scale': 4.974870621794938, 'n_changepoints': 12}. Best is trial 3 with value: 87.51727868414531.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.18it/s]100%|##########| 2/2 [00:01<00:00,  1.11it/s]100%|##########| 2/2 [00:01<00:00,  1.12it/s]
[I 2025-05-23 20:32:39,480] Trial 4 finished with value: 91.9270879699559 and parameters: {'changepoint_prior_scale': 0.0017551029379732073, 'seasonality_prior_scale': 0.1575771244524911, 'n_changepoints': 5}. Best is trial 3 with value: 87.51727868414531.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.86s/it]100%|##########| 2/2 [00:02<00:00,  1.08s/it]100%|##########| 2/2 [00:02<00:00,  1.20s/it]
[I 2025-05-23 20:32:42,805] Trial 5 finished with value: 108.40917528120539 and parameters: {'changepoint_prior_scale': 0.052785360930787215, 'seasonality_prior_scale': 0.1452059913529042, 'n_changepoints': 30}. Best is trial 3 with value: 87.51727868414531.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.32s/it]100%|##########| 2/2 [00:03<00:00,  1.38s/it]100%|##########| 2/2 [00:03<00:00,  1.52s/it]
[I 2025-05-23 20:32:46,824] Trial 6 finished with value: 124.53325235384308 and parameters: {'changepoint_prior_scale': 0.06805713434980307, 'seasonality_prior_scale': 0.014165072621069209, 'n_changepoints': 49}. Best is trial 3 with value: 87.51727868414531.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.19s/it]100%|##########| 2/2 [00:02<00:00,  1.28s/it]100%|##########| 2/2 [00:02<00:00,  1.42s/it]
[I 2025-05-23 20:32:50,582] Trial 7 finished with value: 80.19418998888612 and parameters: {'changepoint_prior_scale': 0.20405652771052907, 'seasonality_prior_scale': 2.777872283060433, 'n_changepoints': 49}. Best is trial 7 with value: 80.19418998888612.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.41s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.63s/it]100%|##########| 2/2 [00:03<00:00,  1.60s/it]
[I 2025-05-23 20:32:56,620] Trial 8 finished with value: 140.54810004671126 and parameters: {'changepoint_prior_scale': 0.005917894458629523, 'seasonality_prior_scale': 2.206464791079492, 'n_changepoints': 37}. Best is trial 7 with value: 80.19418998888612.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.52s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:04<00:00,  2.22s/it]100%|##########| 2/2 [00:04<00:00,  2.12s/it]
[I 2025-05-23 20:33:03,311] Trial 9 finished with value: 140.66853893401296 and parameters: {'changepoint_prior_scale': 0.0012678378679651667, 'seasonality_prior_scale': 4.743465333955853, 'n_changepoints': 42}. Best is trial 7 with value: 80.19418998888612.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.70s/it]100%|##########| 2/2 [00:03<00:00,  1.53s/it]100%|##########| 2/2 [00:03<00:00,  1.71s/it]
Rendimiento para la combinación BMX_2-BMX_TRADICIONAL-BMX_3402:
  horizon          mse       rmse  ...     mdape     smape  coverage
0 21 days  5748.075245  75.816062  ...  0.090545  0.085598  0.500000
1 28 days  6794.215219  82.427030  ...  0.090441  0.094319  0.500000
2 35 days  6098.639796  78.093788  ...  0.085179  0.092352  0.500000
3 42 days  6344.361166  79.651498  ...  0.110133  0.099682  0.333333
4 49 days  3649.543678  60.411453  ...  0.075698  0.076906  0.500000

[5 rows x 8 columns]
          ds        yhat  yhat_lower  yhat_upper        y     cutoff
0 2022-10-24  831.841338  783.366246  883.286233  729.125 2022-10-17
1 2022-10-31  732.090195  681.697962  780.512405  621.375 2022-10-17
2 2022-11-07  730.797789  683.021083  781.709544  631.250 2022-10-17
3 2022-11-14  693.532956  644.516506  740.988674  559.625 2022-10-17
4 2022-11-21  703.692829  651.484650  752.379869  623.000 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds          y  day_of_week  week_of_year  month
0   2021-01-04  15485.625            0             1      1
1   2021-01-11  15094.500            0             2      1
2   2021-01-18  15407.000            0             3      1
3   2021-01-25  20646.125            0             4      1
4   2021-02-01  14561.375            0             5      2
..         ...        ...          ...           ...    ...
151 2023-11-27  13387.125            0            48     11
152 2023-12-04  13994.625            0            49     12
153 2023-12-11  18811.125            0            50     12
154 2023-12-18  15974.750            0            51     12
155 2023-12-25  15225.375            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:33:07,972] A new study created in memory with name: no-name-d873b983-8b50-48e1-b8c8-d034f0868858
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.24s/it]100%|##########| 2/2 [00:01<00:00,  1.12it/s]100%|##########| 2/2 [00:01<00:00,  1.06it/s]
[I 2025-05-23 20:33:10,898] Trial 0 finished with value: 2307.189274392371 and parameters: {'changepoint_prior_scale': 0.007425671334459746, 'seasonality_prior_scale': 0.15251182527473373, 'n_changepoints': 23}. Best is trial 0 with value: 2307.189274392371.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.93s/it]100%|##########| 2/2 [00:02<00:00,  1.15s/it]100%|##########| 2/2 [00:02<00:00,  1.27s/it]
[I 2025-05-23 20:33:14,327] Trial 1 finished with value: 2391.1320942415878 and parameters: {'changepoint_prior_scale': 0.039477620171693976, 'seasonality_prior_scale': 0.013268704446945894, 'n_changepoints': 46}. Best is trial 0 with value: 2307.189274392371.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.42s/it]100%|##########| 2/2 [00:02<00:00,  1.09s/it]100%|##########| 2/2 [00:02<00:00,  1.14s/it]
[I 2025-05-23 20:33:17,626] Trial 2 finished with value: 2358.7187318747087 and parameters: {'changepoint_prior_scale': 0.009127744132885371, 'seasonality_prior_scale': 1.2074602675672608, 'n_changepoints': 38}. Best is trial 0 with value: 2307.189274392371.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.93s/it]100%|##########| 2/2 [00:02<00:00,  1.15s/it]100%|##########| 2/2 [00:02<00:00,  1.27s/it]
[I 2025-05-23 20:33:21,210] Trial 3 finished with value: 2301.228938012318 and parameters: {'changepoint_prior_scale': 0.0487272133750016, 'seasonality_prior_scale': 1.5339458352681155, 'n_changepoints': 35}. Best is trial 3 with value: 2301.228938012318.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.54s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.50s/it]100%|##########| 2/2 [00:03<00:00,  1.51s/it]
[I 2025-05-23 20:33:26,368] Trial 4 finished with value: 2325.200038380107 and parameters: {'changepoint_prior_scale': 0.0015537681427351285, 'seasonality_prior_scale': 1.424504011205604, 'n_changepoints': 37}. Best is trial 3 with value: 2301.228938012318.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.26s/it]100%|##########| 2/2 [00:01<00:00,  1.08it/s]100%|##########| 2/2 [00:01<00:00,  1.02it/s]
[I 2025-05-23 20:33:29,176] Trial 5 finished with value: 2355.4720553773845 and parameters: {'changepoint_prior_scale': 0.011380169125567913, 'seasonality_prior_scale': 1.206435085999682, 'n_changepoints': 32}. Best is trial 3 with value: 2301.228938012318.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.37s/it]100%|##########| 2/2 [00:03<00:00,  1.41s/it]100%|##########| 2/2 [00:03<00:00,  1.55s/it]
[I 2025-05-23 20:33:33,477] Trial 6 finished with value: 2268.00455931125 and parameters: {'changepoint_prior_scale': 0.07387313941980475, 'seasonality_prior_scale': 0.02582785074681932, 'n_changepoints': 47}. Best is trial 6 with value: 2268.00455931125.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.12s/it]100%|##########| 2/2 [00:01<00:00,  1.18it/s]100%|##########| 2/2 [00:01<00:00,  1.13it/s]
[I 2025-05-23 20:33:36,296] Trial 7 finished with value: 2294.886390277911 and parameters: {'changepoint_prior_scale': 0.01325609062565471, 'seasonality_prior_scale': 0.10349137997980044, 'n_changepoints': 13}. Best is trial 6 with value: 2268.00455931125.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.21s/it]100%|##########| 2/2 [00:01<00:00,  1.12it/s]100%|##########| 2/2 [00:01<00:00,  1.07it/s]
[I 2025-05-23 20:33:39,172] Trial 8 finished with value: 2414.3035241120206 and parameters: {'changepoint_prior_scale': 0.026973568966053126, 'seasonality_prior_scale': 6.127172430655978, 'n_changepoints': 12}. Best is trial 6 with value: 2268.00455931125.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.80s/it]100%|##########| 2/2 [00:02<00:00,  1.03s/it]100%|##########| 2/2 [00:02<00:00,  1.15s/it]
[I 2025-05-23 20:33:42,509] Trial 9 finished with value: 2272.762073388233 and parameters: {'changepoint_prior_scale': 0.0647688746846108, 'seasonality_prior_scale': 1.0033521011191977, 'n_changepoints': 43}. Best is trial 6 with value: 2268.00455931125.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.32s/it]100%|##########| 2/2 [00:03<00:00,  1.39s/it]100%|##########| 2/2 [00:03<00:00,  1.53s/it]
Rendimiento para la combinación BMX_2-BMX_TRADICIONAL-BMX_3931:
  horizon           mse         rmse  ...     mdape     smape  coverage
0 21 days  7.047349e+06  2654.684349  ...  0.140374  0.129885  0.333333
1 28 days  7.856729e+06  2802.985649  ...  0.117574  0.118925  0.500000
2 35 days  6.898728e+06  2626.542895  ...  0.072974  0.101212  0.666667
3 42 days  6.989521e+06  2643.770263  ...  0.088624  0.106439  0.500000
4 49 days  7.179314e+06  2679.424172  ...  0.088624  0.110192  0.500000

[5 rows x 8 columns]
          ds          yhat    yhat_lower    yhat_upper         y     cutoff
0 2022-10-24  19802.235523  18146.094319  21530.278460  17698.50 2022-10-17
1 2022-10-31  17049.055323  15349.442558  18666.813260  14427.75 2022-10-17
2 2022-11-07  17810.834020  16074.008020  19437.167947  16595.00 2022-10-17
3 2022-11-14  16899.687113  15127.764795  18739.798180  16382.25 2022-10-17
4 2022-11-21  15594.491522  14002.231008  17227.094858  19599.25 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds       y  day_of_week  week_of_year  month
0   2021-01-04  1216.0            0             1      1
1   2021-01-11  1465.0            0             2      1
2   2021-01-18  1513.0            0             3      1
3   2021-01-25  1480.0            0             4      1
4   2021-02-01  2233.0            0             5      2
..         ...     ...          ...           ...    ...
151 2023-11-27  2723.0            0            48     11
152 2023-12-04  4326.0            0            49     12
153 2023-12-11  3895.0            0            50     12
154 2023-12-18  4572.0            0            51     12
155 2023-12-25  6116.0            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:33:46,682] A new study created in memory with name: no-name-66a99ebc-2d5f-44ed-8062-09476edfbfc9
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.49s/it]100%|##########| 2/2 [00:02<00:00,  1.18s/it]100%|##########| 2/2 [00:02<00:00,  1.22s/it]
[I 2025-05-23 20:33:51,656] Trial 0 finished with value: 790.9584518710418 and parameters: {'changepoint_prior_scale': 0.002223977148398816, 'seasonality_prior_scale': 1.6506741358407782, 'n_changepoints': 21}. Best is trial 0 with value: 790.9584518710418.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.05s/it]100%|##########| 2/2 [00:01<00:00,  1.15it/s]100%|##########| 2/2 [00:01<00:00,  1.11it/s]
[I 2025-05-23 20:33:55,435] Trial 1 finished with value: 752.0902235002015 and parameters: {'changepoint_prior_scale': 0.004906587133363145, 'seasonality_prior_scale': 0.22893367228753234, 'n_changepoints': 23}. Best is trial 1 with value: 752.0902235002015.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.43s/it]100%|##########| 2/2 [00:02<00:00,  1.04s/it]100%|##########| 2/2 [00:02<00:00,  1.10s/it]
[I 2025-05-23 20:33:58,522] Trial 2 finished with value: 790.3353375240331 and parameters: {'changepoint_prior_scale': 0.02570219938448009, 'seasonality_prior_scale': 0.5173230996382185, 'n_changepoints': 24}. Best is trial 1 with value: 752.0902235002015.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.81s/it]100%|##########| 2/2 [00:03<00:00,  1.63s/it]100%|##########| 2/2 [00:03<00:00,  1.81s/it]
[I 2025-05-23 20:34:03,548] Trial 3 finished with value: 980.1569989351352 and parameters: {'changepoint_prior_scale': 0.08876949144822378, 'seasonality_prior_scale': 3.629538716506229, 'n_changepoints': 34}. Best is trial 1 with value: 752.0902235002015.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.30s/it]100%|##########| 2/2 [00:02<00:00,  1.31s/it]100%|##########| 2/2 [00:02<00:00,  1.46s/it]
[I 2025-05-23 20:34:07,320] Trial 4 finished with value: 962.3777480783052 and parameters: {'changepoint_prior_scale': 0.07454262813280912, 'seasonality_prior_scale': 4.226765744462868, 'n_changepoints': 24}. Best is trial 1 with value: 752.0902235002015.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.98s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.69s/it]100%|##########| 2/2 [00:03<00:00,  1.73s/it]
[I 2025-05-23 20:34:12,547] Trial 5 finished with value: 853.2799984765483 and parameters: {'changepoint_prior_scale': 0.0012724195463263911, 'seasonality_prior_scale': 0.015698069724714468, 'n_changepoints': 24}. Best is trial 1 with value: 752.0902235002015.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.10it/s]100%|##########| 2/2 [00:01<00:00,  1.27it/s]100%|##########| 2/2 [00:01<00:00,  1.24it/s]
[I 2025-05-23 20:34:15,274] Trial 6 finished with value: 745.22505564182 and parameters: {'changepoint_prior_scale': 0.004005862196101641, 'seasonality_prior_scale': 0.05060868676905812, 'n_changepoints': 8}. Best is trial 6 with value: 745.22505564182.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  3.00s/it]100%|##########| 2/2 [00:03<00:00,  1.69s/it]100%|##########| 2/2 [00:03<00:00,  1.89s/it]
[I 2025-05-23 20:34:20,068] Trial 7 finished with value: 645.0151144692412 and parameters: {'changepoint_prior_scale': 0.41556636215948356, 'seasonality_prior_scale': 0.5937875870131741, 'n_changepoints': 32}. Best is trial 7 with value: 645.0151144692412.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:05<00:05,  5.63s/it]100%|##########| 2/2 [00:06<00:00,  2.58s/it]100%|##########| 2/2 [00:06<00:00,  3.04s/it]
[I 2025-05-23 20:34:27,352] Trial 8 finished with value: 649.5307873990254 and parameters: {'changepoint_prior_scale': 0.3314491260694849, 'seasonality_prior_scale': 0.16832035755232067, 'n_changepoints': 49}. Best is trial 7 with value: 645.0151144692412.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.00it/s]100%|##########| 2/2 [00:01<00:00,  1.34it/s]100%|##########| 2/2 [00:01<00:00,  1.28it/s]
[I 2025-05-23 20:34:30,553] Trial 9 finished with value: 757.8726384008797 and parameters: {'changepoint_prior_scale': 0.002198934962519088, 'seasonality_prior_scale': 0.205211398097733, 'n_changepoints': 10}. Best is trial 7 with value: 645.0151144692412.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.97s/it]100%|##########| 2/2 [00:03<00:00,  1.66s/it]100%|##########| 2/2 [00:03<00:00,  1.86s/it]
Rendimiento para la combinación BMX_310-BMX_AUTOSERVICIOS-BMX_3001:
  horizon            mse        rmse  ...     mdape     smape  coverage
0 21 days  401228.502784  633.426004  ...  0.147329  0.175071  0.500000
1 28 days  396109.848481  629.372583  ...  0.157571  0.185257  0.500000
2 35 days   84707.288305  291.045165  ...  0.061166  0.100192  0.833333
3 42 days  184381.422112  429.396579  ...  0.117088  0.120985  0.666667
4 49 days  142601.119437  377.625634  ...  0.078091  0.086053  0.833333

[5 rows x 8 columns]
          ds         yhat   yhat_lower   yhat_upper       y     cutoff
0 2022-10-24  3137.012614  2753.220628  3528.920041  2585.0 2022-10-17
1 2022-10-31  3199.906282  2830.564179  3595.284103  1969.0 2022-10-17
2 2022-11-07  2391.422113  1984.126190  2764.683896  2212.0 2022-10-17
3 2022-11-14  1728.798610  1352.652614  2116.225024  2257.0 2022-10-17
4 2022-11-21  2222.586480  1865.293732  2632.781369  2599.0 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds       y  day_of_week  week_of_year  month
0   2021-01-04   595.0            0             1      1
1   2021-01-11   341.0            0             2      1
2   2021-01-18   700.0            0             3      1
3   2021-01-25   700.0            0             4      1
4   2021-02-01   930.0            0             5      2
..         ...     ...          ...           ...    ...
151 2023-11-27   864.0            0            48     11
152 2023-12-04   807.0            0            49     12
153 2023-12-11  1111.0            0            50     12
154 2023-12-18  1639.0            0            51     12
155 2023-12-25  1221.0            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:34:35,275] A new study created in memory with name: no-name-1bd92ab9-4f55-4a75-b32b-bb2b66091fb5
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.33s/it]100%|##########| 2/2 [00:03<00:00,  1.54s/it]100%|##########| 2/2 [00:03<00:00,  1.66s/it]
[I 2025-05-23 20:34:39,564] Trial 0 finished with value: 467.4252587393767 and parameters: {'changepoint_prior_scale': 0.25008761961321196, 'seasonality_prior_scale': 0.01192872705301384, 'n_changepoints': 26}. Best is trial 0 with value: 467.4252587393767.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:04<00:04,  4.44s/it]100%|##########| 2/2 [00:05<00:00,  2.20s/it]100%|##########| 2/2 [00:05<00:00,  2.53s/it]
[I 2025-05-23 20:34:45,779] Trial 1 finished with value: 301.7569746071827 and parameters: {'changepoint_prior_scale': 0.4009320366877542, 'seasonality_prior_scale': 0.24700648981341583, 'n_changepoints': 45}. Best is trial 1 with value: 301.7569746071827.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.38s/it]100%|##########| 2/2 [00:01<00:00,  1.08it/s]100%|##########| 2/2 [00:01<00:00,  1.01it/s]
[I 2025-05-23 20:34:48,803] Trial 2 finished with value: 242.87634724956223 and parameters: {'changepoint_prior_scale': 0.01718516530378577, 'seasonality_prior_scale': 1.378066979456046, 'n_changepoints': 11}. Best is trial 2 with value: 242.87634724956223.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:05<00:05,  5.66s/it]100%|##########| 2/2 [00:06<00:00,  2.78s/it]100%|##########| 2/2 [00:06<00:00,  3.21s/it]
[I 2025-05-23 20:34:56,446] Trial 3 finished with value: 400.88548345487897 and parameters: {'changepoint_prior_scale': 0.38379055312383475, 'seasonality_prior_scale': 7.844272021758033, 'n_changepoints': 47}. Best is trial 2 with value: 242.87634724956223.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.41s/it]100%|##########| 2/2 [00:02<00:00,  1.25s/it]100%|##########| 2/2 [00:02<00:00,  1.28s/it]
[I 2025-05-23 20:34:59,961] Trial 4 finished with value: 230.35191929417223 and parameters: {'changepoint_prior_scale': 0.004708904084286025, 'seasonality_prior_scale': 0.06535635657467281, 'n_changepoints': 10}. Best is trial 4 with value: 230.35191929417223.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.39s/it]100%|##########| 2/2 [00:01<00:00,  1.08it/s]100%|##########| 2/2 [00:01<00:00,  1.01it/s]
[I 2025-05-23 20:35:03,059] Trial 5 finished with value: 233.28068473803495 and parameters: {'changepoint_prior_scale': 0.005143103297566876, 'seasonality_prior_scale': 0.10369124093775611, 'n_changepoints': 47}. Best is trial 4 with value: 230.35191929417223.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.17s/it]100%|##########| 2/2 [00:01<00:00,  1.32it/s]100%|##########| 2/2 [00:01<00:00,  1.22it/s]
[I 2025-05-23 20:35:05,615] Trial 6 finished with value: 255.86776125952994 and parameters: {'changepoint_prior_scale': 0.00160493403198347, 'seasonality_prior_scale': 2.9316836283107075, 'n_changepoints': 6}. Best is trial 4 with value: 230.35191929417223.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.24s/it]100%|##########| 2/2 [00:01<00:00,  1.15it/s]100%|##########| 2/2 [00:01<00:00,  1.08it/s]
[I 2025-05-23 20:35:08,450] Trial 7 finished with value: 242.48415490872395 and parameters: {'changepoint_prior_scale': 0.0029352514887812505, 'seasonality_prior_scale': 0.2150681786343628, 'n_changepoints': 47}. Best is trial 4 with value: 230.35191929417223.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.60s/it]100%|##########| 2/2 [00:02<00:00,  1.07s/it]100%|##########| 2/2 [00:02<00:00,  1.15s/it]
[I 2025-05-23 20:35:11,729] Trial 8 finished with value: 263.9839168857902 and parameters: {'changepoint_prior_scale': 0.05504052652119851, 'seasonality_prior_scale': 0.3584122448770236, 'n_changepoints': 18}. Best is trial 4 with value: 230.35191929417223.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.76s/it]100%|##########| 2/2 [00:02<00:00,  1.06s/it]100%|##########| 2/2 [00:02<00:00,  1.17s/it]
[I 2025-05-23 20:35:15,417] Trial 9 finished with value: 235.84611100405303 and parameters: {'changepoint_prior_scale': 0.014488658185412721, 'seasonality_prior_scale': 0.390364977928252, 'n_changepoints': 45}. Best is trial 4 with value: 230.35191929417223.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.13s/it]100%|##########| 2/2 [00:01<00:00,  1.13it/s]100%|##########| 2/2 [00:01<00:00,  1.08it/s]
Rendimiento para la combinación BMX_310-BMX_AUTOSERVICIOS-BMX_3207:
  horizon           mse        rmse  ...     mdape     smape  coverage
0 21 days  57055.679370  238.863307  ...  0.049977  0.145848  0.833333
1 28 days  55138.837337  234.816604  ...  0.043913  0.134158  0.833333
2 35 days  76166.254655  275.982345  ...  0.117265  0.202370  0.833333
3 42 days  35109.543902  187.375409  ...  0.154153  0.145279  1.000000
4 49 days  35169.871490  187.536320  ...  0.154153  0.143326  1.000000

[5 rows x 8 columns]
          ds         yhat  yhat_lower   yhat_upper       y     cutoff
0 2022-10-24   973.136840  615.404124  1296.028195   863.0 2022-10-17
1 2022-10-31   574.460567  233.537005   919.133261   584.0 2022-10-17
2 2022-11-07   632.013318  323.023624   981.108904  1200.0 2022-10-17
3 2022-11-14   633.441803  285.298053   967.957991   591.0 2022-10-17
4 2022-11-21  1053.229739  712.545960  1420.690045   782.0 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds     y  day_of_week  week_of_year  month
0   2021-01-04   8.0            0             1      1
1   2021-01-11  12.0            0             2      1
2   2021-01-18   6.0            0             3      1
3   2021-01-25  13.0            0             4      1
4   2021-02-01  13.0            0             5      2
..         ...   ...          ...           ...    ...
151 2023-11-27  27.0            0            48     11
152 2023-12-04  30.0            0            49     12
153 2023-12-11  52.0            0            50     12
154 2023-12-18  38.0            0            51     12
155 2023-12-25  13.0            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:35:18,602] A new study created in memory with name: no-name-92e48789-18b6-455b-8b56-8755cda01c96
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.30s/it]100%|##########| 2/2 [00:02<00:00,  1.11s/it]100%|##########| 2/2 [00:02<00:00,  1.14s/it]
[I 2025-05-23 20:35:23,168] Trial 0 finished with value: 15.694650326020787 and parameters: {'changepoint_prior_scale': 0.0035486876032680055, 'seasonality_prior_scale': 0.26887540015826444, 'n_changepoints': 25}. Best is trial 0 with value: 15.694650326020787.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.90s/it]100%|##########| 2/2 [00:03<00:00,  1.72s/it]100%|##########| 2/2 [00:03<00:00,  1.90s/it]
[I 2025-05-23 20:35:28,163] Trial 1 finished with value: 17.711250587133183 and parameters: {'changepoint_prior_scale': 0.09906762817030806, 'seasonality_prior_scale': 3.1339030439973534, 'n_changepoints': 38}. Best is trial 0 with value: 15.694650326020787.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.14s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.80s/it]100%|##########| 2/2 [00:03<00:00,  1.70s/it]
[I 2025-05-23 20:35:33,520] Trial 2 finished with value: 15.663265515860456 and parameters: {'changepoint_prior_scale': 0.0016011338006314759, 'seasonality_prior_scale': 0.643464772318983, 'n_changepoints': 48}. Best is trial 2 with value: 15.663265515860456.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.70s/it]100%|##########| 2/2 [00:02<00:00,  1.04s/it]100%|##########| 2/2 [00:02<00:00,  1.14s/it]
[I 2025-05-23 20:35:37,144] Trial 3 finished with value: 15.522907499188959 and parameters: {'changepoint_prior_scale': 0.011740016701573994, 'seasonality_prior_scale': 0.4728299194444608, 'n_changepoints': 21}. Best is trial 3 with value: 15.522907499188959.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.11s/it]100%|##########| 2/2 [00:01<00:00,  1.23it/s]100%|##########| 2/2 [00:01<00:00,  1.16it/s]
[I 2025-05-23 20:35:39,801] Trial 4 finished with value: 19.68754358072381 and parameters: {'changepoint_prior_scale': 0.020722151528835765, 'seasonality_prior_scale': 9.84971211779255, 'n_changepoints': 6}. Best is trial 3 with value: 15.522907499188959.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.28it/s]100%|##########| 2/2 [00:01<00:00,  1.11it/s]100%|##########| 2/2 [00:01<00:00,  1.13it/s]
[I 2025-05-23 20:35:42,509] Trial 5 finished with value: 16.314380775639595 and parameters: {'changepoint_prior_scale': 0.0019742568121815752, 'seasonality_prior_scale': 1.522340265841679, 'n_changepoints': 8}. Best is trial 3 with value: 15.522907499188959.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.79s/it]100%|##########| 2/2 [00:02<00:00,  1.13s/it]100%|##########| 2/2 [00:02<00:00,  1.23s/it]
[I 2025-05-23 20:35:45,869] Trial 6 finished with value: 14.796090728372151 and parameters: {'changepoint_prior_scale': 0.049391026725866545, 'seasonality_prior_scale': 0.05315362489941684, 'n_changepoints': 34}. Best is trial 6 with value: 14.796090728372151.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.29s/it]100%|##########| 2/2 [00:01<00:00,  1.06it/s]100%|##########| 2/2 [00:01<00:00,  1.00it/s]
[I 2025-05-23 20:35:49,796] Trial 7 finished with value: 15.368991971534443 and parameters: {'changepoint_prior_scale': 0.0045298154324941555, 'seasonality_prior_scale': 0.10425535864021791, 'n_changepoints': 29}. Best is trial 6 with value: 14.796090728372151.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.76s/it]100%|##########| 2/2 [00:02<00:00,  1.15s/it]100%|##########| 2/2 [00:02<00:00,  1.24s/it]
[I 2025-05-23 20:35:53,563] Trial 8 finished with value: 15.50177659859222 and parameters: {'changepoint_prior_scale': 0.03664877850716933, 'seasonality_prior_scale': 0.1442287275935022, 'n_changepoints': 30}. Best is trial 6 with value: 14.796090728372151.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.96s/it]100%|##########| 2/2 [00:02<00:00,  1.28s/it]100%|##########| 2/2 [00:02<00:00,  1.38s/it]
[I 2025-05-23 20:35:57,296] Trial 9 finished with value: 15.877122904605448 and parameters: {'changepoint_prior_scale': 0.15023441351324693, 'seasonality_prior_scale': 0.8391068686455074, 'n_changepoints': 23}. Best is trial 6 with value: 14.796090728372151.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.48s/it]100%|##########| 2/2 [00:02<00:00,  1.04it/s]100%|##########| 2/2 [00:02<00:00,  1.04s/it]
Rendimiento para la combinación BMX_310-BMX_AUTOSERVICIOS-BMX_3402:
  horizon         mse       rmse  ...     mdape     smape  coverage
0 21 days  139.306870  11.802833  ...  0.426857  0.389488  0.500000
1 28 days  135.799452  11.653302  ...  0.381609  0.375500  0.500000
2 35 days  124.893340  11.175569  ...  0.222954  0.282461  0.666667
3 42 days  110.169577  10.496170  ...  0.222954  0.316177  0.833333
4 49 days  103.355280  10.166380  ...  0.197721  0.292409  0.833333

[5 rows x 8 columns]
          ds       yhat  yhat_lower  yhat_upper     y     cutoff
0 2022-10-24  17.487363    4.843848   30.837712  15.0 2022-10-17
1 2022-10-31  13.903251    1.598930   27.523821  30.0 2022-10-17
2 2022-11-07  31.545461   19.139916   44.612126  19.0 2022-10-17
3 2022-11-14  30.239174   18.441014   43.124021  33.0 2022-10-17
4 2022-11-21  26.545581   13.647289   39.400366  34.0 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds      y  day_of_week  week_of_year  month
0   2021-01-04  124.0            0             1      1
1   2021-01-11  106.0            0             2      1
2   2021-01-18  105.0            0             3      1
3   2021-01-25  215.0            0             4      1
4   2021-02-01  223.0            0             5      2
..         ...    ...          ...           ...    ...
151 2023-11-27  284.0            0            48     11
152 2023-12-04  288.0            0            49     12
153 2023-12-11  523.0            0            50     12
154 2023-12-18  735.0            0            51     12
155 2023-12-25  686.0            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:36:00,280] A new study created in memory with name: no-name-b6800d74-fdc0-4af3-aa47-aa8e089163a5
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.11s/it]100%|##########| 2/2 [00:01<00:00,  1.21it/s]100%|##########| 2/2 [00:01<00:00,  1.15it/s]
[I 2025-05-23 20:36:03,860] Trial 0 finished with value: 71.22836913214304 and parameters: {'changepoint_prior_scale': 0.007994191330563505, 'seasonality_prior_scale': 0.4610229566041926, 'n_changepoints': 33}. Best is trial 0 with value: 71.22836913214304.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.13s/it]100%|##########| 2/2 [00:02<00:00,  1.28s/it]100%|##########| 2/2 [00:02<00:00,  1.41s/it]
[I 2025-05-23 20:36:08,838] Trial 1 finished with value: 72.86663914852423 and parameters: {'changepoint_prior_scale': 0.004166339297065767, 'seasonality_prior_scale': 1.460398203517906, 'n_changepoints': 49}. Best is trial 0 with value: 71.22836913214304.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.71s/it]100%|##########| 2/2 [00:02<00:00,  1.17s/it]100%|##########| 2/2 [00:02<00:00,  1.25s/it]
[I 2025-05-23 20:36:12,353] Trial 2 finished with value: 67.28834276842386 and parameters: {'changepoint_prior_scale': 0.24437317581291076, 'seasonality_prior_scale': 0.014936361930278365, 'n_changepoints': 33}. Best is trial 2 with value: 67.28834276842386.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.10it/s]100%|##########| 2/2 [00:01<00:00,  1.38it/s]100%|##########| 2/2 [00:01<00:00,  1.33it/s]
[I 2025-05-23 20:36:14,666] Trial 3 finished with value: 68.33153181716983 and parameters: {'changepoint_prior_scale': 0.009301842863292229, 'seasonality_prior_scale': 0.015890262245777016, 'n_changepoints': 11}. Best is trial 2 with value: 67.28834276842386.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.53s/it]100%|##########| 2/2 [00:02<00:00,  1.01it/s]100%|##########| 2/2 [00:02<00:00,  1.07s/it]
[I 2025-05-23 20:36:17,743] Trial 4 finished with value: 71.5910003836342 and parameters: {'changepoint_prior_scale': 0.1025075225311602, 'seasonality_prior_scale': 1.2147910410919305, 'n_changepoints': 46}. Best is trial 2 with value: 67.28834276842386.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.01it/s]100%|##########| 2/2 [00:01<00:00,  1.17it/s]100%|##########| 2/2 [00:01<00:00,  1.14it/s]
[I 2025-05-23 20:36:21,318] Trial 5 finished with value: 68.97210851128729 and parameters: {'changepoint_prior_scale': 0.013279826826900645, 'seasonality_prior_scale': 0.2324754687499364, 'n_changepoints': 48}. Best is trial 2 with value: 67.28834276842386.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.12s/it]100%|##########| 2/2 [00:01<00:00,  1.22it/s]100%|##########| 2/2 [00:01<00:00,  1.15it/s]
[I 2025-05-23 20:36:23,908] Trial 6 finished with value: 66.71703361968764 and parameters: {'changepoint_prior_scale': 0.014614710027408738, 'seasonality_prior_scale': 0.025067772277699837, 'n_changepoints': 30}. Best is trial 6 with value: 66.71703361968764.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.56s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.38s/it]100%|##########| 2/2 [00:02<00:00,  1.40s/it]
[I 2025-05-23 20:36:35,841] Trial 7 finished with value: 70.48316620650533 and parameters: {'changepoint_prior_scale': 0.001506392737032957, 'seasonality_prior_scale': 0.7143251846363681, 'n_changepoints': 30}. Best is trial 6 with value: 66.71703361968764.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.11s/it]100%|##########| 2/2 [00:01<00:00,  1.21it/s]100%|##########| 2/2 [00:01<00:00,  1.15it/s]
[I 2025-05-23 20:36:38,447] Trial 8 finished with value: 67.11224842747718 and parameters: {'changepoint_prior_scale': 0.09307262065408263, 'seasonality_prior_scale': 0.019396882184755885, 'n_changepoints': 25}. Best is trial 6 with value: 66.71703361968764.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.00it/s]100%|##########| 2/2 [00:01<00:00,  1.30it/s]100%|##########| 2/2 [00:01<00:00,  1.24it/s]
[I 2025-05-23 20:36:40,853] Trial 9 finished with value: 68.27449456445086 and parameters: {'changepoint_prior_scale': 0.01809136318629288, 'seasonality_prior_scale': 0.06300441326475566, 'n_changepoints': 33}. Best is trial 6 with value: 66.71703361968764.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.23s/it]100%|##########| 2/2 [00:01<00:00,  1.25it/s]100%|##########| 2/2 [00:01<00:00,  1.16it/s]
Rendimiento para la combinación BMX_310-BMX_AUTOSERVICIOS-BMX_3931:
  horizon          mse       rmse  ...     mdape     smape  coverage
0 21 days  6016.754955  77.567744  ...  0.241647  0.230924  0.500000
1 28 days  4479.806670  66.931358  ...  0.189193  0.197429  0.666667
2 35 days  3193.715993  56.512972  ...  0.161693  0.159146  0.833333
3 42 days  1821.959089  42.684413  ...  0.139819  0.122696  1.000000
4 49 days  5798.527645  76.148064  ...  0.139819  0.194267  0.666667

[5 rows x 8 columns]
          ds        yhat  yhat_lower  yhat_upper      y     cutoff
0 2022-10-24  291.085752  206.476227  371.985503  163.0 2022-10-17
1 2022-10-31  352.148729  265.533587  429.620466  259.0 2022-10-17
2 2022-11-07  291.592265  205.810078  373.521432  274.0 2022-10-17
3 2022-11-14  255.235142  167.085352  342.782067  305.0 2022-10-17
4 2022-11-21  225.900075  137.213844  303.230582  269.0 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds        y  day_of_week  week_of_year  month
0   2021-01-04  244.750            0             1      1
1   2021-01-11  235.625            0             2      1
2   2021-01-18  262.000            0             3      1
3   2021-01-25  243.000            0             4      1
4   2021-02-01  230.500            0             5      2
..         ...      ...          ...           ...    ...
151 2023-11-27  309.500            0            48     11
152 2023-12-04  335.750            0            49     12
153 2023-12-11  414.875            0            50     12
154 2023-12-18  359.000            0            51     12
155 2023-12-25  239.750            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:36:43,497] A new study created in memory with name: no-name-4ccf4251-0c9f-42e6-aeb6-f848b74a54cb
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.13s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.12s/it]100%|##########| 2/2 [00:02<00:00,  1.12s/it]
[I 2025-05-23 20:36:46,607] Trial 0 finished with value: 161.73639925593028 and parameters: {'changepoint_prior_scale': 0.3367938210029772, 'seasonality_prior_scale': 0.296630496383863, 'n_changepoints': 6}. Best is trial 0 with value: 161.73639925593028.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.31s/it]100%|##########| 2/2 [00:03<00:00,  1.42s/it]100%|##########| 2/2 [00:03<00:00,  1.55s/it]
[I 2025-05-23 20:36:50,764] Trial 1 finished with value: 211.45372552746863 and parameters: {'changepoint_prior_scale': 0.37190553682453836, 'seasonality_prior_scale': 3.2426876403213285, 'n_changepoints': 36}. Best is trial 0 with value: 161.73639925593028.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.31s/it]100%|##########| 2/2 [00:01<00:00,  1.14it/s]100%|##########| 2/2 [00:01<00:00,  1.06it/s]
[I 2025-05-23 20:36:53,508] Trial 2 finished with value: 91.6928319303374 and parameters: {'changepoint_prior_scale': 0.007957911970717933, 'seasonality_prior_scale': 0.038206479333440485, 'n_changepoints': 23}. Best is trial 2 with value: 91.6928319303374.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.31s/it]100%|##########| 2/2 [00:02<00:00,  1.00s/it]100%|##########| 2/2 [00:02<00:00,  1.05s/it]
[I 2025-05-23 20:36:56,371] Trial 3 finished with value: 169.902669974586 and parameters: {'changepoint_prior_scale': 0.23506077672667958, 'seasonality_prior_scale': 1.0761101880622381, 'n_changepoints': 10}. Best is trial 2 with value: 91.6928319303374.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.22it/s]100%|##########| 2/2 [00:01<00:00,  1.32it/s]100%|##########| 2/2 [00:01<00:00,  1.30it/s]
[I 2025-05-23 20:36:58,778] Trial 4 finished with value: 153.12636350234388 and parameters: {'changepoint_prior_scale': 0.0012554245495045393, 'seasonality_prior_scale': 1.2739887409947919, 'n_changepoints': 6}. Best is trial 2 with value: 91.6928319303374.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.69s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.61s/it]100%|##########| 2/2 [00:03<00:00,  1.62s/it]
[I 2025-05-23 20:37:04,726] Trial 5 finished with value: 83.0613466293274 and parameters: {'changepoint_prior_scale': 0.001540571765039111, 'seasonality_prior_scale': 0.013152935857476566, 'n_changepoints': 19}. Best is trial 5 with value: 83.0613466293274.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.83s/it]100%|##########| 2/2 [00:03<00:00,  1.66s/it]100%|##########| 2/2 [00:03<00:00,  1.84s/it]
[I 2025-05-23 20:37:09,419] Trial 6 finished with value: 97.45938950134207 and parameters: {'changepoint_prior_scale': 0.07496170349266705, 'seasonality_prior_scale': 1.31474690447747, 'n_changepoints': 39}. Best is trial 5 with value: 83.0613466293274.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.55s/it]100%|##########| 2/2 [00:02<00:00,  1.03it/s]100%|##########| 2/2 [00:02<00:00,  1.06s/it]
[I 2025-05-23 20:37:12,392] Trial 7 finished with value: 82.0590284865583 and parameters: {'changepoint_prior_scale': 0.024418437163498948, 'seasonality_prior_scale': 0.013491599718821285, 'n_changepoints': 39}. Best is trial 7 with value: 82.0590284865583.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.17s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.52s/it]100%|##########| 2/2 [00:02<00:00,  1.47s/it]
[I 2025-05-23 20:37:17,178] Trial 8 finished with value: 82.54875307802985 and parameters: {'changepoint_prior_scale': 0.001929005253576592, 'seasonality_prior_scale': 0.012117502414289985, 'n_changepoints': 44}. Best is trial 7 with value: 82.0590284865583.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.62s/it]100%|##########| 2/2 [00:02<00:00,  1.04s/it]100%|##########| 2/2 [00:02<00:00,  1.13s/it]
[I 2025-05-23 20:37:20,493] Trial 9 finished with value: 141.67716552194722 and parameters: {'changepoint_prior_scale': 0.20136002893547245, 'seasonality_prior_scale': 0.8794990570801433, 'n_changepoints': 21}. Best is trial 7 with value: 82.0590284865583.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.38s/it]100%|##########| 2/2 [00:02<00:00,  1.05it/s]100%|##########| 2/2 [00:02<00:00,  1.02s/it]
Rendimiento para la combinación BMX_310-BMX_HOGAR-BMX_3001:
  horizon          mse       rmse  ...     mdape     smape  coverage
0 21 days  3809.296857  61.719501  ...  0.137284  0.166759  0.666667
1 28 days  4146.589245  64.394016  ...  0.146151  0.182813  0.666667
2 35 days  6673.655884  81.692447  ...  0.146151  0.186801  0.666667
3 42 days  7490.068346  86.545181  ...  0.146151  0.201737  0.666667
4 49 days  6948.273707  83.356306  ...  0.083943  0.170101  0.666667

[5 rows x 8 columns]
          ds        yhat  yhat_lower  yhat_upper        y     cutoff
0 2022-10-24  311.471217  235.300605  390.808635  265.875 2022-10-17
1 2022-10-31  312.941189  230.193462  393.275998  198.875 2022-10-17
2 2022-11-07  343.601664  270.410174  427.050031  266.000 2022-10-17
3 2022-11-14  334.228724  258.201086  416.518177  282.125 2022-10-17
4 2022-11-21  328.777598  249.393512  405.150927  493.125 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds     y  day_of_week  week_of_year  month
0   2021-01-04  27.0            0             1      1
1   2021-01-11  10.0            0             2      1
2   2021-01-18  12.0            0             3      1
3   2021-01-25  14.0            0             4      1
4   2021-02-01  10.0            0             5      2
..         ...   ...          ...           ...    ...
151 2023-11-27  98.0            0            48     11
152 2023-12-04  85.0            0            49     12
153 2023-12-11  50.0            0            50     12
154 2023-12-18  89.0            0            51     12
155 2023-12-25  34.0            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:37:23,478] A new study created in memory with name: no-name-84749ff2-3289-49e8-9683-b7ffdb332482
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.23it/s]100%|##########| 2/2 [00:01<00:00,  1.32it/s]100%|##########| 2/2 [00:01<00:00,  1.31it/s]
[I 2025-05-23 20:37:25,919] Trial 0 finished with value: 29.740498953616036 and parameters: {'changepoint_prior_scale': 0.005651942796044338, 'seasonality_prior_scale': 3.214920317402853, 'n_changepoints': 5}. Best is trial 0 with value: 29.740498953616036.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.27s/it]100%|##########| 2/2 [00:02<00:00,  1.02s/it]100%|##########| 2/2 [00:02<00:00,  1.05s/it]
[I 2025-05-23 20:37:28,979] Trial 1 finished with value: 31.36204177044622 and parameters: {'changepoint_prior_scale': 0.1664155025528131, 'seasonality_prior_scale': 3.720192973935479, 'n_changepoints': 33}. Best is trial 0 with value: 29.740498953616036.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.69s/it]100%|##########| 2/2 [00:02<00:00,  1.05s/it]100%|##########| 2/2 [00:02<00:00,  1.15s/it]
[I 2025-05-23 20:37:32,075] Trial 2 finished with value: 25.169315146055578 and parameters: {'changepoint_prior_scale': 0.05056558712443667, 'seasonality_prior_scale': 0.04151967875833309, 'n_changepoints': 31}. Best is trial 2 with value: 25.169315146055578.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.01it/s]100%|##########| 2/2 [00:01<00:00,  1.31it/s]100%|##########| 2/2 [00:01<00:00,  1.25it/s]
[I 2025-05-23 20:37:34,481] Trial 3 finished with value: 42.958504487209204 and parameters: {'changepoint_prior_scale': 0.0010911784553568904, 'seasonality_prior_scale': 3.620308805845493, 'n_changepoints': 9}. Best is trial 2 with value: 25.169315146055578.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.34s/it]100%|##########| 2/2 [00:02<00:00,  1.03it/s]100%|##########| 2/2 [00:02<00:00,  1.02s/it]
[I 2025-05-23 20:37:37,380] Trial 4 finished with value: 33.37104378113036 and parameters: {'changepoint_prior_scale': 0.1678070922464177, 'seasonality_prior_scale': 8.228893522465473, 'n_changepoints': 17}. Best is trial 2 with value: 25.169315146055578.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.06s/it]100%|##########| 2/2 [00:01<00:00,  1.18it/s]100%|##########| 2/2 [00:01<00:00,  1.13it/s]
[I 2025-05-23 20:37:40,020] Trial 5 finished with value: 30.140450500207944 and parameters: {'changepoint_prior_scale': 0.09555401517808124, 'seasonality_prior_scale': 0.9279952770146933, 'n_changepoints': 8}. Best is trial 2 with value: 25.169315146055578.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.78s/it]100%|##########| 2/2 [00:02<00:00,  1.13s/it]100%|##########| 2/2 [00:02<00:00,  1.23s/it]
[I 2025-05-23 20:37:43,494] Trial 6 finished with value: 25.291420822605506 and parameters: {'changepoint_prior_scale': 0.4153494495811188, 'seasonality_prior_scale': 0.1039794099889997, 'n_changepoints': 43}. Best is trial 2 with value: 25.169315146055578.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.01s/it]100%|##########| 2/2 [00:01<00:00,  1.35it/s]100%|##########| 2/2 [00:01<00:00,  1.28it/s]
[I 2025-05-23 20:37:46,003] Trial 7 finished with value: 28.62946972260855 and parameters: {'changepoint_prior_scale': 0.01964491650159885, 'seasonality_prior_scale': 1.4923451457110104, 'n_changepoints': 18}. Best is trial 2 with value: 25.169315146055578.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.12s/it]100%|##########| 2/2 [00:01<00:00,  1.31it/s]100%|##########| 2/2 [00:01<00:00,  1.23it/s]
[I 2025-05-23 20:37:48,608] Trial 8 finished with value: 28.10120003134222 and parameters: {'changepoint_prior_scale': 0.0038368658991842185, 'seasonality_prior_scale': 0.8334128721900532, 'n_changepoints': 29}. Best is trial 2 with value: 25.169315146055578.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.23s/it]100%|##########| 2/2 [00:01<00:00,  1.08it/s]100%|##########| 2/2 [00:01<00:00,  1.03it/s]
[I 2025-05-23 20:37:51,468] Trial 9 finished with value: 25.359616125636677 and parameters: {'changepoint_prior_scale': 0.021148672272465308, 'seasonality_prior_scale': 0.07425483876806777, 'n_changepoints': 45}. Best is trial 2 with value: 25.169315146055578.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.63s/it]100%|##########| 2/2 [00:02<00:00,  1.09s/it]100%|##########| 2/2 [00:02<00:00,  1.17s/it]
Rendimiento para la combinación BMX_310-BMX_HOGAR-BMX_3207:
  horizon         mse       rmse  ...     mdape     smape  coverage
0 21 days  201.389880  14.191190  ...  0.334054  0.462350       1.0
1 28 days  229.476897  15.148495  ...  0.334054  0.408240       1.0
2 35 days  214.142587  14.633612  ...  0.430205  0.671343       1.0
3 42 days  126.384606  11.242091  ...  0.309690  0.584504       1.0
4 49 days  109.241265  10.451855  ...  0.309690  0.659118       1.0

[5 rows x 8 columns]
          ds       yhat  yhat_lower  yhat_upper     y     cutoff
0 2022-10-24   9.435269  -16.545570   35.519609  13.0 2022-10-17
1 2022-10-31  27.982619   -2.448007   52.982629  39.0 2022-10-17
2 2022-11-07  37.556555    9.687407   66.344055  54.0 2022-10-17
3 2022-11-14  30.769663    2.894256   60.502978  25.0 2022-10-17
4 2022-11-21  -1.295464  -29.952393   26.632028   2.0 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds        y  day_of_week  week_of_year  month
0   2021-01-04   42.500            0             1      1
1   2021-01-11   44.375            0             2      1
2   2021-01-18   40.750            0             3      1
3   2021-01-25   39.500            0             4      1
4   2021-02-01   50.500            0             5      2
..         ...      ...          ...           ...    ...
151 2023-11-27  148.000            0            48     11
152 2023-12-04  172.000            0            49     12
153 2023-12-11  193.000            0            50     12
154 2023-12-18  278.375            0            51     12
155 2023-12-25  208.000            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:37:54,697] A new study created in memory with name: no-name-3f81c6a6-d2bb-4378-bcc3-2c568748f979
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.01s/it]100%|##########| 2/2 [00:01<00:00,  1.36it/s]100%|##########| 2/2 [00:01<00:00,  1.29it/s]
[I 2025-05-23 20:37:57,182] Trial 0 finished with value: 109.85542085426063 and parameters: {'changepoint_prior_scale': 0.015932193066244417, 'seasonality_prior_scale': 2.8915996320840516, 'n_changepoints': 6}. Best is trial 0 with value: 109.85542085426063.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.34s/it]100%|##########| 2/2 [00:02<00:00,  1.08s/it]100%|##########| 2/2 [00:02<00:00,  1.12s/it]
[I 2025-05-23 20:38:00,223] Trial 1 finished with value: 108.51575801527316 and parameters: {'changepoint_prior_scale': 0.011364715855330682, 'seasonality_prior_scale': 0.6006871243618154, 'n_changepoints': 44}. Best is trial 1 with value: 108.51575801527316.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.19s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.32s/it]100%|##########| 2/2 [00:02<00:00,  1.30s/it]
[I 2025-05-23 20:38:04,465] Trial 2 finished with value: 98.75484137535891 and parameters: {'changepoint_prior_scale': 0.001032604841524153, 'seasonality_prior_scale': 0.047487967567290276, 'n_changepoints': 29}. Best is trial 2 with value: 98.75484137535891.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.03s/it]100%|##########| 2/2 [00:01<00:00,  1.14it/s]100%|##########| 2/2 [00:01<00:00,  1.11it/s]
[I 2025-05-23 20:38:07,284] Trial 3 finished with value: 117.3781256386791 and parameters: {'changepoint_prior_scale': 0.00473190034327061, 'seasonality_prior_scale': 7.430503406114456, 'n_changepoints': 12}. Best is trial 2 with value: 98.75484137535891.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.31s/it]100%|##########| 2/2 [00:01<00:00,  1.08it/s]100%|##########| 2/2 [00:01<00:00,  1.01it/s]
[I 2025-05-23 20:38:10,521] Trial 4 finished with value: 116.51683286960267 and parameters: {'changepoint_prior_scale': 0.005651754302012172, 'seasonality_prior_scale': 5.196810757457659, 'n_changepoints': 14}. Best is trial 2 with value: 98.75484137535891.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.26s/it]100%|##########| 2/2 [00:01<00:00,  1.10it/s]100%|##########| 2/2 [00:01<00:00,  1.04it/s]
[I 2025-05-23 20:38:13,553] Trial 5 finished with value: 131.619677597194 and parameters: {'changepoint_prior_scale': 0.0013737964809109517, 'seasonality_prior_scale': 0.4238642430450702, 'n_changepoints': 15}. Best is trial 2 with value: 98.75484137535891.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.61s/it]100%|##########| 2/2 [00:03<00:00,  1.40s/it]100%|##########| 2/2 [00:03<00:00,  1.58s/it]
[I 2025-05-23 20:38:17,999] Trial 6 finished with value: 105.73560780959973 and parameters: {'changepoint_prior_scale': 0.05869249282274909, 'seasonality_prior_scale': 1.3210677195143536, 'n_changepoints': 39}. Best is trial 2 with value: 98.75484137535891.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.57s/it]100%|##########| 2/2 [00:03<00:00,  1.47s/it]100%|##########| 2/2 [00:03<00:00,  1.63s/it]
[I 2025-05-23 20:38:22,351] Trial 7 finished with value: 81.72095225503382 and parameters: {'changepoint_prior_scale': 0.2118339397230442, 'seasonality_prior_scale': 0.06632986359030854, 'n_changepoints': 19}. Best is trial 7 with value: 81.72095225503382.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.44s/it]100%|##########| 2/2 [00:02<00:00,  1.10s/it]100%|##########| 2/2 [00:02<00:00,  1.15s/it]
[I 2025-05-23 20:38:25,767] Trial 8 finished with value: 103.54949982584472 and parameters: {'changepoint_prior_scale': 0.03315992152434906, 'seasonality_prior_scale': 0.23358718486436125, 'n_changepoints': 16}. Best is trial 7 with value: 81.72095225503382.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.47s/it]100%|##########| 2/2 [00:02<00:00,  1.02it/s]100%|##########| 2/2 [00:02<00:00,  1.06s/it]
[I 2025-05-23 20:38:28,993] Trial 9 finished with value: 83.25848092409655 and parameters: {'changepoint_prior_scale': 0.016119857679733906, 'seasonality_prior_scale': 0.016077749182694084, 'n_changepoints': 38}. Best is trial 7 with value: 81.72095225503382.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.30s/it]100%|##########| 2/2 [00:03<00:00,  1.38s/it]100%|##########| 2/2 [00:03<00:00,  1.52s/it]
Rendimiento para la combinación BMX_310-BMX_HOGAR-BMX_3931:
  horizon           mse        rmse  ...     mdape     smape  coverage
0 21 days   4868.328374   69.773407  ...  0.530320  0.498096  0.333333
1 28 days   2660.537066   51.580394  ...  0.324157  0.402029  0.666667
2 35 days   1999.485910   44.715611  ...  0.422353  0.362696  0.500000
3 42 days   4009.668704   63.321945  ...  0.614836  0.477865  0.333333
4 49 days  17262.658246  131.387436  ...  0.944519  0.686706  0.000000

[5 rows x 8 columns]
          ds        yhat  yhat_lower  yhat_upper        y     cutoff
0 2022-10-24  195.694767  154.766720  239.532190   97.375 2022-10-17
1 2022-10-31  173.721900  132.361137  217.379823   72.625 2022-10-17
2 2022-11-07  127.043000   84.220004  170.552430   78.375 2022-10-17
3 2022-11-14   70.821496   29.483553  110.800120  105.750 2022-10-17
4 2022-11-21  146.897989  106.588596  188.261440   97.000 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds      y  day_of_week  week_of_year  month
0   2021-01-04  152.0            0             1      1
1   2021-01-11   89.0            0             2      1
2   2021-01-18  126.5            0             3      1
3   2021-01-25  184.0            0             4      1
4   2021-02-01  101.0            0             5      2
..         ...    ...          ...           ...    ...
151 2023-11-27  169.0            0            48     11
152 2023-12-04  169.0            0            49     12
153 2023-12-11  198.0            0            50     12
154 2023-12-18  205.0            0            51     12
155 2023-12-25  156.0            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:38:33,090] A new study created in memory with name: no-name-51cdef47-8fb5-4b51-a77c-c66468e1eb0d
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.72s/it]100%|##########| 2/2 [00:03<00:00,  1.57s/it]100%|##########| 2/2 [00:03<00:00,  1.74s/it]
[I 2025-05-23 20:38:37,970] Trial 0 finished with value: 167.60258348163373 and parameters: {'changepoint_prior_scale': 0.08476961939963228, 'seasonality_prior_scale': 6.04414177701654, 'n_changepoints': 45}. Best is trial 0 with value: 167.60258348163373.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.71s/it]100%|##########| 2/2 [00:02<00:00,  1.06s/it]100%|##########| 2/2 [00:02<00:00,  1.16s/it]
[I 2025-05-23 20:38:41,589] Trial 1 finished with value: 104.81776721868795 and parameters: {'changepoint_prior_scale': 0.1958184385365838, 'seasonality_prior_scale': 0.024993295696367067, 'n_changepoints': 24}. Best is trial 1 with value: 104.81776721868795.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:04<00:04,  4.05s/it]100%|##########| 2/2 [00:04<00:00,  2.14s/it]100%|##########| 2/2 [00:04<00:00,  2.43s/it]
[I 2025-05-23 20:38:47,576] Trial 2 finished with value: 146.6555674914336 and parameters: {'changepoint_prior_scale': 0.22018129777408513, 'seasonality_prior_scale': 0.11207255484525733, 'n_changepoints': 46}. Best is trial 1 with value: 104.81776721868795.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.20s/it]100%|##########| 2/2 [00:01<00:00,  1.08it/s]100%|##########| 2/2 [00:01<00:00,  1.03it/s]
[I 2025-05-23 20:38:50,734] Trial 3 finished with value: 126.4882886783614 and parameters: {'changepoint_prior_scale': 0.01288885558654901, 'seasonality_prior_scale': 0.020277124864832005, 'n_changepoints': 46}. Best is trial 1 with value: 104.81776721868795.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.28s/it]100%|##########| 2/2 [00:02<00:00,  1.02it/s]100%|##########| 2/2 [00:02<00:00,  1.03s/it]
[I 2025-05-23 20:38:53,686] Trial 4 finished with value: 111.34945922993731 and parameters: {'changepoint_prior_scale': 0.006666548537421226, 'seasonality_prior_scale': 0.010937592666563656, 'n_changepoints': 23}. Best is trial 1 with value: 104.81776721868795.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.93s/it]100%|##########| 2/2 [00:02<00:00,  1.18s/it]100%|##########| 2/2 [00:02<00:00,  1.29s/it]
[I 2025-05-23 20:38:57,285] Trial 5 finished with value: 200.5445737549063 and parameters: {'changepoint_prior_scale': 0.2536860059345858, 'seasonality_prior_scale': 6.575702308291427, 'n_changepoints': 25}. Best is trial 1 with value: 104.81776721868795.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.43s/it]100%|##########| 2/2 [00:02<00:00,  1.05s/it]100%|##########| 2/2 [00:02<00:00,  1.11s/it]
[I 2025-05-23 20:39:00,563] Trial 6 finished with value: 159.1489129755298 and parameters: {'changepoint_prior_scale': 0.013275993158876391, 'seasonality_prior_scale': 2.361289799476952, 'n_changepoints': 39}. Best is trial 1 with value: 104.81776721868795.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.69s/it]100%|##########| 2/2 [00:02<00:00,  1.02s/it]100%|##########| 2/2 [00:02<00:00,  1.12s/it]
[I 2025-05-23 20:39:03,687] Trial 7 finished with value: 154.10056257717932 and parameters: {'changepoint_prior_scale': 0.05871173542914405, 'seasonality_prior_scale': 2.0770279788765897, 'n_changepoints': 48}. Best is trial 1 with value: 104.81776721868795.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.11s/it]100%|##########| 2/2 [00:01<00:00,  1.07it/s]100%|##########| 2/2 [00:01<00:00,  1.04it/s]
[I 2025-05-23 20:39:06,452] Trial 8 finished with value: 146.6264587912914 and parameters: {'changepoint_prior_scale': 0.01772501212245711, 'seasonality_prior_scale': 0.2425580379210892, 'n_changepoints': 21}. Best is trial 1 with value: 104.81776721868795.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.11it/s]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.11s/it]100%|##########| 2/2 [00:02<00:00,  1.08s/it]
[I 2025-05-23 20:39:09,572] Trial 9 finished with value: 125.52344639361714 and parameters: {'changepoint_prior_scale': 0.001409050932089669, 'seasonality_prior_scale': 0.017633340363274744, 'n_changepoints': 15}. Best is trial 1 with value: 104.81776721868795.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.68s/it]100%|##########| 2/2 [00:02<00:00,  1.12s/it]100%|##########| 2/2 [00:02<00:00,  1.20s/it]
Rendimiento para la combinación BMX_310-BMX_HOGAR-BMX_3203:
  horizon           mse        rmse  ...     mdape     smape  coverage
0 21 days  32420.975391  180.058256  ...  0.721522  0.662392  0.666667
1 28 days  17470.197011  132.174873  ...  0.330885  0.472819  0.833333
2 35 days   4199.464599   64.803276  ...  0.269411  0.308300  1.000000
3 42 days   4130.702033   64.270538  ...  0.232061  0.289040  0.833333
4 49 days  17379.645400  131.831883  ...  0.719808  0.493097  0.500000

[5 rows x 8 columns]
          ds        yhat  yhat_lower  yhat_upper       y     cutoff
0 2022-10-24  407.286738  282.802782  527.926647  108.00 2022-10-17
1 2022-10-31  381.891910  258.863442  503.798503   90.75 2022-10-17
2 2022-11-07  236.946709  114.220749  361.872781  114.75 2022-10-17
3 2022-11-14  153.822040   21.558910  268.428932  125.00 2022-10-17
4 2022-11-21  220.591632  101.849476  340.256213  169.00 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds         y  day_of_week  week_of_year  month
0   2021-01-04  1610.000            0             1      1
1   2021-01-11  1422.000            0             2      1
2   2021-01-18  1578.000            0             3      1
3   2021-01-25  2097.000            0             4      1
4   2021-02-01  2297.000            0             5      2
..         ...       ...          ...           ...    ...
151 2023-11-27  2987.625            0            48     11
152 2023-12-04  4058.250            0            49     12
153 2023-12-11  4253.375            0            50     12
154 2023-12-18  5403.750            0            51     12
155 2023-12-25  4671.875            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:39:13,245] A new study created in memory with name: no-name-98afd73d-f565-4afa-92d5-dc2a39c4ec27
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.11s/it]100%|##########| 2/2 [00:01<00:00,  1.18it/s]100%|##########| 2/2 [00:01<00:00,  1.12it/s]
[I 2025-05-23 20:39:16,004] Trial 0 finished with value: 1214.2766057574559 and parameters: {'changepoint_prior_scale': 0.01668781364316738, 'seasonality_prior_scale': 0.4792584494190549, 'n_changepoints': 21}. Best is trial 0 with value: 1214.2766057574559.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.75s/it]100%|##########| 2/2 [00:02<00:00,  1.16s/it]100%|##########| 2/2 [00:02<00:00,  1.25s/it]
[I 2025-05-23 20:39:19,413] Trial 1 finished with value: 1443.0887926415699 and parameters: {'changepoint_prior_scale': 0.04367613336460401, 'seasonality_prior_scale': 0.021797315566778355, 'n_changepoints': 30}. Best is trial 0 with value: 1214.2766057574559.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.11s/it]100%|##########| 2/2 [00:01<00:00,  1.06it/s]100%|##########| 2/2 [00:01<00:00,  1.04it/s]
[I 2025-05-23 20:39:22,377] Trial 2 finished with value: 1782.637689330862 and parameters: {'changepoint_prior_scale': 0.002329865476958597, 'seasonality_prior_scale': 0.06686146192714969, 'n_changepoints': 15}. Best is trial 0 with value: 1214.2766057574559.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.33s/it]100%|##########| 2/2 [00:02<00:00,  1.09s/it]100%|##########| 2/2 [00:02<00:00,  1.13s/it]
[I 2025-05-23 20:39:25,758] Trial 3 finished with value: 1544.248849466293 and parameters: {'changepoint_prior_scale': 0.14400081601288117, 'seasonality_prior_scale': 3.902583237639797, 'n_changepoints': 23}. Best is trial 0 with value: 1214.2766057574559.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.70s/it]100%|##########| 2/2 [00:02<00:00,  1.13s/it]100%|##########| 2/2 [00:02<00:00,  1.22s/it]
[I 2025-05-23 20:39:29,190] Trial 4 finished with value: 1495.7107324726826 and parameters: {'changepoint_prior_scale': 0.12118529610906006, 'seasonality_prior_scale': 0.10389556131941897, 'n_changepoints': 34}. Best is trial 0 with value: 1214.2766057574559.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.07s/it]100%|##########| 2/2 [00:02<00:00,  1.29s/it]100%|##########| 2/2 [00:02<00:00,  1.41s/it]
[I 2025-05-23 20:39:32,934] Trial 5 finished with value: 1399.1259908921243 and parameters: {'changepoint_prior_scale': 0.2802169591344788, 'seasonality_prior_scale': 9.249502723251581, 'n_changepoints': 34}. Best is trial 0 with value: 1214.2766057574559.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.71s/it]100%|##########| 2/2 [00:02<00:00,  1.13s/it]100%|##########| 2/2 [00:02<00:00,  1.22s/it]
[I 2025-05-23 20:39:36,491] Trial 6 finished with value: 1541.1978669799742 and parameters: {'changepoint_prior_scale': 0.11084791342776987, 'seasonality_prior_scale': 5.762511189249762, 'n_changepoints': 38}. Best is trial 0 with value: 1214.2766057574559.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:13<00:13, 13.34s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:15<00:00,  6.79s/it]100%|##########| 2/2 [00:15<00:00,  7.77s/it]
[I 2025-05-23 20:39:53,842] Trial 7 finished with value: 1462.1776686295782 and parameters: {'changepoint_prior_scale': 0.0011452449634563628, 'seasonality_prior_scale': 0.01361689574628005, 'n_changepoints': 39}. Best is trial 0 with value: 1214.2766057574559.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.11it/s]100%|##########| 2/2 [00:01<00:00,  1.27it/s]100%|##########| 2/2 [00:01<00:00,  1.24it/s]
[I 2025-05-23 20:39:56,324] Trial 8 finished with value: 1233.0244751045188 and parameters: {'changepoint_prior_scale': 0.005457464570931488, 'seasonality_prior_scale': 5.2636590201047815, 'n_changepoints': 12}. Best is trial 0 with value: 1214.2766057574559.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.17s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.93s/it]100%|##########| 2/2 [00:03<00:00,  1.97s/it]
[I 2025-05-23 20:40:02,550] Trial 9 finished with value: 1306.4162036374248 and parameters: {'changepoint_prior_scale': 0.0012902041676204185, 'seasonality_prior_scale': 8.267237564673762, 'n_changepoints': 46}. Best is trial 0 with value: 1214.2766057574559.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.04it/s]100%|##########| 2/2 [00:01<00:00,  1.19it/s]100%|##########| 2/2 [00:01<00:00,  1.17it/s]
Rendimiento para la combinación BMX_310-BMX_OXXO-BMX_3001:
  horizon           mse         rmse  ...     mdape     smape  coverage
0 21 days  5.123707e+05   715.800723  ...  0.174171  0.175281  0.500000
1 28 days  4.683415e+05   684.354779  ...  0.186527  0.167520  0.666667
2 35 days  4.557397e+05   675.084929  ...  0.170684  0.168703  0.666667
3 42 days  5.117024e+05   715.333803  ...  0.170684  0.183589  0.666667
4 49 days  1.325600e+06  1151.347154  ...  0.255780  0.255105  0.333333

[5 rows x 8 columns]
          ds         yhat   yhat_lower   yhat_upper         y     cutoff
0 2022-10-24  4469.960058  3750.261317  5214.894499  4013.625 2022-10-17
1 2022-10-31  3700.246034  2978.551532  4433.192144  2567.625 2022-10-17
2 2022-11-07  3884.147455  3151.405250  4634.012951  3117.250 2022-10-17
3 2022-11-14  3742.666087  3024.679841  4512.203714  3025.750 2022-10-17
4 2022-11-21  3469.543790  2800.947884  4181.367095  2321.000 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds         y  day_of_week  week_of_year  month
0   2021-01-04  2099.750            0             1      1
1   2021-01-11  2173.000            0             2      1
2   2021-01-18  2176.625            0             3      1
3   2021-01-25  2655.875            0             4      1
4   2021-02-01  2229.000            0             5      2
..         ...       ...          ...           ...    ...
151 2023-11-27  2015.250            0            48     11
152 2023-12-04  2638.625            0            49     12
153 2023-12-11  3128.000            0            50     12
154 2023-12-18  3463.750            0            51     12
155 2023-12-25  2836.000            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:40:06,191] A new study created in memory with name: no-name-e381638a-cb57-47cb-9bdf-21ac932eef59
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.53s/it]100%|##########| 2/2 [00:02<00:00,  1.03s/it]100%|##########| 2/2 [00:02<00:00,  1.10s/it]
[I 2025-05-23 20:40:11,507] Trial 0 finished with value: 1717.0805872884748 and parameters: {'changepoint_prior_scale': 0.001521242903422615, 'seasonality_prior_scale': 3.5922761804297076, 'n_changepoints': 29}. Best is trial 0 with value: 1717.0805872884748.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.92s/it]100%|##########| 2/2 [00:03<00:00,  1.59s/it]100%|##########| 2/2 [00:03<00:00,  1.79s/it]
[I 2025-05-23 20:40:16,061] Trial 1 finished with value: 1872.7773761235817 and parameters: {'changepoint_prior_scale': 0.1927612560011404, 'seasonality_prior_scale': 0.01710114225905374, 'n_changepoints': 49}. Best is trial 0 with value: 1717.0805872884748.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.43s/it]100%|##########| 2/2 [00:02<00:00,  1.02it/s]100%|##########| 2/2 [00:02<00:00,  1.04s/it]
[I 2025-05-23 20:40:19,144] Trial 2 finished with value: 1133.140793722325 and parameters: {'changepoint_prior_scale': 0.019253649367392867, 'seasonality_prior_scale': 4.444855539693884, 'n_changepoints': 28}. Best is trial 2 with value: 1133.140793722325.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:04<00:04,  4.60s/it]100%|##########| 2/2 [00:05<00:00,  2.34s/it]100%|##########| 2/2 [00:05<00:00,  2.68s/it]
[I 2025-05-23 20:40:25,420] Trial 3 finished with value: 1237.0141202096074 and parameters: {'changepoint_prior_scale': 0.3012211392323424, 'seasonality_prior_scale': 2.905102989745781, 'n_changepoints': 43}. Best is trial 2 with value: 1133.140793722325.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.70s/it]100%|##########| 2/2 [00:02<00:00,  1.17s/it]100%|##########| 2/2 [00:02<00:00,  1.25s/it]
[I 2025-05-23 20:40:29,150] Trial 4 finished with value: 997.0246830875192 and parameters: {'changepoint_prior_scale': 0.3569377822628929, 'seasonality_prior_scale': 0.2944846599825814, 'n_changepoints': 8}. Best is trial 4 with value: 997.0246830875192.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.37s/it]100%|##########| 2/2 [00:02<00:00,  1.01s/it]100%|##########| 2/2 [00:02<00:00,  1.06s/it]
[I 2025-05-23 20:40:32,522] Trial 5 finished with value: 949.9068236492393 and parameters: {'changepoint_prior_scale': 0.019240065112423817, 'seasonality_prior_scale': 0.23551868162866127, 'n_changepoints': 19}. Best is trial 5 with value: 949.9068236492393.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.24s/it]100%|##########| 2/2 [00:02<00:00,  1.04s/it]100%|##########| 2/2 [00:02<00:00,  1.07s/it]
[I 2025-05-23 20:40:35,599] Trial 6 finished with value: 1683.4778028941944 and parameters: {'changepoint_prior_scale': 0.06969985282749903, 'seasonality_prior_scale': 0.011707083009438337, 'n_changepoints': 23}. Best is trial 5 with value: 949.9068236492393.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.16s/it]100%|##########| 2/2 [00:01<00:00,  1.14it/s]100%|##########| 2/2 [00:01<00:00,  1.09it/s]
[I 2025-05-23 20:40:38,383] Trial 7 finished with value: 946.7362278152139 and parameters: {'changepoint_prior_scale': 0.006721664213422727, 'seasonality_prior_scale': 0.1310984216106135, 'n_changepoints': 26}. Best is trial 7 with value: 946.7362278152139.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.35s/it]100%|##########| 2/2 [00:01<00:00,  1.13it/s]100%|##########| 2/2 [00:01<00:00,  1.04it/s]
[I 2025-05-23 20:40:41,065] Trial 8 finished with value: 991.5980198469562 and parameters: {'changepoint_prior_scale': 0.01871541897677656, 'seasonality_prior_scale': 0.033049489956725776, 'n_changepoints': 18}. Best is trial 7 with value: 946.7362278152139.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.62s/it]100%|##########| 2/2 [00:02<00:00,  1.02s/it]100%|##########| 2/2 [00:02<00:00,  1.11s/it]
[I 2025-05-23 20:40:44,253] Trial 9 finished with value: 939.2449222249074 and parameters: {'changepoint_prior_scale': 0.023084370046318373, 'seasonality_prior_scale': 0.11675571450351463, 'n_changepoints': 29}. Best is trial 9 with value: 939.2449222249074.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.72s/it]100%|##########| 2/2 [00:02<00:00,  1.07s/it]100%|##########| 2/2 [00:02<00:00,  1.17s/it]
Rendimiento para la combinación BMX_310-BMX_OXXO-BMX_3207:
  horizon           mse         rmse  ...     mdape     smape  coverage
0 21 days  8.196433e+05   905.341541  ...  0.220935  0.213618  0.500000
1 28 days  6.864067e+05   828.496652  ...  0.220935  0.202589  0.500000
2 35 days  1.212577e+06  1101.170909  ...  0.328746  0.248331  0.500000
3 42 days  1.222941e+06  1105.866796  ...  0.374751  0.304116  0.333333
4 49 days  1.204582e+06  1097.534552  ...  0.265335  0.294152  0.333333

[5 rows x 8 columns]
          ds         yhat   yhat_lower   yhat_upper         y     cutoff
0 2022-10-24  3484.377085  2869.892187  4106.301115  3333.000 2022-10-17
1 2022-10-31  2925.767049  2283.296097  3522.180132  2238.875 2022-10-17
2 2022-11-07  3283.603960  2690.075403  3845.857305  3308.500 2022-10-17
3 2022-11-14  3396.589255  2820.263524  4038.578739  2349.625 2022-10-17
4 2022-11-21  3023.248251  2385.107099  3633.858701  2494.625 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds    y  day_of_week  week_of_year  month
0   2021-01-04  5.0            0             1      1
1   2021-01-11  4.0            0             2      1
2   2021-01-18  4.0            0             3      1
3   2021-01-25  4.0            0             4      1
4   2021-02-01  4.0            0             5      2
..         ...  ...          ...           ...    ...
151 2023-11-27  1.0            0            48     11
152 2023-12-04  4.0            0            49     12
153 2023-12-11  0.0            0            50     12
154 2023-12-18  3.0            0            51     12
155 2023-12-25  2.0            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:40:47,587] A new study created in memory with name: no-name-90e90426-8b5a-4eee-b138-5f864bb29678
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.68s/it]100%|##########| 2/2 [00:02<00:00,  1.14s/it]100%|##########| 2/2 [00:02<00:00,  1.22s/it]
[I 2025-05-23 20:40:51,109] Trial 0 finished with value: 2.020231145227137 and parameters: {'changepoint_prior_scale': 0.20047483065422686, 'seasonality_prior_scale': 0.6769159867265321, 'n_changepoints': 48}. Best is trial 0 with value: 2.020231145227137.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.38s/it]100%|##########| 2/2 [00:02<00:00,  1.05it/s]100%|##########| 2/2 [00:02<00:00,  1.02s/it]
[I 2025-05-23 20:40:53,948] Trial 1 finished with value: 1.8800044481552418 and parameters: {'changepoint_prior_scale': 0.09353671728449113, 'seasonality_prior_scale': 0.06523561370305639, 'n_changepoints': 23}. Best is trial 1 with value: 1.8800044481552418.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.50s/it]100%|##########| 2/2 [00:02<00:00,  1.02s/it]100%|##########| 2/2 [00:02<00:00,  1.10s/it]
[I 2025-05-23 20:40:57,189] Trial 2 finished with value: 1.6846960305010712 and parameters: {'changepoint_prior_scale': 0.3789509367087211, 'seasonality_prior_scale': 0.1602237863465203, 'n_changepoints': 28}. Best is trial 2 with value: 1.6846960305010712.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.05it/s]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.37s/it]100%|##########| 2/2 [00:02<00:00,  1.31s/it]
[I 2025-05-23 20:41:01,500] Trial 3 finished with value: 1.8212942967991366 and parameters: {'changepoint_prior_scale': 0.0014925654815296963, 'seasonality_prior_scale': 0.02827946783138518, 'n_changepoints': 20}. Best is trial 2 with value: 1.6846960305010712.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.44s/it]100%|##########| 2/2 [00:02<00:00,  1.04s/it]100%|##########| 2/2 [00:02<00:00,  1.10s/it]
[I 2025-05-23 20:41:04,852] Trial 4 finished with value: 3.17643278575538 and parameters: {'changepoint_prior_scale': 0.009331528567872966, 'seasonality_prior_scale': 9.58489268866205, 'n_changepoints': 14}. Best is trial 2 with value: 1.6846960305010712.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.42s/it]100%|##########| 2/2 [00:02<00:00,  1.18s/it]100%|##########| 2/2 [00:02<00:00,  1.22s/it]
[I 2025-05-23 20:41:08,287] Trial 5 finished with value: 2.0547826574031776 and parameters: {'changepoint_prior_scale': 0.11248921695332134, 'seasonality_prior_scale': 0.6311851917950095, 'n_changepoints': 24}. Best is trial 2 with value: 1.6846960305010712.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.25s/it]100%|##########| 2/2 [00:01<00:00,  1.16it/s]100%|##########| 2/2 [00:01<00:00,  1.09it/s]
[I 2025-05-23 20:41:11,181] Trial 6 finished with value: 2.22969396472812 and parameters: {'changepoint_prior_scale': 0.05442144635436488, 'seasonality_prior_scale': 1.3996974012530627, 'n_changepoints': 17}. Best is trial 2 with value: 1.6846960305010712.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.77s/it]100%|##########| 2/2 [00:03<00:00,  1.52s/it]100%|##########| 2/2 [00:03<00:00,  1.71s/it]
[I 2025-05-23 20:41:15,569] Trial 7 finished with value: 1.8722803011610503 and parameters: {'changepoint_prior_scale': 0.26336793019782523, 'seasonality_prior_scale': 0.7500271203017413, 'n_changepoints': 45}. Best is trial 2 with value: 1.6846960305010712.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.01it/s]100%|##########| 2/2 [00:01<00:00,  1.35it/s]100%|##########| 2/2 [00:01<00:00,  1.29it/s]
[I 2025-05-23 20:41:18,185] Trial 8 finished with value: 2.0990661246994438 and parameters: {'changepoint_prior_scale': 0.10734097549595005, 'seasonality_prior_scale': 0.8854860834911752, 'n_changepoints': 6}. Best is trial 2 with value: 1.6846960305010712.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.06s/it]100%|##########| 2/2 [00:01<00:00,  1.07it/s]100%|##########| 2/2 [00:01<00:00,  1.05it/s]
[I 2025-05-23 20:41:20,941] Trial 9 finished with value: 2.2995730551655886 and parameters: {'changepoint_prior_scale': 0.023242830185753117, 'seasonality_prior_scale': 1.753553245392972, 'n_changepoints': 29}. Best is trial 2 with value: 1.6846960305010712.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.41s/it]100%|##########| 2/2 [00:01<00:00,  1.12it/s]100%|##########| 2/2 [00:01<00:00,  1.03it/s]
Rendimiento para la combinación BMX_310-BMX_OXXO-BMX_3402:
  horizon       mse      rmse       mae     mdape     smape  coverage
0 21 days  1.180155  1.086349  0.932589  0.250353  0.402350  0.666667
1 28 days  0.890278  0.943545  0.817641  0.236511  0.222707  0.833333
2 35 days  3.845396  1.960968  1.470866  0.273316  0.369156  0.666667
3 42 days  3.977226  1.994298  1.490665  0.235651  0.452157  0.666667
4 49 days  5.036563  2.244229  1.882182  0.483218  0.562942  0.333333
          ds      yhat  yhat_lower  yhat_upper    y     cutoff
0 2022-10-24  0.419225   -1.396297    1.981265  2.0 2022-10-17
1 2022-10-31  0.899273   -0.777963    2.582785  1.0 2022-10-17
2 2022-11-07  2.574315    0.970038    4.309631  2.0 2022-10-17
3 2022-11-14  3.778424    2.015350    5.525528  3.0 2022-10-17
4 2022-11-21  6.266985    4.673880    8.033965  2.0 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds         y  day_of_week  week_of_year  month
0   2021-01-04   225.000            0             1      1
1   2021-01-11   265.875            0             2      1
2   2021-01-18   322.000            0             3      1
3   2021-01-25   524.000            0             4      1
4   2021-02-01   426.000            0             5      2
..         ...       ...          ...           ...    ...
151 2023-11-27   546.625            0            48     11
152 2023-12-04   565.250            0            49     12
153 2023-12-11   780.625            0            50     12
154 2023-12-18  1284.375            0            51     12
155 2023-12-25   897.750            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:41:23,713] A new study created in memory with name: no-name-69a32c7b-8776-412e-b9d3-b5609a3779dc
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.06s/it]100%|##########| 2/2 [00:01<00:00,  1.25it/s]100%|##########| 2/2 [00:01<00:00,  1.19it/s]
[I 2025-05-23 20:41:26,399] Trial 0 finished with value: 205.3052863369258 and parameters: {'changepoint_prior_scale': 0.006479631129142907, 'seasonality_prior_scale': 3.109586297111713, 'n_changepoints': 18}. Best is trial 0 with value: 205.3052863369258.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.05s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.35s/it]100%|##########| 2/2 [00:02<00:00,  1.31s/it]
[I 2025-05-23 20:41:30,371] Trial 1 finished with value: 209.4821503583275 and parameters: {'changepoint_prior_scale': 0.0027148789087176627, 'seasonality_prior_scale': 1.8374933533891833, 'n_changepoints': 32}. Best is trial 0 with value: 205.3052863369258.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.81s/it]100%|##########| 2/2 [00:03<00:00,  1.53s/it]100%|##########| 2/2 [00:03<00:00,  1.72s/it]
[I 2025-05-23 20:41:35,251] Trial 2 finished with value: 257.3019467788863 and parameters: {'changepoint_prior_scale': 0.4081778426660389, 'seasonality_prior_scale': 1.016494798577054, 'n_changepoints': 43}. Best is trial 0 with value: 205.3052863369258.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.68s/it]100%|##########| 2/2 [00:02<00:00,  1.22s/it]100%|##########| 2/2 [00:02<00:00,  1.29s/it]
[I 2025-05-23 20:41:38,877] Trial 3 finished with value: 202.17645441820088 and parameters: {'changepoint_prior_scale': 0.02394654005912516, 'seasonality_prior_scale': 3.6787259366484277, 'n_changepoints': 49}. Best is trial 3 with value: 202.17645441820088.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.61s/it]100%|##########| 2/2 [00:02<00:00,  1.04s/it]100%|##########| 2/2 [00:02<00:00,  1.13s/it]
[I 2025-05-23 20:41:41,912] Trial 4 finished with value: 210.7118386238566 and parameters: {'changepoint_prior_scale': 0.005735884877721792, 'seasonality_prior_scale': 0.03811862446892204, 'n_changepoints': 20}. Best is trial 3 with value: 202.17645441820088.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.17s/it]100%|##########| 2/2 [00:02<00:00,  1.32s/it]100%|##########| 2/2 [00:02<00:00,  1.45s/it]
[I 2025-05-23 20:41:45,747] Trial 5 finished with value: 207.0402508520109 and parameters: {'changepoint_prior_scale': 0.04292129340883983, 'seasonality_prior_scale': 8.29636360718149, 'n_changepoints': 50}. Best is trial 3 with value: 202.17645441820088.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.58s/it]100%|##########| 2/2 [00:02<00:00,  1.02it/s]100%|##########| 2/2 [00:02<00:00,  1.07s/it]
[I 2025-05-23 20:41:48,673] Trial 6 finished with value: 212.04970126716668 and parameters: {'changepoint_prior_scale': 0.060142965424121314, 'seasonality_prior_scale': 0.010199532089982916, 'n_changepoints': 49}. Best is trial 3 with value: 202.17645441820088.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.00it/s]100%|##########| 2/2 [00:01<00:00,  1.12it/s]100%|##########| 2/2 [00:01<00:00,  1.10it/s]
[I 2025-05-23 20:41:51,486] Trial 7 finished with value: 199.90785524336366 and parameters: {'changepoint_prior_scale': 0.012155794127984907, 'seasonality_prior_scale': 0.04135667183370317, 'n_changepoints': 27}. Best is trial 7 with value: 199.90785524336366.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.26s/it]100%|##########| 2/2 [00:02<00:00,  1.10s/it]100%|##########| 2/2 [00:02<00:00,  1.13s/it]
[I 2025-05-23 20:41:54,866] Trial 8 finished with value: 207.49066746551142 and parameters: {'changepoint_prior_scale': 0.04427938725344086, 'seasonality_prior_scale': 4.7939172472442015, 'n_changepoints': 7}. Best is trial 7 with value: 199.90785524336366.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:06<00:06,  6.13s/it]100%|##########| 2/2 [00:06<00:00,  2.86s/it]100%|##########| 2/2 [00:06<00:00,  3.35s/it]
[I 2025-05-23 20:42:02,745] Trial 9 finished with value: 270.43127246804204 and parameters: {'changepoint_prior_scale': 0.25884503813511245, 'seasonality_prior_scale': 0.12793602432257994, 'n_changepoints': 48}. Best is trial 7 with value: 199.90785524336366.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.04it/s]100%|##########| 2/2 [00:01<00:00,  1.31it/s]100%|##########| 2/2 [00:01<00:00,  1.26it/s]
Rendimiento para la combinación BMX_310-BMX_OXXO-BMX_3931:
  horizon            mse        rmse  ...     mdape     smape  coverage
0 21 days    8564.831695   92.546376  ...  0.116044  0.120475  1.000000
1 28 days   13438.516014  115.924613  ...  0.149353  0.154565  1.000000
2 35 days  114377.756013  338.197806  ...  0.177787  0.253983  0.833333
3 42 days  129500.476084  359.861746  ...  0.177787  0.338713  0.666667
4 49 days  148110.883318  384.851768  ...  0.362284  0.415939  0.500000

[5 rows x 8 columns]
          ds        yhat  yhat_lower  yhat_upper         y     cutoff
0 2022-10-24  688.993932  527.727156  866.667369   667.000 2022-10-17
1 2022-10-31  583.196168  413.385996  744.218856   515.375 2022-10-17
2 2022-11-07  572.562871  402.474218  756.618033   631.375 2022-10-17
3 2022-11-14  513.803600  328.077523  687.877435   633.125 2022-10-17
4 2022-11-21  635.996252  461.736422  813.473991  1419.125 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds          y  day_of_week  week_of_year  month
0   2021-01-04  15436.750            0             1      1
1   2021-01-11  14420.875            0             2      1
2   2021-01-18  21331.000            0             3      1
3   2021-01-25  21820.000            0             4      1
4   2021-02-01  18781.000            0             5      2
..         ...        ...          ...           ...    ...
151 2023-11-27  22403.500            0            48     11
152 2023-12-04  24565.250            0            49     12
153 2023-12-11  20285.750            0            50     12
154 2023-12-18  25601.500            0            51     12
155 2023-12-25  20275.250            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:42:05,124] A new study created in memory with name: no-name-797213dd-c7b6-4c5c-8999-65e1cf987a92
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.43s/it]100%|##########| 2/2 [00:04<00:00,  1.90s/it]100%|##########| 2/2 [00:04<00:00,  2.12s/it]
[I 2025-05-23 20:42:10,857] Trial 0 finished with value: 5126.128986237054 and parameters: {'changepoint_prior_scale': 0.046865323220746, 'seasonality_prior_scale': 0.09683734189378904, 'n_changepoints': 39}. Best is trial 0 with value: 5126.128986237054.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.21s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:04<00:00,  2.35s/it]100%|##########| 2/2 [00:04<00:00,  2.18s/it]
[I 2025-05-23 20:42:17,193] Trial 1 finished with value: 4766.554881076104 and parameters: {'changepoint_prior_scale': 0.0014200065435110583, 'seasonality_prior_scale': 0.2730055963028854, 'n_changepoints': 27}. Best is trial 1 with value: 4766.554881076104.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.41s/it]100%|##########| 2/2 [00:02<00:00,  1.01it/s]100%|##########| 2/2 [00:02<00:00,  1.05s/it]
[I 2025-05-23 20:42:20,240] Trial 2 finished with value: 4845.677202101416 and parameters: {'changepoint_prior_scale': 0.019877826906859655, 'seasonality_prior_scale': 0.21126622699610614, 'n_changepoints': 19}. Best is trial 1 with value: 4766.554881076104.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.36s/it]100%|##########| 2/2 [00:02<00:00,  1.06it/s]100%|##########| 2/2 [00:02<00:00,  1.00s/it]
[I 2025-05-23 20:42:23,145] Trial 3 finished with value: 6884.619791566159 and parameters: {'changepoint_prior_scale': 0.07799651702260434, 'seasonality_prior_scale': 0.015749874204690293, 'n_changepoints': 10}. Best is trial 1 with value: 4766.554881076104.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.61s/it]100%|##########| 2/2 [00:02<00:00,  1.03s/it]100%|##########| 2/2 [00:02<00:00,  1.12s/it]
[I 2025-05-23 20:42:26,331] Trial 4 finished with value: 5253.562484577971 and parameters: {'changepoint_prior_scale': 0.08321915184501555, 'seasonality_prior_scale': 0.5157463384983229, 'n_changepoints': 18}. Best is trial 1 with value: 4766.554881076104.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.11it/s]100%|##########| 2/2 [00:01<00:00,  1.35it/s]100%|##########| 2/2 [00:01<00:00,  1.31it/s]
[I 2025-05-23 20:42:28,790] Trial 5 finished with value: 5203.928339726744 and parameters: {'changepoint_prior_scale': 0.038949929389878214, 'seasonality_prior_scale': 1.7714969732213521, 'n_changepoints': 7}. Best is trial 1 with value: 4766.554881076104.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.73s/it]100%|##########| 2/2 [00:02<00:00,  1.06s/it]100%|##########| 2/2 [00:02<00:00,  1.16s/it]
[I 2025-05-23 20:42:32,003] Trial 6 finished with value: 4856.712296767102 and parameters: {'changepoint_prior_scale': 0.018598841390886307, 'seasonality_prior_scale': 3.5239931729490137, 'n_changepoints': 20}. Best is trial 1 with value: 4766.554881076104.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  3.00s/it]100%|##########| 2/2 [00:03<00:00,  1.60s/it]100%|##########| 2/2 [00:03<00:00,  1.81s/it]
[I 2025-05-23 20:42:36,545] Trial 7 finished with value: 4103.911781901565 and parameters: {'changepoint_prior_scale': 0.2908590485969221, 'seasonality_prior_scale': 0.06814491207290364, 'n_changepoints': 43}. Best is trial 7 with value: 4103.911781901565.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.05s/it]100%|##########| 2/2 [00:02<00:00,  1.20s/it]100%|##########| 2/2 [00:02<00:00,  1.33s/it]
[I 2025-05-23 20:42:40,168] Trial 8 finished with value: 4905.662480096452 and parameters: {'changepoint_prior_scale': 0.0232747605400302, 'seasonality_prior_scale': 4.263823845429066, 'n_changepoints': 37}. Best is trial 7 with value: 4103.911781901565.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.38s/it]100%|##########| 2/2 [00:02<00:00,  1.03it/s]100%|##########| 2/2 [00:02<00:00,  1.03s/it]
[I 2025-05-23 20:42:43,024] Trial 9 finished with value: 4869.975227734895 and parameters: {'changepoint_prior_scale': 0.00899188243899046, 'seasonality_prior_scale': 1.2244321247268124, 'n_changepoints': 34}. Best is trial 7 with value: 4103.911781901565.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.31s/it]100%|##########| 2/2 [00:04<00:00,  1.82s/it]100%|##########| 2/2 [00:04<00:00,  2.04s/it]
Rendimiento para la combinación BMX_310-BMX_TRADICIONAL-BMX_3001:
  horizon           mse         rmse  ...     mdape     smape  coverage
0 21 days  1.047957e+07  3237.216991  ...  0.147979  0.132074  0.166667
1 28 days  1.489645e+07  3859.592189  ...  0.147979  0.148402  0.333333
2 35 days  1.838837e+07  4288.165901  ...  0.172883  0.171448  0.333333
3 42 days  1.516990e+07  3894.855712  ...  0.121544  0.145542  0.500000
4 49 days  7.516989e+06  2741.712717  ...  0.103644  0.101733  0.500000

[5 rows x 8 columns]
          ds          yhat    yhat_lower    yhat_upper          y     cutoff
0 2022-10-24  24551.922862  22250.968270  26755.157478  21870.375 2022-10-17
1 2022-10-31  20997.509901  18654.021463  23356.026461  18415.000 2022-10-17
2 2022-11-07  22402.640824  20222.994344  24763.393255  18825.000 2022-10-17
3 2022-11-14  22500.895989  20317.522826  24987.231629  15130.500 2022-10-17
4 2022-11-21  22756.025540  20359.523141  25107.986699  21022.875 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds          y  day_of_week  week_of_year  month
0   2021-01-04   8019.875            0             1      1
1   2021-01-11   6782.500            0             2      1
2   2021-01-18   9727.125            0             3      1
3   2021-01-25  13114.000            0             4      1
4   2021-02-01   7556.500            0             5      2
..         ...        ...          ...           ...    ...
151 2023-11-27   6755.875            0            48     11
152 2023-12-04   7389.750            0            49     12
153 2023-12-11   9413.000            0            50     12
154 2023-12-18  10184.625            0            51     12
155 2023-12-25   8204.500            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:42:47,975] A new study created in memory with name: no-name-8508f1f9-4104-4f74-a7e1-9c5d461e40a2
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.01s/it]100%|##########| 2/2 [00:01<00:00,  1.25it/s]100%|##########| 2/2 [00:01<00:00,  1.20it/s]
[I 2025-05-23 20:42:50,504] Trial 0 finished with value: 3099.5839214906987 and parameters: {'changepoint_prior_scale': 0.08963810303082417, 'seasonality_prior_scale': 0.01105568658057375, 'n_changepoints': 10}. Best is trial 0 with value: 3099.5839214906987.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.39s/it]100%|##########| 2/2 [00:03<00:00,  1.45s/it]100%|##########| 2/2 [00:03<00:00,  1.59s/it]
[I 2025-05-23 20:42:54,815] Trial 1 finished with value: 2173.3900772742536 and parameters: {'changepoint_prior_scale': 0.41229507777787533, 'seasonality_prior_scale': 0.1696509388657334, 'n_changepoints': 23}. Best is trial 1 with value: 2173.3900772742536.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.62s/it]100%|##########| 2/2 [00:02<00:00,  1.09s/it]100%|##########| 2/2 [00:02<00:00,  1.17s/it]
[I 2025-05-23 20:42:58,096] Trial 2 finished with value: 2532.4089165917703 and parameters: {'changepoint_prior_scale': 0.019532717099290085, 'seasonality_prior_scale': 0.010984046398363574, 'n_changepoints': 33}. Best is trial 1 with value: 2173.3900772742536.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.04s/it]100%|##########| 2/2 [00:01<00:00,  1.13it/s]100%|##########| 2/2 [00:01<00:00,  1.10it/s]
[I 2025-05-23 20:43:01,511] Trial 3 finished with value: 2413.286321362821 and parameters: {'changepoint_prior_scale': 0.0013896554811500038, 'seasonality_prior_scale': 0.3380308997128528, 'n_changepoints': 15}. Best is trial 1 with value: 2173.3900772742536.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.94s/it]100%|##########| 2/2 [00:03<00:00,  1.46s/it]100%|##########| 2/2 [00:03<00:00,  1.53s/it]
[I 2025-05-23 20:43:05,736] Trial 4 finished with value: 2218.224334559754 and parameters: {'changepoint_prior_scale': 0.009335978849808302, 'seasonality_prior_scale': 0.7400510810426991, 'n_changepoints': 31}. Best is trial 1 with value: 2173.3900772742536.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.44s/it]100%|##########| 2/2 [00:03<00:00,  1.39s/it]100%|##########| 2/2 [00:03<00:00,  1.54s/it]
[I 2025-05-23 20:43:10,036] Trial 5 finished with value: 2211.222225416109 and parameters: {'changepoint_prior_scale': 0.09399996279073965, 'seasonality_prior_scale': 0.060093803339836986, 'n_changepoints': 29}. Best is trial 1 with value: 2173.3900772742536.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.67s/it]100%|##########| 2/2 [00:02<00:00,  1.16s/it]100%|##########| 2/2 [00:02<00:00,  1.24s/it]
[I 2025-05-23 20:43:13,348] Trial 6 finished with value: 2199.8803670525995 and parameters: {'changepoint_prior_scale': 0.050914378775649693, 'seasonality_prior_scale': 0.9089457595165488, 'n_changepoints': 33}. Best is trial 1 with value: 2173.3900772742536.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.41s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.39s/it]100%|##########| 2/2 [00:02<00:00,  1.39s/it]
[I 2025-05-23 20:43:18,237] Trial 7 finished with value: 2109.7323525828547 and parameters: {'changepoint_prior_scale': 0.001097904683351972, 'seasonality_prior_scale': 0.1821835117016003, 'n_changepoints': 26}. Best is trial 7 with value: 2109.7323525828547.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.05s/it]100%|##########| 2/2 [00:01<00:00,  1.33it/s]100%|##########| 2/2 [00:01<00:00,  1.25it/s]
[I 2025-05-23 20:43:20,839] Trial 8 finished with value: 2486.722729160986 and parameters: {'changepoint_prior_scale': 0.14024451829477882, 'seasonality_prior_scale': 6.68012721279215, 'n_changepoints': 7}. Best is trial 7 with value: 2109.7323525828547.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.98s/it]100%|##########| 2/2 [00:02<00:00,  1.19s/it]100%|##########| 2/2 [00:02<00:00,  1.31s/it]
[I 2025-05-23 20:43:24,317] Trial 9 finished with value: 2103.691591520672 and parameters: {'changepoint_prior_scale': 0.020465367350166134, 'seasonality_prior_scale': 0.06607398954496672, 'n_changepoints': 48}. Best is trial 9 with value: 2103.691591520672.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.41s/it]100%|##########| 2/2 [00:03<00:00,  1.42s/it]100%|##########| 2/2 [00:03<00:00,  1.57s/it]
Rendimiento para la combinación BMX_310-BMX_TRADICIONAL-BMX_3207:
  horizon           mse         rmse  ...     mdape     smape  coverage
0 21 days  3.314626e+06  1820.611531  ...  0.193256  0.139819  0.333333
1 28 days  2.727726e+06  1651.582942  ...  0.150336  0.126854  0.500000
2 35 days  4.446828e+06  2108.750423  ...  0.150336  0.153385  0.500000
3 42 days  4.070865e+06  2017.638561  ...  0.125842  0.146936  0.666667
4 49 days  4.418564e+06  2102.038092  ...  0.121714  0.152962  0.666667

[5 rows x 8 columns]
          ds          yhat    yhat_lower    yhat_upper          y     cutoff
0 2022-10-24  13133.639240  11819.721959  14568.478284  11069.375 2022-10-17
1 2022-10-31   8832.856208   7329.171779  10325.280072   8805.625 2022-10-17
2 2022-11-07   8498.878073   7006.805667   9942.766077   8641.500 2022-10-17
3 2022-11-14   8063.985940   6642.556179   9562.145213   6978.500 2022-10-17
4 2022-11-21  12397.312019  10973.143354  13874.922986  11714.375 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds        y  day_of_week  week_of_year  month
0   2021-01-04  103.000            0             1      1
1   2021-01-11  102.000            0             2      1
2   2021-01-18  125.000            0             3      1
3   2021-01-25  195.000            0             4      1
4   2021-02-01  196.000            0             5      2
..         ...      ...          ...           ...    ...
151 2023-11-27   73.000            0            48     11
152 2023-12-04   70.875            0            49     12
153 2023-12-11   85.625            0            50     12
154 2023-12-18  102.750            0            51     12
155 2023-12-25   88.750            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:43:28,835] A new study created in memory with name: no-name-ca7d9da2-e639-46aa-8fa7-3693d1ea4629
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.46s/it]100%|##########| 2/2 [00:03<00:00,  1.41s/it]100%|##########| 2/2 [00:03<00:00,  1.57s/it]
[I 2025-05-23 20:43:32,975] Trial 0 finished with value: 43.11648958524359 and parameters: {'changepoint_prior_scale': 0.13284630579499673, 'seasonality_prior_scale': 0.09388975821235693, 'n_changepoints': 43}. Best is trial 0 with value: 43.11648958524359.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.14s/it]100%|##########| 2/2 [00:01<00:00,  1.09it/s]100%|##########| 2/2 [00:01<00:00,  1.05it/s]
[I 2025-05-23 20:43:36,790] Trial 1 finished with value: 45.461977246943086 and parameters: {'changepoint_prior_scale': 0.001475642890461711, 'seasonality_prior_scale': 0.08736356856079837, 'n_changepoints': 32}. Best is trial 0 with value: 43.11648958524359.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.30s/it]100%|##########| 2/2 [00:02<00:00,  1.03it/s]100%|##########| 2/2 [00:02<00:00,  1.02s/it]
[I 2025-05-23 20:43:40,080] Trial 2 finished with value: 38.854089863638656 and parameters: {'changepoint_prior_scale': 0.011126471371453115, 'seasonality_prior_scale': 2.14598628453883, 'n_changepoints': 15}. Best is trial 2 with value: 38.854089863638656.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.23s/it]100%|##########| 2/2 [00:01<00:00,  1.27it/s]100%|##########| 2/2 [00:01<00:00,  1.17it/s]
[I 2025-05-23 20:43:42,760] Trial 3 finished with value: 41.95808605141738 and parameters: {'changepoint_prior_scale': 0.07304160966871695, 'seasonality_prior_scale': 0.16977632831008005, 'n_changepoints': 15}. Best is trial 2 with value: 38.854089863638656.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.55s/it]100%|##########| 2/2 [00:03<00:00,  1.52s/it]100%|##########| 2/2 [00:03<00:00,  1.67s/it]
[I 2025-05-23 20:43:46,959] Trial 4 finished with value: 34.0840340321353 and parameters: {'changepoint_prior_scale': 0.2634401157216856, 'seasonality_prior_scale': 0.1565309344882879, 'n_changepoints': 25}. Best is trial 4 with value: 34.0840340321353.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.03it/s]100%|##########| 2/2 [00:01<00:00,  1.27it/s]100%|##########| 2/2 [00:01<00:00,  1.22it/s]
[I 2025-05-23 20:43:49,498] Trial 5 finished with value: 33.7172542462271 and parameters: {'changepoint_prior_scale': 0.0020204194301573263, 'seasonality_prior_scale': 0.26890576858222376, 'n_changepoints': 5}. Best is trial 5 with value: 33.7172542462271.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.22s/it]100%|##########| 2/2 [00:03<00:00,  1.75s/it]100%|##########| 2/2 [00:03<00:00,  1.97s/it]
[I 2025-05-23 20:43:54,460] Trial 6 finished with value: 42.74649303495694 and parameters: {'changepoint_prior_scale': 0.15434186812271436, 'seasonality_prior_scale': 0.056012911602975224, 'n_changepoints': 46}. Best is trial 5 with value: 33.7172542462271.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.34s/it]100%|##########| 2/2 [00:02<00:00,  1.06s/it]100%|##########| 2/2 [00:02<00:00,  1.10s/it]
[I 2025-05-23 20:43:57,602] Trial 7 finished with value: 39.75538567555671 and parameters: {'changepoint_prior_scale': 0.01686262397539843, 'seasonality_prior_scale': 0.3679802958134263, 'n_changepoints': 49}. Best is trial 5 with value: 33.7172542462271.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.84s/it]100%|##########| 2/2 [00:02<00:00,  1.28s/it]100%|##########| 2/2 [00:02<00:00,  1.37s/it]
[I 2025-05-23 20:44:01,775] Trial 8 finished with value: 38.38051648001091 and parameters: {'changepoint_prior_scale': 0.008374701446801873, 'seasonality_prior_scale': 0.22047614893311399, 'n_changepoints': 40}. Best is trial 5 with value: 33.7172542462271.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.08s/it]100%|##########| 2/2 [00:01<00:00,  1.27it/s]100%|##########| 2/2 [00:01<00:00,  1.20it/s]
[I 2025-05-23 20:44:04,470] Trial 9 finished with value: 38.27302211383163 and parameters: {'changepoint_prior_scale': 0.00698831564062185, 'seasonality_prior_scale': 1.0976508008641659, 'n_changepoints': 33}. Best is trial 5 with value: 33.7172542462271.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.26s/it]100%|##########| 2/2 [00:01<00:00,  1.06it/s]100%|##########| 2/2 [00:01<00:00,  1.01it/s]
Rendimiento para la combinación BMX_310-BMX_TRADICIONAL-BMX_3402:
  horizon          mse       rmse  ...     mdape     smape  coverage
0 21 days  1370.776696  37.024002  ...  0.207723  0.251083  0.500000
1 28 days  1549.527876  39.364043  ...  0.260182  0.291414  0.500000
2 35 days   924.520562  30.405930  ...  0.166934  0.187080  0.666667
3 42 days   472.819654  21.744417  ...  0.166934  0.164973  0.666667
4 49 days   590.586616  24.301988  ...  0.133524  0.186753  0.666667

[5 rows x 8 columns]
          ds        yhat  yhat_lower  yhat_upper        y     cutoff
0 2022-10-24  139.918310  116.037938  163.606376  114.000 2022-10-17
1 2022-10-31  134.334039  109.259402  158.655577   79.500 2022-10-17
2 2022-11-07  140.278253  113.389580  164.172474   80.625 2022-10-17
3 2022-11-14  116.189958   91.371701  141.031455   91.250 2022-10-17
4 2022-11-21   79.103006   56.756944  105.104999   80.000 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds         y  day_of_week  week_of_year  month
0   2021-01-04  3765.125            0             1      1
1   2021-01-11  4029.625            0             2      1
2   2021-01-18  3558.375            0             3      1
3   2021-01-25  4395.125            0             4      1
4   2021-02-01  3562.750            0             5      2
..         ...       ...          ...           ...    ...
151 2023-11-27  4168.500            0            48     11
152 2023-12-04  4313.625            0            49     12
153 2023-12-11  4752.875            0            50     12
154 2023-12-18  5634.500            0            51     12
155 2023-12-25  5334.000            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:44:07,515] A new study created in memory with name: no-name-35ae2266-8270-42e1-9eaa-881f372fb1a9
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.41s/it]100%|##########| 2/2 [00:02<00:00,  1.03it/s]100%|##########| 2/2 [00:02<00:00,  1.04s/it]
[I 2025-05-23 20:44:10,722] Trial 0 finished with value: 630.7245710366507 and parameters: {'changepoint_prior_scale': 0.19818218386016323, 'seasonality_prior_scale': 0.10224404742378183, 'n_changepoints': 10}. Best is trial 0 with value: 630.7245710366507.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.27s/it]100%|##########| 2/2 [00:01<00:00,  1.16it/s]100%|##########| 2/2 [00:01<00:00,  1.08it/s]
[I 2025-05-23 20:44:13,479] Trial 1 finished with value: 525.089135660758 and parameters: {'changepoint_prior_scale': 0.0019378344691556389, 'seasonality_prior_scale': 0.07614467517571392, 'n_changepoints': 24}. Best is trial 1 with value: 525.089135660758.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.45s/it]100%|##########| 2/2 [00:04<00:00,  1.85s/it]100%|##########| 2/2 [00:04<00:00,  2.09s/it]
[I 2025-05-23 20:44:18,511] Trial 2 finished with value: 640.3405320056153 and parameters: {'changepoint_prior_scale': 0.12936265719679785, 'seasonality_prior_scale': 0.37224387429267247, 'n_changepoints': 18}. Best is trial 1 with value: 525.089135660758.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.20s/it]100%|##########| 2/2 [00:01<00:00,  1.08it/s]100%|##########| 2/2 [00:01<00:00,  1.04it/s]
[I 2025-05-23 20:44:21,314] Trial 3 finished with value: 619.7780308309752 and parameters: {'changepoint_prior_scale': 0.1081843633900329, 'seasonality_prior_scale': 0.11429926740479641, 'n_changepoints': 19}. Best is trial 1 with value: 525.089135660758.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.75s/it]100%|##########| 2/2 [00:02<00:00,  1.13s/it]100%|##########| 2/2 [00:02<00:00,  1.22s/it]
[I 2025-05-23 20:44:24,758] Trial 4 finished with value: 556.6541121652847 and parameters: {'changepoint_prior_scale': 0.0024428265496880216, 'seasonality_prior_scale': 7.601305670941424, 'n_changepoints': 38}. Best is trial 1 with value: 525.089135660758.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.11s/it]100%|##########| 2/2 [00:01<00:00,  1.14it/s]100%|##########| 2/2 [00:01<00:00,  1.10it/s]
[I 2025-05-23 20:44:27,653] Trial 5 finished with value: 590.0111056199619 and parameters: {'changepoint_prior_scale': 0.002507791146737469, 'seasonality_prior_scale': 0.19482308153322153, 'n_changepoints': 29}. Best is trial 1 with value: 525.089135660758.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.39s/it]100%|##########| 2/2 [00:02<00:00,  1.07it/s]100%|##########| 2/2 [00:02<00:00,  1.00s/it]
[I 2025-05-23 20:44:30,584] Trial 6 finished with value: 594.9637297828257 and parameters: {'changepoint_prior_scale': 0.0036715371433526296, 'seasonality_prior_scale': 0.016927089899652834, 'n_changepoints': 27}. Best is trial 1 with value: 525.089135660758.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.09s/it]100%|##########| 2/2 [00:01<00:00,  1.24it/s]100%|##########| 2/2 [00:01<00:00,  1.17it/s]
[I 2025-05-23 20:44:33,260] Trial 7 finished with value: 642.9970311920098 and parameters: {'changepoint_prior_scale': 0.007037191905453386, 'seasonality_prior_scale': 1.853409336497589, 'n_changepoints': 13}. Best is trial 1 with value: 525.089135660758.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.83s/it]100%|##########| 2/2 [00:02<00:00,  1.19s/it]100%|##########| 2/2 [00:02<00:00,  1.29s/it]
[I 2025-05-23 20:44:36,649] Trial 8 finished with value: 656.1322740552121 and parameters: {'changepoint_prior_scale': 0.1409751562041584, 'seasonality_prior_scale': 0.9235247886751624, 'n_changepoints': 25}. Best is trial 1 with value: 525.089135660758.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.59s/it]100%|##########| 2/2 [00:03<00:00,  1.54s/it]100%|##########| 2/2 [00:03<00:00,  1.70s/it]
[I 2025-05-23 20:44:41,079] Trial 9 finished with value: 674.1074379283459 and parameters: {'changepoint_prior_scale': 0.03147050526700727, 'seasonality_prior_scale': 3.5359544026134753, 'n_changepoints': 40}. Best is trial 1 with value: 525.089135660758.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.20s/it]100%|##########| 2/2 [00:01<00:00,  1.15it/s]100%|##########| 2/2 [00:01<00:00,  1.09it/s]
Rendimiento para la combinación BMX_310-BMX_TRADICIONAL-BMX_3931:
  horizon            mse        rmse  ...     mdape     smape  coverage
0 21 days  493007.491449  702.144922  ...  0.140773  0.130885       0.5
1 28 days  459391.441957  677.784215  ...  0.119773  0.131589       0.5
2 35 days  679410.040570  824.263332  ...  0.119773  0.158124       0.5
3 42 days  583762.028208  764.043211  ...  0.106542  0.139158       0.5
4 49 days  719346.806625  848.143152  ...  0.106542  0.145483       0.5

[5 rows x 8 columns]
          ds         yhat   yhat_lower   yhat_upper         y     cutoff
0 2022-10-24  4623.154150  4349.661295  4872.497109  4562.500 2022-10-17
1 2022-10-31  5074.727962  4807.889942  5354.827828  4014.375 2022-10-17
2 2022-11-07  4925.756827  4652.154710  5214.812703  4002.500 2022-10-17
3 2022-11-14  4447.678584  4168.076423  4724.817710  3868.375 2022-10-17
4 2022-11-21  3298.182917  3006.426878  3551.743490  4843.375 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds         y  day_of_week  week_of_year  month
0   2021-01-04  1131.647            0             1      1
1   2021-01-11   966.275            0             2      1
2   2021-01-18  1071.430            0             3      1
3   2021-01-25  1107.515            0             4      1
4   2021-02-01  1134.356            0             5      2
..         ...       ...          ...           ...    ...
151 2023-11-27   975.448            0            48     11
152 2023-12-04   960.726            0            49     12
153 2023-12-11  1081.962            0            50     12
154 2023-12-18  1145.709            0            51     12
155 2023-12-25   815.056            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:44:43,924] A new study created in memory with name: no-name-31422f50-78cf-4a72-8921-2bbdded993fd
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.04s/it]100%|##########| 2/2 [00:01<00:00,  1.23it/s]100%|##########| 2/2 [00:01<00:00,  1.18it/s]
[I 2025-05-23 20:44:46,725] Trial 0 finished with value: 543.6558290195685 and parameters: {'changepoint_prior_scale': 0.0012522118511480655, 'seasonality_prior_scale': 4.890984296967782, 'n_changepoints': 9}. Best is trial 0 with value: 543.6558290195685.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:04<00:04,  4.36s/it]100%|##########| 2/2 [00:05<00:00,  2.22s/it]100%|##########| 2/2 [00:05<00:00,  2.54s/it]
[I 2025-05-23 20:44:53,259] Trial 1 finished with value: 417.5420356086163 and parameters: {'changepoint_prior_scale': 0.1517729880029516, 'seasonality_prior_scale': 0.055872392611980265, 'n_changepoints': 21}. Best is trial 1 with value: 417.5420356086163.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:06<00:06,  6.06s/it]100%|##########| 2/2 [00:06<00:00,  3.02s/it]100%|##########| 2/2 [00:06<00:00,  3.48s/it]
[I 2025-05-23 20:45:01,505] Trial 2 finished with value: 420.2108384638524 and parameters: {'changepoint_prior_scale': 0.17640321120519634, 'seasonality_prior_scale': 0.010688631386939009, 'n_changepoints': 31}. Best is trial 1 with value: 417.5420356086163.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.82s/it]100%|##########| 2/2 [00:03<00:00,  1.44s/it]100%|##########| 2/2 [00:03<00:00,  1.65s/it]
[I 2025-05-23 20:45:05,669] Trial 3 finished with value: 261.85791050086993 and parameters: {'changepoint_prior_scale': 0.0352907119046545, 'seasonality_prior_scale': 0.06349210620762, 'n_changepoints': 41}. Best is trial 3 with value: 261.85791050086993.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.75s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.91s/it]100%|##########| 2/2 [00:03<00:00,  1.89s/it]
[I 2025-05-23 20:45:11,898] Trial 4 finished with value: 350.8921177746078 and parameters: {'changepoint_prior_scale': 0.0028313272558143183, 'seasonality_prior_scale': 0.4707133871199124, 'n_changepoints': 38}. Best is trial 3 with value: 261.85791050086993.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.12s/it]100%|##########| 2/2 [00:02<00:00,  1.35s/it]100%|##########| 2/2 [00:02<00:00,  1.47s/it]
[I 2025-05-23 20:45:16,607] Trial 5 finished with value: 377.8154190202195 and parameters: {'changepoint_prior_scale': 0.05688935466708905, 'seasonality_prior_scale': 4.812789248657961, 'n_changepoints': 10}. Best is trial 3 with value: 261.85791050086993.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.89s/it]100%|##########| 2/2 [00:02<00:00,  1.14s/it]100%|##########| 2/2 [00:02<00:00,  1.25s/it]
[I 2025-05-23 20:45:20,461] Trial 6 finished with value: 321.1064885527486 and parameters: {'changepoint_prior_scale': 0.03194522927051135, 'seasonality_prior_scale': 0.5337788527016759, 'n_changepoints': 7}. Best is trial 3 with value: 261.85791050086993.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.27s/it]100%|##########| 2/2 [00:02<00:00,  1.02it/s]100%|##########| 2/2 [00:02<00:00,  1.02s/it]
[I 2025-05-23 20:45:23,308] Trial 7 finished with value: 229.71008126273082 and parameters: {'changepoint_prior_scale': 0.05089645352686693, 'seasonality_prior_scale': 1.5948705317859533, 'n_changepoints': 6}. Best is trial 7 with value: 229.71008126273082.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.90s/it]100%|##########| 2/2 [00:02<00:00,  1.27s/it]100%|##########| 2/2 [00:02<00:00,  1.36s/it]
[I 2025-05-23 20:45:29,063] Trial 8 finished with value: 355.4349269664164 and parameters: {'changepoint_prior_scale': 0.005129659683483553, 'seasonality_prior_scale': 2.877235372387376, 'n_changepoints': 38}. Best is trial 7 with value: 229.71008126273082.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.94s/it]100%|##########| 2/2 [00:03<00:00,  1.63s/it]100%|##########| 2/2 [00:03<00:00,  1.82s/it]
[I 2025-05-23 20:45:33,931] Trial 9 finished with value: 425.31837099058384 and parameters: {'changepoint_prior_scale': 0.09635194258428337, 'seasonality_prior_scale': 1.8715992397955998, 'n_changepoints': 45}. Best is trial 7 with value: 229.71008126273082.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.01s/it]100%|##########| 2/2 [00:03<00:00,  1.41s/it]100%|##########| 2/2 [00:03<00:00,  1.50s/it]
Rendimiento para la combinación BMX_6-BMX_HOGAR-BMX_3001:
  horizon           mse        rmse  ...     mdape     smape  coverage
0 21 days  27066.954985  164.520379  ...  0.146371  0.140571  0.333333
1 28 days  23458.359918  153.161222  ...  0.129165  0.129138  0.333333
2 35 days  18755.920701  136.952257  ...  0.124046  0.118389  0.333333
3 42 days   9102.156198   95.405221  ...  0.075401  0.078594  0.500000
4 49 days  10654.495494  103.220616  ...  0.086950  0.083648  0.500000

[5 rows x 8 columns]
          ds         yhat   yhat_lower   yhat_upper         y     cutoff
0 2022-10-24  1173.546271  1065.775162  1282.255427  1253.723 2022-10-17
1 2022-10-31  1000.749583   889.782303  1100.926410  1132.295 2022-10-17
2 2022-11-07   942.548355   830.159207  1043.747951  1164.674 2022-10-17
3 2022-11-14   813.337272   709.366666   926.712592   948.116 2022-10-17
4 2022-11-21  1054.140560   941.903785  1161.138159   926.786 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds        y  day_of_week  week_of_year  month
0   2021-01-04  129.487            0             1      1
1   2021-01-11  128.036            0             2      1
2   2021-01-18  126.462            0             3      1
3   2021-01-25  163.842            0             4      1
4   2021-02-01  140.915            0             5      2
..         ...      ...          ...           ...    ...
151 2023-11-27  144.060            0            48     11
152 2023-12-04  128.105            0            49     12
153 2023-12-11  143.121            0            50     12
154 2023-12-18  145.060            0            51     12
155 2023-12-25   92.037            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:45:38,509] A new study created in memory with name: no-name-68c47479-cbe0-4b50-b613-fca6186bb71a
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.90s/it]100%|##########| 2/2 [00:02<00:00,  1.25s/it]100%|##########| 2/2 [00:02<00:00,  1.35s/it]
[I 2025-05-23 20:45:42,316] Trial 0 finished with value: 137.75315756735878 and parameters: {'changepoint_prior_scale': 0.04315050528677799, 'seasonality_prior_scale': 0.021878864530152368, 'n_changepoints': 11}. Best is trial 0 with value: 137.75315756735878.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.12s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.95s/it]100%|##########| 2/2 [00:03<00:00,  1.82s/it]
[I 2025-05-23 20:45:48,037] Trial 1 finished with value: 108.58209579552876 and parameters: {'changepoint_prior_scale': 0.0016590059796961175, 'seasonality_prior_scale': 0.023449525425230898, 'n_changepoints': 29}. Best is trial 1 with value: 108.58209579552876.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.12s/it]100%|##########| 2/2 [00:01<00:00,  1.05it/s]100%|##########| 2/2 [00:01<00:00,  1.02it/s]
[I 2025-05-23 20:45:51,405] Trial 2 finished with value: 104.58359249043764 and parameters: {'changepoint_prior_scale': 0.003855681856460768, 'seasonality_prior_scale': 8.52558072957333, 'n_changepoints': 16}. Best is trial 2 with value: 104.58359249043764.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.73s/it]100%|##########| 2/2 [00:02<00:00,  1.02s/it]100%|##########| 2/2 [00:02<00:00,  1.13s/it]
[I 2025-05-23 20:45:54,611] Trial 3 finished with value: 103.10390185190438 and parameters: {'changepoint_prior_scale': 0.027020516706919535, 'seasonality_prior_scale': 0.014314123175635834, 'n_changepoints': 29}. Best is trial 3 with value: 103.10390185190438.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.00s/it]100%|##########| 2/2 [00:01<00:00,  1.28it/s]100%|##########| 2/2 [00:01<00:00,  1.23it/s]
[I 2025-05-23 20:45:57,191] Trial 4 finished with value: 96.52596302781868 and parameters: {'changepoint_prior_scale': 0.003163247350660008, 'seasonality_prior_scale': 0.2394183986029732, 'n_changepoints': 10}. Best is trial 4 with value: 96.52596302781868.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.26s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.31s/it]100%|##########| 2/2 [00:02<00:00,  1.31s/it]
[I 2025-05-23 20:46:02,371] Trial 5 finished with value: 124.82926325081687 and parameters: {'changepoint_prior_scale': 0.0012429144084973166, 'seasonality_prior_scale': 5.433742210719113, 'n_changepoints': 28}. Best is trial 4 with value: 96.52596302781868.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.55s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.57s/it]100%|##########| 2/2 [00:03<00:00,  1.57s/it]
[I 2025-05-23 20:46:06,579] Trial 6 finished with value: 121.26901565569774 and parameters: {'changepoint_prior_scale': 0.0032909349727246523, 'seasonality_prior_scale': 0.3472152832847741, 'n_changepoints': 28}. Best is trial 4 with value: 96.52596302781868.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.05s/it]100%|##########| 2/2 [00:02<00:00,  1.10s/it]100%|##########| 2/2 [00:02<00:00,  1.24s/it]
[I 2025-05-23 20:46:10,120] Trial 7 finished with value: 162.00275336958254 and parameters: {'changepoint_prior_scale': 0.07699471230152186, 'seasonality_prior_scale': 7.669055486099166, 'n_changepoints': 10}. Best is trial 4 with value: 96.52596302781868.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.24s/it]100%|##########| 2/2 [00:02<00:00,  1.23s/it]100%|##########| 2/2 [00:02<00:00,  1.38s/it]
[I 2025-05-23 20:46:13,930] Trial 8 finished with value: 130.72190528078465 and parameters: {'changepoint_prior_scale': 0.04966665810377876, 'seasonality_prior_scale': 3.116903156179005, 'n_changepoints': 36}. Best is trial 4 with value: 96.52596302781868.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.00it/s]100%|##########| 2/2 [00:01<00:00,  1.38it/s]100%|##########| 2/2 [00:01<00:00,  1.31it/s]
[I 2025-05-23 20:46:16,393] Trial 9 finished with value: 86.5233167255843 and parameters: {'changepoint_prior_scale': 0.002582333065248864, 'seasonality_prior_scale': 0.010717834279108267, 'n_changepoints': 7}. Best is trial 9 with value: 86.5233167255843.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.03s/it]100%|##########| 2/2 [00:01<00:00,  1.38it/s]100%|##########| 2/2 [00:01<00:00,  1.29it/s]
Rendimiento para la combinación BMX_6-BMX_HOGAR-BMX_3931:
  horizon          mse       rmse  ...     mdape     smape  coverage
0 21 days  4527.005795  67.283028  ...  4.456994  1.275169  0.666667
1 28 days  6625.326929  81.396111  ...  4.471774  1.386125  0.500000
2 35 days  8221.720004  90.673701  ...  4.471774  1.409604  0.333333
3 42 days  8779.243691  93.697618  ...  6.375627  1.459398  0.333333
4 49 days  8773.075503  93.664697  ...  6.382400  1.469609  0.333333

[5 rows x 8 columns]
          ds       yhat  yhat_lower  yhat_upper      y     cutoff
0 2022-10-24  55.559644   -3.237595  117.017736  4.000 2022-10-17
1 2022-10-31  61.440832    2.409441  124.928647  3.000 2022-10-17
2 2022-11-07  46.093000  -15.622222  106.745523  5.000 2022-10-17
3 2022-11-14  48.188815  -13.074962  110.786705  2.000 2022-10-17
4 2022-11-21  91.022689   31.399837  155.537397  6.996 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds        y  day_of_week  week_of_year  month
0   2021-01-04  280.001            0             1      1
1   2021-01-11  261.020            0             2      1
2   2021-01-18  289.896            0             3      1
3   2021-01-25  281.972            0             4      1
4   2021-02-01  303.061            0             5      2
..         ...      ...          ...           ...    ...
151 2023-11-27  369.991            0            48     11
152 2023-12-04  455.980            0            49     12
153 2023-12-11  426.982            0            50     12
154 2023-12-18  384.993            0            51     12
155 2023-12-25  296.000            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:46:18,926] A new study created in memory with name: no-name-de036882-806f-4ab9-b7f9-c6801e1257c1
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.50s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.83s/it]100%|##########| 2/2 [00:03<00:00,  1.78s/it]
[I 2025-05-23 20:46:25,032] Trial 0 finished with value: 55.45623793687955 and parameters: {'changepoint_prior_scale': 0.005935428034413579, 'seasonality_prior_scale': 0.05229147032053731, 'n_changepoints': 46}. Best is trial 0 with value: 55.45623793687955.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.72s/it]100%|##########| 2/2 [00:02<00:00,  1.15s/it]100%|##########| 2/2 [00:02<00:00,  1.24s/it]
[I 2025-05-23 20:46:28,358] Trial 1 finished with value: 56.20602899144473 and parameters: {'changepoint_prior_scale': 0.02179052674013858, 'seasonality_prior_scale': 0.9940565603628746, 'n_changepoints': 42}. Best is trial 0 with value: 55.45623793687955.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.83s/it]100%|##########| 2/2 [00:02<00:00,  1.10s/it]100%|##########| 2/2 [00:02<00:00,  1.21s/it]
[I 2025-05-23 20:46:33,338] Trial 2 finished with value: 61.964619883927895 and parameters: {'changepoint_prior_scale': 0.008448459796833237, 'seasonality_prior_scale': 5.996362766705564, 'n_changepoints': 47}. Best is trial 0 with value: 55.45623793687955.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.48s/it]100%|##########| 2/2 [00:04<00:00,  1.79s/it]100%|##########| 2/2 [00:04<00:00,  2.05s/it]
[I 2025-05-23 20:46:38,295] Trial 3 finished with value: 78.58614367717443 and parameters: {'changepoint_prior_scale': 0.19020785059466983, 'seasonality_prior_scale': 1.1629633988607944, 'n_changepoints': 42}. Best is trial 0 with value: 55.45623793687955.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.25s/it]100%|##########| 2/2 [00:01<00:00,  1.18it/s]100%|##########| 2/2 [00:01<00:00,  1.10it/s]
[I 2025-05-23 20:46:41,860] Trial 4 finished with value: 53.89247180408481 and parameters: {'changepoint_prior_scale': 0.0056629589708338535, 'seasonality_prior_scale': 0.023667441072308178, 'n_changepoints': 27}. Best is trial 4 with value: 53.89247180408481.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.42s/it]100%|##########| 2/2 [00:03<00:00,  1.40s/it]100%|##########| 2/2 [00:03<00:00,  1.55s/it]
[I 2025-05-23 20:46:45,814] Trial 5 finished with value: 57.63235617971893 and parameters: {'changepoint_prior_scale': 0.04922478834155114, 'seasonality_prior_scale': 1.0842974237210066, 'n_changepoints': 39}. Best is trial 4 with value: 53.89247180408481.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.87s/it]100%|##########| 2/2 [00:04<00:00,  2.15s/it]100%|##########| 2/2 [00:04<00:00,  2.41s/it]
[I 2025-05-23 20:46:52,041] Trial 6 finished with value: 90.04880780411176 and parameters: {'changepoint_prior_scale': 0.4167671380947781, 'seasonality_prior_scale': 0.33125273826032847, 'n_changepoints': 32}. Best is trial 4 with value: 53.89247180408481.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.02it/s]100%|##########| 2/2 [00:01<00:00,  1.28it/s]100%|##########| 2/2 [00:01<00:00,  1.23it/s]
[I 2025-05-23 20:46:54,788] Trial 7 finished with value: 55.62699881915172 and parameters: {'changepoint_prior_scale': 0.007707596427888853, 'seasonality_prior_scale': 0.1429298051251863, 'n_changepoints': 9}. Best is trial 4 with value: 53.89247180408481.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.89s/it]100%|##########| 2/2 [00:04<00:00,  1.97s/it]100%|##########| 2/2 [00:04<00:00,  2.26s/it]
[I 2025-05-23 20:47:00,329] Trial 8 finished with value: 104.19769964299843 and parameters: {'changepoint_prior_scale': 0.41121695412823506, 'seasonality_prior_scale': 0.019229581557858345, 'n_changepoints': 46}. Best is trial 4 with value: 53.89247180408481.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.24s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.22s/it]100%|##########| 2/2 [00:02<00:00,  1.22s/it]
[I 2025-05-23 20:47:04,525] Trial 9 finished with value: 59.16448304988394 and parameters: {'changepoint_prior_scale': 0.001408013604775628, 'seasonality_prior_scale': 0.8806628392025333, 'n_changepoints': 14}. Best is trial 4 with value: 53.89247180408481.
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.05s/it]100%|##########| 2/2 [00:01<00:00,  1.18it/s]100%|##########| 2/2 [00:01<00:00,  1.14it/s]
Rendimiento para la combinación BMX_6-BMX_HOGAR-BMX_3203:
  horizon          mse       rmse  ...     mdape     smape  coverage
0 21 days  7742.646238  87.992308  ...  0.218027  0.191578  0.333333
1 28 days  6981.726856  83.556728  ...  0.201618  0.187085  0.166667
2 35 days  5694.017008  75.458711  ...  0.175989  0.173309  0.166667
3 42 days  4356.692615  66.005247  ...  0.141861  0.146971  0.166667
4 49 days  3061.259096  55.328646  ...  0.112812  0.114615  0.500000

[5 rows x 8 columns]
          ds        yhat  yhat_lower  yhat_upper        y     cutoff
0 2022-10-24  400.156489  355.243221  446.145504  427.007 2022-10-17
1 2022-10-31  363.661300  319.049393  408.572026  478.014 2022-10-17
2 2022-11-07  381.010731  332.682961  428.356468  412.013 2022-10-17
3 2022-11-14  386.059551  342.757018  431.431614  320.008 2022-10-17
4 2022-11-21  400.709414  354.101244  446.979044  320.012 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds         y  day_of_week  week_of_year  month
0   2021-01-04   775.000            0             1      1
1   2021-01-11   550.000            0             2      1
2   2021-01-18   716.000            0             3      1
3   2021-01-25   804.000            0             4      1
4   2021-02-01   801.000            0             5      2
..         ...       ...          ...           ...    ...
151 2023-11-27  1079.000            0            48     11
152 2023-12-04  1331.958            0            49     12
153 2023-12-11  1286.958            0            50     12
154 2023-12-18  1399.000            0            51     12
155 2023-12-25  1073.958            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:47:08,112] A new study created in memory with name: no-name-e331ab35-d71e-43aa-8874-fb381b89b973
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.50s/it]100%|##########| 2/2 [00:03<00:00,  1.52s/it]100%|##########| 2/2 [00:03<00:00,  1.66s/it]
[I 2025-05-23 20:47:12,443] Trial 0 finished with value: 417.1450315990684 and parameters: {'changepoint_prior_scale': 0.17729759670050182, 'seasonality_prior_scale': 0.01697424540610129, 'n_changepoints': 40}. Best is trial 0 with value: 417.1450315990684.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.18s/it]100%|##########| 2/2 [00:02<00:00,  1.02it/s]100%|##########| 2/2 [00:02<00:00,  1.01s/it]
[I 2025-05-23 20:47:15,514] Trial 1 finished with value: 330.85648457838084 and parameters: {'changepoint_prior_scale': 0.10524364390015263, 'seasonality_prior_scale': 0.33366053179552674, 'n_changepoints': 13}. Best is trial 1 with value: 330.85648457838084.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.29s/it]100%|##########| 2/2 [00:03<00:00,  1.70s/it]100%|##########| 2/2 [00:03<00:00,  1.94s/it]
[I 2025-05-23 20:47:20,623] Trial 2 finished with value: 346.55235333170737 and parameters: {'changepoint_prior_scale': 0.08886578520282556, 'seasonality_prior_scale': 0.04643225512318318, 'n_changepoints': 45}. Best is trial 1 with value: 330.85648457838084.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.35s/it]100%|##########| 2/2 [00:01<00:00,  1.17it/s]100%|##########| 2/2 [00:01<00:00,  1.08it/s]
[I 2025-05-23 20:47:23,611] Trial 3 finished with value: 447.2302599312438 and parameters: {'changepoint_prior_scale': 0.16223966365903894, 'seasonality_prior_scale': 1.5841957890993463, 'n_changepoints': 17}. Best is trial 1 with value: 330.85648457838084.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.63s/it]100%|##########| 2/2 [00:02<00:00,  1.06s/it]100%|##########| 2/2 [00:02<00:00,  1.15s/it]
[I 2025-05-23 20:47:26,830] Trial 4 finished with value: 336.73102367477645 and parameters: {'changepoint_prior_scale': 0.05057756760107908, 'seasonality_prior_scale': 0.9902246075997593, 'n_changepoints': 27}. Best is trial 1 with value: 330.85648457838084.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.09s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.25s/it]100%|##########| 2/2 [00:02<00:00,  1.22s/it]
[I 2025-05-23 20:47:31,375] Trial 5 finished with value: 300.28174894091126 and parameters: {'changepoint_prior_scale': 0.0013742382192972928, 'seasonality_prior_scale': 0.01998969770227653, 'n_changepoints': 36}. Best is trial 5 with value: 300.28174894091126.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.15s/it]100%|##########| 2/2 [00:01<00:00,  1.20it/s]100%|##########| 2/2 [00:01<00:00,  1.14it/s]
[I 2025-05-23 20:47:34,024] Trial 6 finished with value: 297.99312550572256 and parameters: {'changepoint_prior_scale': 0.012980065614897158, 'seasonality_prior_scale': 0.018800136621887096, 'n_changepoints': 37}. Best is trial 6 with value: 297.99312550572256.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.53s/it]100%|##########| 2/2 [00:02<00:00,  1.02s/it]100%|##########| 2/2 [00:02<00:00,  1.10s/it]
[I 2025-05-23 20:47:37,009] Trial 7 finished with value: 311.5010492165807 and parameters: {'changepoint_prior_scale': 0.02821224555084769, 'seasonality_prior_scale': 0.016631702723782917, 'n_changepoints': 25}. Best is trial 6 with value: 297.99312550572256.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.18s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.33s/it]100%|##########| 2/2 [00:02<00:00,  1.31s/it]
[I 2025-05-23 20:47:41,911] Trial 8 finished with value: 301.84717031065725 and parameters: {'changepoint_prior_scale': 0.0018433965210550272, 'seasonality_prior_scale': 0.28506058499399733, 'n_changepoints': 38}. Best is trial 6 with value: 297.99312550572256.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.19s/it]100%|##########| 2/2 [00:01<00:00,  1.05it/s]100%|##########| 2/2 [00:01<00:00,  1.02it/s]
[I 2025-05-23 20:47:44,834] Trial 9 finished with value: 317.20687816492307 and parameters: {'changepoint_prior_scale': 0.03140819008275018, 'seasonality_prior_scale': 0.1649587228952976, 'n_changepoints': 12}. Best is trial 6 with value: 297.99312550572256.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.30s/it]100%|##########| 2/2 [00:01<00:00,  1.17it/s]100%|##########| 2/2 [00:01<00:00,  1.09it/s]
Rendimiento para la combinación BMX_6-BMX_OXXO-BMX_3001:
  horizon            mse        rmse  ...     mdape     smape  coverage
0 21 days   74949.801134  273.769613  ...  0.210400  0.166428  0.500000
1 28 days   78787.400870  280.690935  ...  0.242552  0.185843  0.500000
2 35 days  163587.247156  404.459203  ...  0.333765  0.303037  0.333333
3 42 days  237742.901067  487.588865  ...  0.418756  0.382108  0.166667
4 49 days  278641.354119  527.864901  ...  0.427625  0.396906  0.000000

[5 rows x 8 columns]
          ds         yhat   yhat_lower   yhat_upper         y     cutoff
0 2022-10-24  1242.877483  1027.514115  1454.214481  1112.874 2022-10-17
1 2022-10-31  1087.085528   874.320934  1305.644149  1063.917 2022-10-17
2 2022-11-07  1159.675101   951.678054  1375.310908  1182.000 2022-10-17
3 2022-11-14  1200.146323   987.142754  1413.516101   851.958 2022-10-17
4 2022-11-21  1329.392727  1112.842649  1537.923628   624.000 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds     y  day_of_week  week_of_year  month
0   2021-01-04  67.0            0             1      1
1   2021-01-11  40.0            0             2      1
2   2021-01-18  26.0            0             3      1
3   2021-01-25  38.0            0             4      1
4   2021-02-01  34.0            0             5      2
..         ...   ...          ...           ...    ...
151 2023-11-27  43.0            0            48     11
152 2023-12-04  53.0            0            49     12
153 2023-12-11  52.0            0            50     12
154 2023-12-18  59.0            0            51     12
155 2023-12-25  36.0            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:47:47,571] A new study created in memory with name: no-name-9a142cf1-c532-4ef7-84e7-98185f632150
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.03it/s]100%|##########| 2/2 [00:01<00:00,  1.36it/s]100%|##########| 2/2 [00:01<00:00,  1.30it/s]
[I 2025-05-23 20:47:50,021] Trial 0 finished with value: 22.42606691368398 and parameters: {'changepoint_prior_scale': 0.0035351506689576344, 'seasonality_prior_scale': 0.03215167269092727, 'n_changepoints': 7}. Best is trial 0 with value: 22.42606691368398.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.23s/it]100%|##########| 2/2 [00:01<00:00,  1.09it/s]100%|##########| 2/2 [00:01<00:00,  1.03it/s]
[I 2025-05-23 20:47:52,850] Trial 1 finished with value: 23.702396201400767 and parameters: {'changepoint_prior_scale': 0.21806621799196604, 'seasonality_prior_scale': 0.17675018308836898, 'n_changepoints': 11}. Best is trial 0 with value: 22.42606691368398.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.22s/it]100%|##########| 2/2 [00:01<00:00,  1.08it/s]100%|##########| 2/2 [00:01<00:00,  1.03it/s]
[I 2025-05-23 20:47:55,764] Trial 2 finished with value: 22.534380739640206 and parameters: {'changepoint_prior_scale': 0.0012852256000348854, 'seasonality_prior_scale': 0.022029133432660032, 'n_changepoints': 9}. Best is trial 0 with value: 22.42606691368398.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.02it/s]100%|##########| 2/2 [00:01<00:00,  1.29it/s]100%|##########| 2/2 [00:01<00:00,  1.24it/s]
[I 2025-05-23 20:47:58,229] Trial 3 finished with value: 25.520473152703826 and parameters: {'changepoint_prior_scale': 0.004567448622888095, 'seasonality_prior_scale': 7.62297589814895, 'n_changepoints': 20}. Best is trial 0 with value: 22.42606691368398.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.20it/s]100%|##########| 2/2 [00:01<00:00,  1.37it/s]100%|##########| 2/2 [00:01<00:00,  1.34it/s]
[I 2025-05-23 20:48:00,608] Trial 4 finished with value: 23.302694010297394 and parameters: {'changepoint_prior_scale': 0.0035524364334767835, 'seasonality_prior_scale': 0.2637464707627172, 'n_changepoints': 5}. Best is trial 0 with value: 22.42606691368398.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.09s/it]100%|##########| 2/2 [00:01<00:00,  1.18it/s]100%|##########| 2/2 [00:01<00:00,  1.13it/s]
[I 2025-05-23 20:48:03,508] Trial 5 finished with value: 23.76018807712801 and parameters: {'changepoint_prior_scale': 0.0039028375945506927, 'seasonality_prior_scale': 0.05058518189047361, 'n_changepoints': 16}. Best is trial 0 with value: 22.42606691368398.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.14s/it]100%|##########| 2/2 [00:01<00:00,  1.18it/s]100%|##########| 2/2 [00:01<00:00,  1.12it/s]
[I 2025-05-23 20:48:06,131] Trial 6 finished with value: 22.211307802546695 and parameters: {'changepoint_prior_scale': 0.02399255538638321, 'seasonality_prior_scale': 0.12540622193333026, 'n_changepoints': 12}. Best is trial 6 with value: 22.211307802546695.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.09s/it]100%|##########| 2/2 [00:01<00:00,  1.19it/s]100%|##########| 2/2 [00:01<00:00,  1.14it/s]
[I 2025-05-23 20:48:08,882] Trial 7 finished with value: 25.25301680922093 and parameters: {'changepoint_prior_scale': 0.0019649418297452335, 'seasonality_prior_scale': 0.06338603083250917, 'n_changepoints': 21}. Best is trial 6 with value: 22.211307802546695.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.44s/it]100%|##########| 2/2 [00:02<00:00,  1.04it/s]100%|##########| 2/2 [00:02<00:00,  1.03s/it]
[I 2025-05-23 20:48:11,977] Trial 8 finished with value: 21.99169920903879 and parameters: {'changepoint_prior_scale': 0.03615584476769003, 'seasonality_prior_scale': 0.03974878012342715, 'n_changepoints': 31}. Best is trial 8 with value: 21.99169920903879.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.23it/s]100%|##########| 2/2 [00:01<00:00,  1.36it/s]100%|##########| 2/2 [00:01<00:00,  1.33it/s]
[I 2025-05-23 20:48:14,463] Trial 9 finished with value: 23.02985573716647 and parameters: {'changepoint_prior_scale': 0.008668083489477278, 'seasonality_prior_scale': 2.173011752651401, 'n_changepoints': 8}. Best is trial 8 with value: 21.99169920903879.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.52s/it]100%|##########| 2/2 [00:02<00:00,  1.01it/s]100%|##########| 2/2 [00:02<00:00,  1.07s/it]
Rendimiento para la combinación BMX_6-BMX_OXXO-BMX_3207:
  horizon         mse       rmse  ...     mdape     smape  coverage
0 21 days  156.740182  12.519592  ...  0.309418  0.309700  0.666667
1 28 days   82.428586   9.079019  ...  0.168157  0.190166  0.833333
2 35 days  159.572188  12.632189  ...  0.296631  0.265834  0.666667
3 42 days  389.353511  19.732043  ...  0.529026  0.365663  0.500000
4 49 days  667.779928  25.841438  ...  0.673328  0.557261  0.166667

[5 rows x 8 columns]
          ds       yhat  yhat_lower  yhat_upper     y     cutoff
0 2022-10-24  43.407126   26.339408   59.818346  25.0 2022-10-17
1 2022-10-31  26.950612    9.577895   45.080106  33.0 2022-10-17
2 2022-11-07  23.508944    7.861769   40.246023  42.0 2022-10-17
3 2022-11-14  32.076954   16.495981   47.397799  32.0 2022-10-17
4 2022-11-21  34.922703   19.803030   51.364804  23.0 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds       y  day_of_week  week_of_year  month
0   2021-01-04  13.000            0             1      1
1   2021-01-11  10.000            0             2      1
2   2021-01-18   5.000            0             3      1
3   2021-01-25  22.000            0             4      1
4   2021-02-01  10.000            0             5      2
..         ...     ...          ...           ...    ...
151 2023-11-27   6.000            0            48     11
152 2023-12-04   5.000            0            49     12
153 2023-12-11   5.000            0            50     12
154 2023-12-18   8.917            0            51     12
155 2023-12-25   7.000            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:48:17,586] A new study created in memory with name: no-name-1cb4f4e8-8118-4315-a5aa-1aa5fda3fd4f
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.24s/it]100%|##########| 2/2 [00:01<00:00,  1.21it/s]100%|##########| 2/2 [00:01<00:00,  1.13it/s]
[I 2025-05-23 20:48:20,148] Trial 0 finished with value: 6.9690087135745395 and parameters: {'changepoint_prior_scale': 0.002533375559572095, 'seasonality_prior_scale': 3.254616887237636, 'n_changepoints': 29}. Best is trial 0 with value: 6.9690087135745395.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.29s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.56s/it]100%|##########| 2/2 [00:03<00:00,  1.52s/it]
[I 2025-05-23 20:48:25,101] Trial 1 finished with value: 7.157190903615693 and parameters: {'changepoint_prior_scale': 0.003398410639886359, 'seasonality_prior_scale': 1.5079729279217393, 'n_changepoints': 46}. Best is trial 0 with value: 6.9690087135745395.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.54s/it]100%|##########| 2/2 [00:03<00:00,  1.41s/it]100%|##########| 2/2 [00:03<00:00,  1.58s/it]
[I 2025-05-23 20:48:29,099] Trial 2 finished with value: 7.334965378346667 and parameters: {'changepoint_prior_scale': 0.2068509690782, 'seasonality_prior_scale': 2.749307833572917, 'n_changepoints': 36}. Best is trial 0 with value: 6.9690087135745395.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.44s/it]100%|##########| 2/2 [00:01<00:00,  1.10it/s]100%|##########| 2/2 [00:01<00:00,  1.01it/s]
[I 2025-05-23 20:48:31,913] Trial 3 finished with value: 6.827981781937688 and parameters: {'changepoint_prior_scale': 0.003912902049901156, 'seasonality_prior_scale': 0.2010012780767124, 'n_changepoints': 31}. Best is trial 3 with value: 6.827981781937688.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.38s/it]100%|##########| 2/2 [00:02<00:00,  1.04it/s]100%|##########| 2/2 [00:02<00:00,  1.03s/it]
[I 2025-05-23 20:48:34,658] Trial 4 finished with value: 6.951240309879093 and parameters: {'changepoint_prior_scale': 0.02093196931489351, 'seasonality_prior_scale': 1.543314558632058, 'n_changepoints': 40}. Best is trial 3 with value: 6.827981781937688.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.66s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:04<00:00,  2.23s/it]100%|##########| 2/2 [00:04<00:00,  2.45s/it]
[I 2025-05-23 20:48:41,791] Trial 5 finished with value: 6.340950481084178 and parameters: {'changepoint_prior_scale': 0.001671533882563511, 'seasonality_prior_scale': 0.030506561606433343, 'n_changepoints': 29}. Best is trial 5 with value: 6.340950481084178.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.05it/s]100%|##########| 2/2 [00:01<00:00,  1.16it/s]100%|##########| 2/2 [00:01<00:00,  1.15it/s]
[I 2025-05-23 20:48:44,970] Trial 6 finished with value: 6.9565043049817055 and parameters: {'changepoint_prior_scale': 0.011169912479339525, 'seasonality_prior_scale': 0.804234403766902, 'n_changepoints': 14}. Best is trial 5 with value: 6.340950481084178.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.38s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  2.04s/it]100%|##########| 2/2 [00:03<00:00,  1.94s/it]
[I 2025-05-23 20:48:53,112] Trial 7 finished with value: 5.651372352436163 and parameters: {'changepoint_prior_scale': 0.0011929853346752044, 'seasonality_prior_scale': 0.010175408090905266, 'n_changepoints': 41}. Best is trial 7 with value: 5.651372352436163.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.43s/it]100%|##########| 2/2 [00:02<00:00,  1.12s/it]100%|##########| 2/2 [00:02<00:00,  1.17s/it]
[I 2025-05-23 20:48:56,352] Trial 8 finished with value: 6.933196591691035 and parameters: {'changepoint_prior_scale': 0.04402108124811636, 'seasonality_prior_scale': 0.42644790105842506, 'n_changepoints': 19}. Best is trial 7 with value: 5.651372352436163.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.93s/it]100%|##########| 2/2 [00:02<00:00,  1.18s/it]100%|##########| 2/2 [00:02<00:00,  1.30s/it]
[I 2025-05-23 20:48:59,649] Trial 9 finished with value: 5.40168612466032 and parameters: {'changepoint_prior_scale': 0.06552385382284485, 'seasonality_prior_scale': 0.011687136369497595, 'n_changepoints': 47}. Best is trial 9 with value: 5.40168612466032.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.02s/it]100%|##########| 2/2 [00:02<00:00,  1.25s/it]100%|##########| 2/2 [00:02<00:00,  1.36s/it]
Rendimiento para la combinación BMX_6-BMX_OXXO-BMX_3931:
  horizon        mse      rmse  ...     mdape     smape  coverage
0 21 days  27.816412  5.274127  ...  0.195034  0.416549  0.666667
1 28 days  19.624549  4.429960  ...  0.377251  0.446838  0.666667
2 35 days  61.185130  7.822092  ...  0.522526  0.766658  0.333333
3 42 days  86.344917  9.292197  ...  0.522526  0.867343  0.333333
4 49 days  91.011505  9.539995  ...  0.564227  0.843195  0.333333

[5 rows x 8 columns]
          ds      yhat  yhat_lower  yhat_upper     y     cutoff
0 2022-10-24  4.694274   -0.486267    9.872920  14.0 2022-10-17
1 2022-10-31  4.388203   -1.083646    9.793518   4.0 2022-10-17
2 2022-11-07  4.365933   -0.887334    9.275814  13.0 2022-10-17
3 2022-11-14  4.164323   -0.972859    9.197334  10.0 2022-10-17
4 2022-11-21  0.991173   -4.457938    6.094805  16.0 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds          y  day_of_week  week_of_year  month
0   2021-01-04  12034.000            0             1      1
1   2021-01-11   9554.250            0             2      1
2   2021-01-18  10778.000            0             3      1
3   2021-01-25  12053.000            0             4      1
4   2021-02-01  11818.000            0             5      2
..         ...        ...          ...           ...    ...
151 2023-11-27  12813.288            0            48     11
152 2023-12-04  14816.497            0            49     12
153 2023-12-11  15064.622            0            50     12
154 2023-12-18  16614.874            0            51     12
155 2023-12-25  11658.375            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:49:03,496] A new study created in memory with name: no-name-cb3bdd16-5fde-46c7-8ff6-4493156c3d09
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.05s/it]100%|##########| 2/2 [00:02<00:00,  1.36s/it]100%|##########| 2/2 [00:02<00:00,  1.47s/it]
[I 2025-05-23 20:49:07,310] Trial 0 finished with value: 2167.057643080453 and parameters: {'changepoint_prior_scale': 0.02088063522905516, 'seasonality_prior_scale': 2.618873836136829, 'n_changepoints': 45}. Best is trial 0 with value: 2167.057643080453.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.46s/it]100%|##########| 2/2 [00:03<00:00,  1.40s/it]100%|##########| 2/2 [00:03<00:00,  1.56s/it]
[I 2025-05-23 20:49:12,594] Trial 1 finished with value: 6588.768692271143 and parameters: {'changepoint_prior_scale': 0.0016055961011752404, 'seasonality_prior_scale': 0.08237485934470222, 'n_changepoints': 37}. Best is trial 0 with value: 2167.057643080453.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.08it/s]100%|##########| 2/2 [00:01<00:00,  1.23it/s]100%|##########| 2/2 [00:01<00:00,  1.20it/s]
[I 2025-05-23 20:49:15,877] Trial 2 finished with value: 1871.3432033590004 and parameters: {'changepoint_prior_scale': 0.0019081385242848213, 'seasonality_prior_scale': 0.11115239025322986, 'n_changepoints': 7}. Best is trial 2 with value: 1871.3432033590004.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.31s/it]100%|##########| 2/2 [00:01<00:00,  1.10it/s]100%|##########| 2/2 [00:01<00:00,  1.03it/s]
[I 2025-05-23 20:49:20,427] Trial 3 finished with value: 3547.1956213650105 and parameters: {'changepoint_prior_scale': 0.0020279794884601166, 'seasonality_prior_scale': 0.015158540576498769, 'n_changepoints': 25}. Best is trial 2 with value: 1871.3432033590004.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.90s/it]100%|##########| 2/2 [00:03<00:00,  1.55s/it]100%|##########| 2/2 [00:03<00:00,  1.75s/it]
[I 2025-05-23 20:49:24,990] Trial 4 finished with value: 1492.424268491362 and parameters: {'changepoint_prior_scale': 0.05670801982356575, 'seasonality_prior_scale': 0.3416226190282042, 'n_changepoints': 47}. Best is trial 4 with value: 1492.424268491362.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.16s/it]100%|##########| 2/2 [00:01<00:00,  1.15it/s]100%|##########| 2/2 [00:01<00:00,  1.10it/s]
[I 2025-05-23 20:49:28,553] Trial 5 finished with value: 2005.4732790958954 and parameters: {'changepoint_prior_scale': 0.0030590477847480617, 'seasonality_prior_scale': 0.3324012026100237, 'n_changepoints': 16}. Best is trial 4 with value: 1492.424268491362.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:04<00:04,  4.98s/it]100%|##########| 2/2 [00:05<00:00,  2.53s/it]100%|##########| 2/2 [00:05<00:00,  2.90s/it]
[I 2025-05-23 20:49:35,304] Trial 6 finished with value: 1707.2987263673656 and parameters: {'changepoint_prior_scale': 0.3417267081111846, 'seasonality_prior_scale': 1.5013372541089667, 'n_changepoints': 45}. Best is trial 4 with value: 1492.424268491362.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.99s/it]100%|##########| 2/2 [00:03<00:00,  1.63s/it]100%|##########| 2/2 [00:03<00:00,  1.84s/it]
[I 2025-05-23 20:49:40,004] Trial 7 finished with value: 1570.8834885401327 and parameters: {'changepoint_prior_scale': 0.13184978146230952, 'seasonality_prior_scale': 1.014223799799962, 'n_changepoints': 32}. Best is trial 4 with value: 1492.424268491362.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.54s/it]100%|##########| 2/2 [00:02<00:00,  1.07s/it]100%|##########| 2/2 [00:02<00:00,  1.14s/it]
[I 2025-05-23 20:49:43,575] Trial 8 finished with value: 2530.4771613436856 and parameters: {'changepoint_prior_scale': 0.012401031123827953, 'seasonality_prior_scale': 8.868358584802538, 'n_changepoints': 17}. Best is trial 4 with value: 1492.424268491362.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.27s/it]100%|##########| 2/2 [00:01<00:00,  1.05it/s]100%|##########| 2/2 [00:01<00:00,  1.00it/s]
[I 2025-05-23 20:49:46,467] Trial 9 finished with value: 2009.6444252443905 and parameters: {'changepoint_prior_scale': 0.10906235413912951, 'seasonality_prior_scale': 7.9214436144872, 'n_changepoints': 8}. Best is trial 4 with value: 1492.424268491362.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.86s/it]100%|##########| 2/2 [00:03<00:00,  1.71s/it]100%|##########| 2/2 [00:03<00:00,  1.88s/it]
Rendimiento para la combinación BMX_6-BMX_TRADICIONAL-BMX_3001:
  horizon           mse         rmse  ...     mdape     smape  coverage
0 21 days  1.247747e+06  1117.026057  ...  0.067772  0.060710  0.500000
1 28 days  1.150472e+06  1072.600618  ...  0.067772  0.056611  0.500000
2 35 days  5.495901e+06  2344.333911  ...  0.081349  0.108635  0.333333
3 42 days  5.964043e+06  2442.138927  ...  0.100926  0.118774  0.333333
4 49 days  5.758861e+06  2399.762737  ...  0.075966  0.109594  0.500000

[5 rows x 8 columns]
          ds          yhat    yhat_lower    yhat_upper          y     cutoff
0 2022-10-24  16738.368964  15773.261055  17747.589607  15598.036 2022-10-17
1 2022-10-31  15330.958444  14317.077093  16321.106213  15388.371 2022-10-17
2 2022-11-07  15196.348624  14224.884934  16125.290710  16301.405 2022-10-17
3 2022-11-14  15005.816041  14085.966102  15975.699726  13705.078 2022-10-17
4 2022-11-21  16463.918649  15499.496364  17339.528285  11232.203 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds       y  day_of_week  week_of_year  month
0   2021-01-04   542.0            0             1      1
1   2021-01-11   438.0            0             2      1
2   2021-01-18   447.0            0             3      1
3   2021-01-25   434.0            0             4      1
4   2021-02-01   464.0            0             5      2
..         ...     ...          ...           ...    ...
151 2023-11-27   848.0            0            48     11
152 2023-12-04  1019.0            0            49     12
153 2023-12-11   991.0            0            50     12
154 2023-12-18  1047.0            0            51     12
155 2023-12-25   874.0            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:49:51,595] A new study created in memory with name: no-name-b9322428-45c0-47fb-932c-7e6d2abd29f6
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.94s/it]100%|##########| 2/2 [00:03<00:00,  1.66s/it]100%|##########| 2/2 [00:03<00:00,  1.85s/it]
[I 2025-05-23 20:49:56,723] Trial 0 finished with value: 106.50055265516309 and parameters: {'changepoint_prior_scale': 0.12912222723216413, 'seasonality_prior_scale': 0.7669506119621194, 'n_changepoints': 23}. Best is trial 0 with value: 106.50055265516309.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.85s/it]100%|##########| 2/2 [00:03<00:00,  1.68s/it]100%|##########| 2/2 [00:03<00:00,  1.86s/it]
[I 2025-05-23 20:50:01,679] Trial 1 finished with value: 111.92126197110662 and parameters: {'changepoint_prior_scale': 0.2040013666558522, 'seasonality_prior_scale': 0.4874214989873784, 'n_changepoints': 13}. Best is trial 0 with value: 106.50055265516309.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.52s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:04<00:00,  2.15s/it]100%|##########| 2/2 [00:04<00:00,  2.20s/it]
[I 2025-05-23 20:50:10,126] Trial 2 finished with value: 189.71639887348553 and parameters: {'changepoint_prior_scale': 0.0012669282830862537, 'seasonality_prior_scale': 7.097414315250868, 'n_changepoints': 40}. Best is trial 0 with value: 106.50055265516309.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.00s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.99s/it]100%|##########| 2/2 [00:03<00:00,  1.99s/it]
[I 2025-05-23 20:50:16,443] Trial 3 finished with value: 170.3064645181766 and parameters: {'changepoint_prior_scale': 0.001888883288689088, 'seasonality_prior_scale': 0.024318718192008888, 'n_changepoints': 33}. Best is trial 0 with value: 106.50055265516309.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.03s/it]100%|##########| 2/2 [00:02<00:00,  1.20s/it]100%|##########| 2/2 [00:02<00:00,  1.32s/it]
[I 2025-05-23 20:50:19,994] Trial 4 finished with value: 113.2616152497531 and parameters: {'changepoint_prior_scale': 0.021566295591395467, 'seasonality_prior_scale': 0.03274233647634205, 'n_changepoints': 20}. Best is trial 0 with value: 106.50055265516309.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.52s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.57s/it]100%|##########| 2/2 [00:03<00:00,  1.57s/it]
[I 2025-05-23 20:50:25,318] Trial 5 finished with value: 170.84155317365153 and parameters: {'changepoint_prior_scale': 0.0018356146402165692, 'seasonality_prior_scale': 0.012416009771365989, 'n_changepoints': 45}. Best is trial 0 with value: 106.50055265516309.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.73s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.69s/it]100%|##########| 2/2 [00:03<00:00,  1.70s/it]
[I 2025-05-23 20:50:30,727] Trial 6 finished with value: 194.02417259149587 and parameters: {'changepoint_prior_scale': 0.0011982055965477937, 'seasonality_prior_scale': 6.328319858562489, 'n_changepoints': 42}. Best is trial 0 with value: 106.50055265516309.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.69s/it]100%|##########| 2/2 [00:02<00:00,  1.13s/it]100%|##########| 2/2 [00:02<00:00,  1.22s/it]
[I 2025-05-23 20:50:34,109] Trial 7 finished with value: 93.64584201191325 and parameters: {'changepoint_prior_scale': 0.07837281946704538, 'seasonality_prior_scale': 0.02459623537622724, 'n_changepoints': 26}. Best is trial 7 with value: 93.64584201191325.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.15s/it]100%|##########| 2/2 [00:02<00:00,  1.34s/it]100%|##########| 2/2 [00:02<00:00,  1.46s/it]
[I 2025-05-23 20:50:38,091] Trial 8 finished with value: 110.31086218183644 and parameters: {'changepoint_prior_scale': 0.06555066657013764, 'seasonality_prior_scale': 5.076405226588564, 'n_changepoints': 29}. Best is trial 7 with value: 93.64584201191325.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.06s/it]100%|##########| 2/2 [00:01<00:00,  1.29it/s]100%|##########| 2/2 [00:01<00:00,  1.23it/s]
[I 2025-05-23 20:50:40,626] Trial 9 finished with value: 163.28887022536128 and parameters: {'changepoint_prior_scale': 0.00489036405428539, 'seasonality_prior_scale': 0.2721696790268872, 'n_changepoints': 7}. Best is trial 7 with value: 93.64584201191325.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.80s/it]100%|##########| 2/2 [00:02<00:00,  1.12s/it]100%|##########| 2/2 [00:02<00:00,  1.22s/it]
Rendimiento para la combinación BMX_6-BMX_TRADICIONAL-BMX_3207:
  horizon          mse       rmse  ...     mdape     smape  coverage
0 21 days  3069.479498  55.402883  ...  0.051824  0.050440  0.500000
1 28 days  1982.261353  44.522594  ...  0.037434  0.038919  0.666667
2 35 days  4158.498870  64.486424  ...  0.067493  0.059820  0.333333
3 42 days  6945.515924  83.339762  ...  0.078909  0.075194  0.333333
4 49 days  7104.255107  84.286743  ...  0.078909  0.075854  0.333333

[5 rows x 8 columns]
          ds         yhat  yhat_lower   yhat_upper        y     cutoff
0 2022-10-24   977.639222  931.654980  1025.321688  897.833 2022-10-17
1 2022-10-31   991.010525  944.058882  1038.413205  979.000 2022-10-17
2 2022-11-07   998.839646  950.710461  1046.173693  943.000 2022-10-17
3 2022-11-14   965.376277  913.089378  1012.949046  923.000 2022-10-17
4 2022-11-21  1005.550314  956.354159  1054.951291  922.000 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds        y  day_of_week  week_of_year  month
0   2021-01-04  339.000            0             1      1
1   2021-01-11  382.000            0             2      1
2   2021-01-18  437.000            0             3      1
3   2021-01-25  644.000            0             4      1
4   2021-02-01  337.000            0             5      2
..         ...      ...          ...           ...    ...
151 2023-11-27  394.625            0            48     11
152 2023-12-04  415.458            0            49     12
153 2023-12-11  444.459            0            50     12
154 2023-12-18  481.250            0            51     12
155 2023-12-25  535.916            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:50:44,056] A new study created in memory with name: no-name-be20fd8b-cb2e-4658-9447-4339882a6c25
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.31s/it]100%|##########| 2/2 [00:01<00:00,  1.08it/s]100%|##########| 2/2 [00:01<00:00,  1.02it/s]
[I 2025-05-23 20:50:46,866] Trial 0 finished with value: 111.93760093867411 and parameters: {'changepoint_prior_scale': 0.3856112302723151, 'seasonality_prior_scale': 0.0586219983783889, 'n_changepoints': 10}. Best is trial 0 with value: 111.93760093867411.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.02it/s]100%|##########| 2/2 [00:01<00:00,  1.27it/s]100%|##########| 2/2 [00:01<00:00,  1.22it/s]
[I 2025-05-23 20:50:49,490] Trial 1 finished with value: 115.68857889827484 and parameters: {'changepoint_prior_scale': 0.016081355381341336, 'seasonality_prior_scale': 0.21736152974764372, 'n_changepoints': 22}. Best is trial 0 with value: 111.93760093867411.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.46s/it]100%|##########| 2/2 [00:02<00:00,  1.01it/s]100%|##########| 2/2 [00:02<00:00,  1.06s/it]
[I 2025-05-23 20:50:52,572] Trial 2 finished with value: 116.02626979837582 and parameters: {'changepoint_prior_scale': 0.005888309337936183, 'seasonality_prior_scale': 0.17327059658211924, 'n_changepoints': 36}. Best is trial 0 with value: 111.93760093867411.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.53s/it]100%|##########| 2/2 [00:02<00:00,  1.07s/it]100%|##########| 2/2 [00:02<00:00,  1.14s/it]
[I 2025-05-23 20:50:55,957] Trial 3 finished with value: 119.64256314820356 and parameters: {'changepoint_prior_scale': 0.010527622880747352, 'seasonality_prior_scale': 0.35869194028696955, 'n_changepoints': 50}. Best is trial 0 with value: 111.93760093867411.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.04it/s]100%|##########| 2/2 [00:01<00:00,  1.36it/s]100%|##########| 2/2 [00:01<00:00,  1.30it/s]
[I 2025-05-23 20:50:58,302] Trial 4 finished with value: 112.41341905585878 and parameters: {'changepoint_prior_scale': 0.0063393068673250185, 'seasonality_prior_scale': 2.4368529427701096, 'n_changepoints': 20}. Best is trial 0 with value: 111.93760093867411.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.21s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.35s/it]100%|##########| 2/2 [00:02<00:00,  1.33s/it]
[I 2025-05-23 20:51:01,747] Trial 5 finished with value: 130.71275676745566 and parameters: {'changepoint_prior_scale': 0.0015203779807432087, 'seasonality_prior_scale': 8.11523283291334, 'n_changepoints': 31}. Best is trial 0 with value: 111.93760093867411.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.10s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.12s/it]100%|##########| 2/2 [00:02<00:00,  1.12s/it]
[I 2025-05-23 20:51:04,801] Trial 6 finished with value: 119.06122935214614 and parameters: {'changepoint_prior_scale': 0.001694315970105566, 'seasonality_prior_scale': 0.309013071671514, 'n_changepoints': 36}. Best is trial 0 with value: 111.93760093867411.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.60s/it]100%|##########| 2/2 [00:03<00:00,  1.49s/it]100%|##########| 2/2 [00:03<00:00,  1.66s/it]
[I 2025-05-23 20:51:09,253] Trial 7 finished with value: 121.81305133657575 and parameters: {'changepoint_prior_scale': 0.29754090216591544, 'seasonality_prior_scale': 2.8618225449011154, 'n_changepoints': 31}. Best is trial 0 with value: 111.93760093867411.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.76s/it]100%|##########| 2/2 [00:02<00:00,  1.15s/it]100%|##########| 2/2 [00:02<00:00,  1.24s/it]
[I 2025-05-23 20:51:12,859] Trial 8 finished with value: 115.5668625139766 and parameters: {'changepoint_prior_scale': 0.12915629723379096, 'seasonality_prior_scale': 0.5137556765548924, 'n_changepoints': 26}. Best is trial 0 with value: 111.93760093867411.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.49s/it]100%|##########| 2/2 [00:02<00:00,  1.07it/s]100%|##########| 2/2 [00:02<00:00,  1.01s/it]
[I 2025-05-23 20:51:15,849] Trial 9 finished with value: 116.91486395287392 and parameters: {'changepoint_prior_scale': 0.030106917119465452, 'seasonality_prior_scale': 0.013287301930356151, 'n_changepoints': 17}. Best is trial 0 with value: 111.93760093867411.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.50s/it]100%|##########| 2/2 [00:02<00:00,  1.01s/it]100%|##########| 2/2 [00:02<00:00,  1.08s/it]
Rendimiento para la combinación BMX_6-BMX_TRADICIONAL-BMX_3402:
  horizon           mse        rmse  ...     mdape     smape  coverage
0 21 days   5977.324808   77.313161  ...  0.080665  0.115457  0.833333
1 28 days   8252.424424   90.842856  ...  0.093478  0.128366  0.833333
2 35 days  14500.905330  120.419705  ...  0.198903  0.183266  0.500000
3 42 days  21671.666516  147.212997  ...  0.275525  0.235933  0.333333
4 49 days  19196.702265  138.552164  ...  0.245039  0.227348  0.166667

[5 rows x 8 columns]
          ds        yhat  yhat_lower  yhat_upper        y     cutoff
0 2022-10-24  653.533497  550.203534  746.787449  694.666 2022-10-17
1 2022-10-31  494.402539  405.539775  594.292377  448.833 2022-10-17
2 2022-11-07  609.213272  509.340497  710.289095  533.875 2022-10-17
3 2022-11-14  627.422095  525.421614  727.096165  433.874 2022-10-17
4 2022-11-21  676.046604  575.005861  775.163765  537.958 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds         y  day_of_week  week_of_year  month
0   2021-01-04  1763.958            0             1      1
1   2021-01-11  1828.000            0             2      1
2   2021-01-18  1853.000            0             3      1
3   2021-01-25  2084.000            0             4      1
4   2021-02-01  1774.000            0             5      2
..         ...       ...          ...           ...    ...
151 2023-11-27  2120.457            0            48     11
152 2023-12-04  2256.582            0            49     12
153 2023-12-11  2946.833            0            50     12
154 2023-12-18  2796.041            0            51     12
155 2023-12-25  2301.582            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:51:19,191] A new study created in memory with name: no-name-1ae7986e-b732-4a0d-8381-64a386fd94c7
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.07s/it]100%|##########| 2/2 [00:01<00:00,  1.39it/s]100%|##########| 2/2 [00:01<00:00,  1.29it/s]
[I 2025-05-23 20:51:21,861] Trial 0 finished with value: 253.30486274674504 and parameters: {'changepoint_prior_scale': 0.004391110938849191, 'seasonality_prior_scale': 0.013344403781826348, 'n_changepoints': 41}. Best is trial 0 with value: 253.30486274674504.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.31s/it]100%|##########| 2/2 [00:01<00:00,  1.08it/s]100%|##########| 2/2 [00:01<00:00,  1.02it/s]
[I 2025-05-23 20:51:24,945] Trial 1 finished with value: 274.31905433686086 and parameters: {'changepoint_prior_scale': 0.03114739606830988, 'seasonality_prior_scale': 2.5213929912670605, 'n_changepoints': 10}. Best is trial 0 with value: 253.30486274674504.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.61s/it]100%|##########| 2/2 [00:02<00:00,  1.03s/it]100%|##########| 2/2 [00:02<00:00,  1.12s/it]
[I 2025-05-23 20:51:28,100] Trial 2 finished with value: 249.51794631264096 and parameters: {'changepoint_prior_scale': 0.4019580978157419, 'seasonality_prior_scale': 0.3634146825136746, 'n_changepoints': 21}. Best is trial 2 with value: 249.51794631264096.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.11s/it]100%|##########| 2/2 [00:01<00:00,  1.13it/s]100%|##########| 2/2 [00:01<00:00,  1.09it/s]
[I 2025-05-23 20:51:30,978] Trial 3 finished with value: 307.5423485123398 and parameters: {'changepoint_prior_scale': 0.001864118568019092, 'seasonality_prior_scale': 0.04388260113995376, 'n_changepoints': 16}. Best is trial 2 with value: 249.51794631264096.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.39s/it]100%|##########| 2/2 [00:02<00:00,  1.02it/s]100%|##########| 2/2 [00:02<00:00,  1.04s/it]
[I 2025-05-23 20:51:34,166] Trial 4 finished with value: 254.45439142940748 and parameters: {'changepoint_prior_scale': 0.07075053562212362, 'seasonality_prior_scale': 1.9878806880010436, 'n_changepoints': 19}. Best is trial 2 with value: 249.51794631264096.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.53s/it]100%|##########| 2/2 [00:02<00:00,  1.00it/s]100%|##########| 2/2 [00:02<00:00,  1.08s/it]
[I 2025-05-23 20:51:37,338] Trial 5 finished with value: 261.4101946895026 and parameters: {'changepoint_prior_scale': 0.004245846287793209, 'seasonality_prior_scale': 0.011957337646368346, 'n_changepoints': 42}. Best is trial 2 with value: 249.51794631264096.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.31s/it]100%|##########| 2/2 [00:03<00:00,  1.44s/it]100%|##########| 2/2 [00:03<00:00,  1.57s/it]
[I 2025-05-23 20:51:41,595] Trial 6 finished with value: 271.6308468450023 and parameters: {'changepoint_prior_scale': 0.014073701367863496, 'seasonality_prior_scale': 0.3661623594827698, 'n_changepoints': 17}. Best is trial 2 with value: 249.51794631264096.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.71s/it]100%|##########| 2/2 [00:03<00:00,  1.49s/it]100%|##########| 2/2 [00:03<00:00,  1.67s/it]
[I 2025-05-23 20:51:45,904] Trial 7 finished with value: 236.15691151993997 and parameters: {'changepoint_prior_scale': 0.045717137627689225, 'seasonality_prior_scale': 0.019579279357610377, 'n_changepoints': 38}. Best is trial 7 with value: 236.15691151993997.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.30s/it]100%|##########| 2/2 [00:01<00:00,  1.07it/s]100%|##########| 2/2 [00:01<00:00,  1.01it/s]
[I 2025-05-23 20:51:49,061] Trial 8 finished with value: 255.10851938075967 and parameters: {'changepoint_prior_scale': 0.003645542858558437, 'seasonality_prior_scale': 0.014015345120610933, 'n_changepoints': 12}. Best is trial 7 with value: 236.15691151993997.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:05<00:05,  5.24s/it]100%|##########| 2/2 [00:06<00:00,  2.63s/it]100%|##########| 2/2 [00:06<00:00,  3.02s/it]
[I 2025-05-23 20:51:56,175] Trial 9 finished with value: 222.46457182576708 and parameters: {'changepoint_prior_scale': 0.2086320385607232, 'seasonality_prior_scale': 0.015499273578044209, 'n_changepoints': 49}. Best is trial 9 with value: 222.46457182576708.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:05<00:05,  5.37s/it]100%|##########| 2/2 [00:06<00:00,  2.61s/it]100%|##########| 2/2 [00:06<00:00,  3.02s/it]
Rendimiento para la combinación BMX_6-BMX_TRADICIONAL-BMX_3931:
  horizon           mse        rmse  ...     mdape     smape  coverage
0 21 days  28090.035342  167.600821  ...  0.063420  0.057460  0.666667
1 28 days  20088.344569  141.733357  ...  0.047328  0.050049  0.833333
2 35 days  34316.571106  185.247324  ...  0.051298  0.066158  0.666667
3 42 days  42639.633667  206.493665  ...  0.064434  0.074303  0.500000
4 49 days  61331.686060  247.652349  ...  0.095121  0.094538  0.166667

[5 rows x 8 columns]
          ds         yhat   yhat_lower   yhat_upper         y     cutoff
0 2022-10-24  2356.446630  2174.164137  2537.501028  2108.247 2022-10-17
1 2022-10-31  2382.965723  2210.227830  2575.765236  2249.249 2022-10-17
2 2022-11-07  2468.472915  2281.885361  2648.873445  2218.959 2022-10-17
3 2022-11-14  2325.165106  2140.000824  2513.115932  2248.666 2022-10-17
4 2022-11-21  2369.995666  2185.106514  2549.839318  2441.956 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds        y  day_of_week  week_of_year  month
0   2021-01-04  128.355            0             1      1
1   2021-01-11  129.510            0             2      1
2   2021-01-18  103.062            0             3      1
3   2021-01-25  119.404            0             4      1
4   2021-02-01  131.563            0             5      2
..         ...      ...          ...           ...    ...
151 2023-11-27   90.002            0            48     11
152 2023-12-04   72.001            0            49     12
153 2023-12-11   69.833            0            50     12
154 2023-12-18   75.334            0            51     12
155 2023-12-25   47.668            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:52:03,268] A new study created in memory with name: no-name-d945fb5a-4cdf-4671-8e85-7fcc988c42e7
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.26s/it]100%|##########| 2/2 [00:01<00:00,  1.06it/s]100%|##########| 2/2 [00:01<00:00,  1.01it/s]
[I 2025-05-23 20:52:06,090] Trial 0 finished with value: 14.536166867661297 and parameters: {'changepoint_prior_scale': 0.3471905075300482, 'seasonality_prior_scale': 0.4048787010975781, 'n_changepoints': 10}. Best is trial 0 with value: 14.536166867661297.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.78s/it]100%|##########| 2/2 [00:02<00:00,  1.08s/it]100%|##########| 2/2 [00:02<00:00,  1.19s/it]
[I 2025-05-23 20:52:09,287] Trial 1 finished with value: 18.183497623660834 and parameters: {'changepoint_prior_scale': 0.05102401914202486, 'seasonality_prior_scale': 4.5735180154913015, 'n_changepoints': 19}. Best is trial 0 with value: 14.536166867661297.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.28s/it]100%|##########| 2/2 [00:01<00:00,  1.21it/s]100%|##########| 2/2 [00:01<00:00,  1.12it/s]
[I 2025-05-23 20:52:13,300] Trial 2 finished with value: 41.993490088872626 and parameters: {'changepoint_prior_scale': 0.001569921335646234, 'seasonality_prior_scale': 5.815705645841554, 'n_changepoints': 26}. Best is trial 0 with value: 14.536166867661297.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.69s/it]100%|##########| 2/2 [00:02<00:00,  1.09s/it]100%|##########| 2/2 [00:02<00:00,  1.18s/it]
[I 2025-05-23 20:52:16,689] Trial 3 finished with value: 13.338506747027136 and parameters: {'changepoint_prior_scale': 0.09420887530521743, 'seasonality_prior_scale': 0.010525981277426077, 'n_changepoints': 35}. Best is trial 3 with value: 13.338506747027136.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.31s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.33s/it]100%|##########| 2/2 [00:02<00:00,  1.33s/it]
[I 2025-05-23 20:52:28,392] Trial 4 finished with value: 20.380972872397958 and parameters: {'changepoint_prior_scale': 0.001017125440618431, 'seasonality_prior_scale': 3.669108953318401, 'n_changepoints': 27}. Best is trial 3 with value: 13.338506747027136.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.74s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:06<00:00,  3.16s/it]100%|##########| 2/2 [00:06<00:00,  3.10s/it]
[I 2025-05-23 20:52:36,742] Trial 5 finished with value: 16.220851627748267 and parameters: {'changepoint_prior_scale': 0.002939959803412734, 'seasonality_prior_scale': 0.2503157757604537, 'n_changepoints': 48}. Best is trial 3 with value: 13.338506747027136.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.07it/s]100%|##########| 2/2 [00:01<00:00,  1.27it/s]100%|##########| 2/2 [00:01<00:00,  1.23it/s]
[I 2025-05-23 20:52:39,517] Trial 6 finished with value: 16.249760948829596 and parameters: {'changepoint_prior_scale': 0.003963767378748159, 'seasonality_prior_scale': 0.9834671927302151, 'n_changepoints': 9}. Best is trial 3 with value: 13.338506747027136.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.67s/it]100%|##########| 2/2 [00:02<00:00,  1.00s/it]100%|##########| 2/2 [00:02<00:00,  1.10s/it]
[I 2025-05-23 20:52:42,911] Trial 7 finished with value: 15.332683083060184 and parameters: {'changepoint_prior_scale': 0.0035110417057707885, 'seasonality_prior_scale': 0.03106013584838214, 'n_changepoints': 45}. Best is trial 3 with value: 13.338506747027136.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.09s/it]100%|##########| 2/2 [00:01<00:00,  1.19it/s]100%|##########| 2/2 [00:01<00:00,  1.14it/s]
[I 2025-05-23 20:52:45,649] Trial 8 finished with value: 14.209809450556845 and parameters: {'changepoint_prior_scale': 0.009568129688984961, 'seasonality_prior_scale': 0.01661545717406348, 'n_changepoints': 30}. Best is trial 3 with value: 13.338506747027136.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.47s/it]100%|##########| 2/2 [00:02<00:00,  1.09s/it]100%|##########| 2/2 [00:02<00:00,  1.15s/it]
[I 2025-05-23 20:52:49,083] Trial 9 finished with value: 18.521319730771864 and parameters: {'changepoint_prior_scale': 0.014933573966587687, 'seasonality_prior_scale': 8.029255019150416, 'n_changepoints': 28}. Best is trial 3 with value: 13.338506747027136.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.35s/it]100%|##########| 2/2 [00:02<00:00,  1.05it/s]100%|##########| 2/2 [00:02<00:00,  1.01s/it]
Rendimiento para la combinación BMX_997-BMX_HOGAR-BMX_3001:
  horizon         mse       rmse  ...     mdape     smape  coverage
0 21 days   89.709929   9.471533  ...  0.058225  0.089309  0.833333
1 28 days  143.807819  11.991990  ...  0.093228  0.127753  0.666667
2 35 days   91.426607   9.561726  ...  0.093228  0.105982  0.833333
3 42 days  101.022458  10.050993  ...  0.105720  0.108106  0.833333
4 49 days   66.442049   8.151199  ...  0.097984  0.101376  1.000000

[5 rows x 8 columns]
          ds       yhat  yhat_lower  yhat_upper       y     cutoff
0 2022-10-24  77.538380   64.320709   90.676921  77.512 2022-10-17
1 2022-10-31  78.046369   64.491185   92.055552  73.851 2022-10-17
2 2022-11-07  71.042437   57.023186   83.939962  81.360 2022-10-17
3 2022-11-14  70.680867   57.738539   83.968662  88.687 2022-10-17
4 2022-11-21  86.682359   73.516214  100.916940  91.515 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds       y  day_of_week  week_of_year  month
0   2021-01-04  73.000            0             1      1
1   2021-01-11  87.006            0             2      1
2   2021-01-18  77.175            0             3      1
3   2021-01-25  92.013            0             4      1
4   2021-02-01  91.003            0             5      2
..         ...     ...          ...           ...    ...
151 2023-11-27  56.011            0            48     11
152 2023-12-04  72.022            0            49     12
153 2023-12-11  64.002            0            50     12
154 2023-12-18  92.020            0            51     12
155 2023-12-25  67.008            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:52:52,138] A new study created in memory with name: no-name-bdd2677d-afd8-4517-90fa-e18876542ea9
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.43s/it]100%|##########| 2/2 [00:02<00:00,  1.33s/it]100%|##########| 2/2 [00:02<00:00,  1.50s/it]
[I 2025-05-23 20:52:56,151] Trial 0 finished with value: 21.246123598366342 and parameters: {'changepoint_prior_scale': 0.3092002127777314, 'seasonality_prior_scale': 4.476040649370875, 'n_changepoints': 15}. Best is trial 0 with value: 21.246123598366342.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.59s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.98s/it]100%|##########| 2/2 [00:03<00:00,  1.92s/it]
[I 2025-05-23 20:53:01,315] Trial 1 finished with value: 21.87296333641372 and parameters: {'changepoint_prior_scale': 0.0024736641607334014, 'seasonality_prior_scale': 1.7512732075367083, 'n_changepoints': 29}. Best is trial 0 with value: 21.246123598366342.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.19s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.48s/it]100%|##########| 2/2 [00:02<00:00,  1.43s/it]
[I 2025-05-23 20:53:05,076] Trial 2 finished with value: 13.198650888294692 and parameters: {'changepoint_prior_scale': 0.0032626628292217923, 'seasonality_prior_scale': 0.010049203761567121, 'n_changepoints': 40}. Best is trial 2 with value: 13.198650888294692.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.24s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:04<00:00,  2.20s/it]100%|##########| 2/2 [00:04<00:00,  2.21s/it]
[I 2025-05-23 20:53:10,675] Trial 3 finished with value: 18.48326525319825 and parameters: {'changepoint_prior_scale': 0.002064413109406594, 'seasonality_prior_scale': 0.024143650812314607, 'n_changepoints': 49}. Best is trial 2 with value: 13.198650888294692.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.56s/it]100%|##########| 2/2 [00:03<00:00,  1.51s/it]100%|##########| 2/2 [00:03<00:00,  1.67s/it]
[I 2025-05-23 20:53:15,172] Trial 4 finished with value: 18.337853529910355 and parameters: {'changepoint_prior_scale': 0.23055637672704077, 'seasonality_prior_scale': 0.05616816472090686, 'n_changepoints': 31}. Best is trial 2 with value: 13.198650888294692.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.21s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.36s/it]100%|##########| 2/2 [00:02<00:00,  1.34s/it]
[I 2025-05-23 20:53:18,716] Trial 5 finished with value: 20.76006775851274 and parameters: {'changepoint_prior_scale': 0.0017422650687308253, 'seasonality_prior_scale': 0.07570153379229226, 'n_changepoints': 34}. Best is trial 2 with value: 13.198650888294692.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.60s/it]100%|##########| 2/2 [00:02<00:00,  1.03s/it]100%|##########| 2/2 [00:02<00:00,  1.12s/it]
[I 2025-05-23 20:53:21,919] Trial 6 finished with value: 22.499267913215263 and parameters: {'changepoint_prior_scale': 0.4995009050043191, 'seasonality_prior_scale': 0.10833594169978271, 'n_changepoints': 12}. Best is trial 2 with value: 13.198650888294692.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.13s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.51s/it]100%|##########| 2/2 [00:02<00:00,  1.45s/it]
[I 2025-05-23 20:53:25,679] Trial 7 finished with value: 22.784682973042962 and parameters: {'changepoint_prior_scale': 0.004120689878893606, 'seasonality_prior_scale': 5.279477266658018, 'n_changepoints': 45}. Best is trial 2 with value: 13.198650888294692.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.01s/it]100%|##########| 2/2 [00:02<00:00,  1.15s/it]100%|##########| 2/2 [00:02<00:00,  1.28s/it]
[I 2025-05-23 20:53:29,109] Trial 8 finished with value: 19.494346149797796 and parameters: {'changepoint_prior_scale': 0.10304200850974293, 'seasonality_prior_scale': 0.30981144264887145, 'n_changepoints': 38}. Best is trial 2 with value: 13.198650888294692.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.13it/s]100%|##########| 2/2 [00:01<00:00,  1.30it/s]100%|##########| 2/2 [00:01<00:00,  1.27it/s]
[I 2025-05-23 20:53:31,507] Trial 9 finished with value: 24.3728901711438 and parameters: {'changepoint_prior_scale': 0.0036064029391240154, 'seasonality_prior_scale': 0.8798733705091655, 'n_changepoints': 10}. Best is trial 2 with value: 13.198650888294692.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.20s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.43s/it]100%|##########| 2/2 [00:02<00:00,  1.39s/it]
Rendimiento para la combinación BMX_997-BMX_HOGAR-BMX_3931:
  horizon         mse       rmse  ...     mdape     smape  coverage
0 21 days  170.686300  13.064697  ...  0.165424  0.177321  0.666667
1 28 days  145.685044  12.070006  ...  0.169919  0.166083  0.833333
2 35 days  165.887006  12.879713  ...  0.197753  0.179982  0.833333
3 42 days  145.979998  12.082218  ...  0.184871  0.175094  0.833333
4 49 days  291.936124  17.086138  ...  0.184871  0.223210  0.666667

[5 rows x 8 columns]
          ds       yhat  yhat_lower  yhat_upper       y     cutoff
0 2022-10-24  56.568823   43.111966   70.711201  62.007 2022-10-17
1 2022-10-31  60.098294   45.463090   73.304113  65.019 2022-10-17
2 2022-11-07  57.608791   43.321677   70.596378  78.009 2022-10-17
3 2022-11-14  55.311090   40.849040   69.049366  64.001 2022-10-17
4 2022-11-21  54.177932   40.690641   67.813385  67.006 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds       y  day_of_week  week_of_year  month
0   2021-01-04  49.000            0             1      1
1   2021-01-11  60.000            0             2      1
2   2021-01-18  63.999            0             3      1
3   2021-01-25  50.004            0             4      1
4   2021-02-01  52.000            0             5      2
..         ...     ...          ...           ...    ...
151 2023-11-27  36.000            0            48     11
152 2023-12-04  36.000            0            49     12
153 2023-12-11  34.000            0            50     12
154 2023-12-18  38.000            0            51     12
155 2023-12-25  27.000            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:53:35,244] A new study created in memory with name: no-name-c34b44df-6efc-4426-8966-45c85016294f
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.75s/it]100%|##########| 2/2 [00:02<00:00,  1.19s/it]100%|##########| 2/2 [00:02<00:00,  1.27s/it]
[I 2025-05-23 20:53:38,793] Trial 0 finished with value: 6.7602046995798935 and parameters: {'changepoint_prior_scale': 0.10224319265504271, 'seasonality_prior_scale': 0.014351384882720598, 'n_changepoints': 17}. Best is trial 0 with value: 6.7602046995798935.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.20it/s]100%|##########| 2/2 [00:01<00:00,  1.39it/s]100%|##########| 2/2 [00:01<00:00,  1.36it/s]
[I 2025-05-23 20:53:41,004] Trial 1 finished with value: 8.234912322929738 and parameters: {'changepoint_prior_scale': 0.06503090374835525, 'seasonality_prior_scale': 3.462760512210068, 'n_changepoints': 5}. Best is trial 0 with value: 6.7602046995798935.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.19s/it]100%|##########| 2/2 [00:01<00:00,  1.25it/s]100%|##########| 2/2 [00:01<00:00,  1.16it/s]
[I 2025-05-23 20:53:43,889] Trial 2 finished with value: 7.2141732702338945 and parameters: {'changepoint_prior_scale': 0.08111328247080914, 'seasonality_prior_scale': 0.4850126469284237, 'n_changepoints': 25}. Best is trial 0 with value: 6.7602046995798935.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.10s/it]100%|##########| 2/2 [00:02<00:00,  1.18s/it]100%|##########| 2/2 [00:02<00:00,  1.31s/it]
[I 2025-05-23 20:53:47,632] Trial 3 finished with value: 8.558992436529948 and parameters: {'changepoint_prior_scale': 0.2632297192177036, 'seasonality_prior_scale': 1.5447407060013505, 'n_changepoints': 19}. Best is trial 0 with value: 6.7602046995798935.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.25s/it]100%|##########| 2/2 [00:01<00:00,  1.08it/s]100%|##########| 2/2 [00:01<00:00,  1.03it/s]
[I 2025-05-23 20:53:50,759] Trial 4 finished with value: 9.859186093271715 and parameters: {'changepoint_prior_scale': 0.49704880803584917, 'seasonality_prior_scale': 0.07980450271446266, 'n_changepoints': 11}. Best is trial 0 with value: 6.7602046995798935.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.43s/it]100%|##########| 2/2 [00:01<00:00,  1.09it/s]100%|##########| 2/2 [00:01<00:00,  1.00it/s]
[I 2025-05-23 20:53:53,921] Trial 5 finished with value: 8.070893070099457 and parameters: {'changepoint_prior_scale': 0.030278118818865617, 'seasonality_prior_scale': 3.3217275723394497, 'n_changepoints': 15}. Best is trial 0 with value: 6.7602046995798935.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.33s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.43s/it]100%|##########| 2/2 [00:02<00:00,  1.41s/it]
[I 2025-05-23 20:53:58,787] Trial 6 finished with value: 7.784971023468309 and parameters: {'changepoint_prior_scale': 0.004275640853256126, 'seasonality_prior_scale': 1.6692602641494725, 'n_changepoints': 50}. Best is trial 0 with value: 6.7602046995798935.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.04s/it]100%|##########| 2/2 [00:01<00:00,  1.26it/s]100%|##########| 2/2 [00:01<00:00,  1.21it/s]
[I 2025-05-23 20:54:01,415] Trial 7 finished with value: 7.174895986987394 and parameters: {'changepoint_prior_scale': 0.007962635400061738, 'seasonality_prior_scale': 0.24825053740856245, 'n_changepoints': 21}. Best is trial 0 with value: 6.7602046995798935.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.30s/it]100%|##########| 2/2 [00:01<00:00,  1.09it/s]100%|##########| 2/2 [00:01<00:00,  1.03it/s]
[I 2025-05-23 20:54:04,430] Trial 8 finished with value: 6.907052635420223 and parameters: {'changepoint_prior_scale': 0.1970579538343975, 'seasonality_prior_scale': 0.062356642982187266, 'n_changepoints': 44}. Best is trial 0 with value: 6.7602046995798935.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.24s/it]100%|##########| 2/2 [00:01<00:00,  1.20it/s]100%|##########| 2/2 [00:01<00:00,  1.12it/s]
[I 2025-05-23 20:54:06,877] Trial 9 finished with value: 7.117785163733723 and parameters: {'changepoint_prior_scale': 0.06806559604416787, 'seasonality_prior_scale': 0.06368629321900213, 'n_changepoints': 25}. Best is trial 0 with value: 6.7602046995798935.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.05s/it]100%|##########| 2/2 [00:01<00:00,  1.23it/s]100%|##########| 2/2 [00:01<00:00,  1.18it/s]
Rendimiento para la combinación BMX_997-BMX_HOGAR-BMX_3203:
  horizon        mse      rmse  ...     mdape     smape  coverage
0 21 days  26.579750  5.155555  ...  0.124781  0.120779  1.000000
1 28 days  16.014201  4.001775  ...  0.086705  0.090600  1.000000
2 35 days   9.969211  3.157406  ...  0.072563  0.074695  1.000000
3 42 days  18.630801  4.316341  ...  0.065462  0.090430  0.833333
4 49 days  53.186291  7.292893  ...  0.143583  0.158983  0.500000

[5 rows x 8 columns]
          ds       yhat  yhat_lower  yhat_upper       y     cutoff
0 2022-10-24  40.928933   32.844732   49.483687  33.999 2022-10-17
1 2022-10-31  38.364215   28.992174   47.295517  41.000 2022-10-17
2 2022-11-07  36.406178   27.300891   44.971367  34.000 2022-10-17
3 2022-11-14  36.791730   28.142753   45.206549  41.000 2022-10-17
4 2022-11-21  39.753341   31.292422   48.693658  37.002 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds       y  day_of_week  week_of_year  month
0   2021-01-04   382.0            0             1      1
1   2021-01-11   508.0            0             2      1
2   2021-01-18   574.0            0             3      1
3   2021-01-25   465.0            0             4      1
4   2021-02-01   414.0            0             5      2
..         ...     ...          ...           ...    ...
151 2023-11-27  1498.0            0            48     11
152 2023-12-04  1084.0            0            49     12
153 2023-12-11  1181.0            0            50     12
154 2023-12-18  1464.0            0            51     12
155 2023-12-25   908.0            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:54:09,605] A new study created in memory with name: no-name-2a98378d-d9ba-4103-a65c-8eaf849fa34b
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.09s/it]100%|##########| 2/2 [00:01<00:00,  1.22it/s]100%|##########| 2/2 [00:01<00:00,  1.16it/s]
[I 2025-05-23 20:54:12,248] Trial 0 finished with value: 167.34272539944467 and parameters: {'changepoint_prior_scale': 0.03923885529539612, 'seasonality_prior_scale': 6.211357134246791, 'n_changepoints': 17}. Best is trial 0 with value: 167.34272539944467.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.32s/it]100%|##########| 2/2 [00:03<00:00,  1.66s/it]100%|##########| 2/2 [00:03<00:00,  1.91s/it]
[I 2025-05-23 20:54:17,128] Trial 1 finished with value: 150.19553892243337 and parameters: {'changepoint_prior_scale': 0.2542902169246341, 'seasonality_prior_scale': 1.8420320327628599, 'n_changepoints': 36}. Best is trial 1 with value: 150.19553892243337.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.14s/it]100%|##########| 2/2 [00:01<00:00,  1.13it/s]100%|##########| 2/2 [00:01<00:00,  1.08it/s]
[I 2025-05-23 20:54:19,829] Trial 2 finished with value: 151.89396876231567 and parameters: {'changepoint_prior_scale': 0.0051478291062739415, 'seasonality_prior_scale': 0.12310355378096563, 'n_changepoints': 42}. Best is trial 1 with value: 150.19553892243337.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.24s/it]100%|##########| 2/2 [00:01<00:00,  1.10it/s]100%|##########| 2/2 [00:01<00:00,  1.04it/s]
[I 2025-05-23 20:54:22,567] Trial 3 finished with value: 159.98606668406927 and parameters: {'changepoint_prior_scale': 0.010059990582168919, 'seasonality_prior_scale': 2.4489625047305243, 'n_changepoints': 34}. Best is trial 1 with value: 150.19553892243337.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.06it/s]100%|##########| 2/2 [00:01<00:00,  1.23it/s]100%|##########| 2/2 [00:01<00:00,  1.20it/s]
[I 2025-05-23 20:54:25,047] Trial 4 finished with value: 150.26447885726193 and parameters: {'changepoint_prior_scale': 0.06417681521083997, 'seasonality_prior_scale': 0.015554727139451599, 'n_changepoints': 15}. Best is trial 1 with value: 150.19553892243337.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.11s/it]100%|##########| 2/2 [00:01<00:00,  1.10it/s]100%|##########| 2/2 [00:01<00:00,  1.07it/s]
[I 2025-05-23 20:54:27,968] Trial 5 finished with value: 149.15353476136318 and parameters: {'changepoint_prior_scale': 0.05413873069492308, 'seasonality_prior_scale': 0.034868212314018626, 'n_changepoints': 18}. Best is trial 5 with value: 149.15353476136318.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.72s/it]100%|##########| 2/2 [00:02<00:00,  1.05s/it]100%|##########| 2/2 [00:02<00:00,  1.15s/it]
[I 2025-05-23 20:54:31,049] Trial 6 finished with value: 154.3457801508717 and parameters: {'changepoint_prior_scale': 0.026596403026520173, 'seasonality_prior_scale': 0.4299214922854205, 'n_changepoints': 35}. Best is trial 5 with value: 149.15353476136318.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.54s/it]100%|##########| 2/2 [00:03<00:00,  1.38s/it]100%|##########| 2/2 [00:03<00:00,  1.55s/it]
[I 2025-05-23 20:54:35,066] Trial 7 finished with value: 148.3300172314052 and parameters: {'changepoint_prior_scale': 0.29538163143204266, 'seasonality_prior_scale': 1.2619742879526197, 'n_changepoints': 34}. Best is trial 7 with value: 148.3300172314052.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.68s/it]100%|##########| 2/2 [00:02<00:00,  1.04s/it]100%|##########| 2/2 [00:02<00:00,  1.14s/it]
[I 2025-05-23 20:54:38,365] Trial 8 finished with value: 162.51328976112504 and parameters: {'changepoint_prior_scale': 0.1573559870272106, 'seasonality_prior_scale': 0.012729172346598419, 'n_changepoints': 26}. Best is trial 7 with value: 148.3300172314052.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.28s/it]100%|##########| 2/2 [00:01<00:00,  1.12it/s]100%|##########| 2/2 [00:01<00:00,  1.05it/s]
[I 2025-05-23 20:54:41,192] Trial 9 finished with value: 143.6925731602749 and parameters: {'changepoint_prior_scale': 0.15567141348976501, 'seasonality_prior_scale': 0.033887048733851954, 'n_changepoints': 15}. Best is trial 9 with value: 143.6925731602749.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.45s/it]100%|##########| 2/2 [00:02<00:00,  1.01s/it]100%|##########| 2/2 [00:02<00:00,  1.07s/it]
Rendimiento para la combinación BMX_997-BMX_TRADICIONAL-BMX_3001:
  horizon           mse        rmse  ...     mdape     smape  coverage
0 21 days   4145.877234   64.388487  ...  0.078066  0.072289  1.000000
1 28 days  27555.639540  165.998914  ...  0.100195  0.138088  0.666667
2 35 days  73447.337156  271.011692  ...  0.173571  0.219399  0.500000
3 42 days  72901.876936  270.003476  ...  0.173571  0.207963  0.500000
4 49 days  50449.094096  224.608758  ...  0.075158  0.144711  0.666667

[5 rows x 8 columns]
          ds        yhat  yhat_lower  yhat_upper         y     cutoff
0 2022-10-24  817.407688  734.351242  906.102910   755.999 2022-10-17
1 2022-10-31  863.284550  777.149986  944.955329   791.333 2022-10-17
2 2022-11-07  842.807548  754.701290  927.063283   846.833 2022-10-17
3 2022-11-14  815.906268  731.750892  900.407338  1168.000 2022-10-17
4 2022-11-21  665.333559  582.305832  742.486287  1193.666 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds     y  day_of_week  week_of_year  month
0   2021-01-04   7.0            0             1      1
1   2021-01-11   7.0            0             2      1
2   2021-01-18   6.0            0             3      1
3   2021-01-25   8.0            0             4      1
4   2021-02-01   5.0            0             5      2
..         ...   ...          ...           ...    ...
151 2023-11-27  21.0            0            48     11
152 2023-12-04  17.0            0            49     12
153 2023-12-11  19.0            0            50     12
154 2023-12-18   9.0            0            51     12
155 2023-12-25   9.0            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:54:44,293] A new study created in memory with name: no-name-eb095382-21f6-4c4f-88ab-a40d5dcf956c
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.22s/it]100%|##########| 2/2 [00:01<00:00,  1.06it/s]100%|##########| 2/2 [00:01<00:00,  1.02it/s]
[I 2025-05-23 20:54:47,119] Trial 0 finished with value: 7.082321631271301 and parameters: {'changepoint_prior_scale': 0.015242001381013849, 'seasonality_prior_scale': 0.871775361112993, 'n_changepoints': 29}. Best is trial 0 with value: 7.082321631271301.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.19s/it]100%|##########| 2/2 [00:01<00:00,  1.18it/s]100%|##########| 2/2 [00:01<00:00,  1.11it/s]
[I 2025-05-23 20:54:49,731] Trial 1 finished with value: 7.04308839542203 and parameters: {'changepoint_prior_scale': 0.004225286972878419, 'seasonality_prior_scale': 1.3282655452561472, 'n_changepoints': 35}. Best is trial 1 with value: 7.04308839542203.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.14s/it]100%|##########| 2/2 [00:01<00:00,  1.12it/s]100%|##########| 2/2 [00:01<00:00,  1.08it/s]
[I 2025-05-23 20:54:52,360] Trial 2 finished with value: 7.069147157475139 and parameters: {'changepoint_prior_scale': 0.05107167552840476, 'seasonality_prior_scale': 1.3243550025667556, 'n_changepoints': 30}. Best is trial 1 with value: 7.04308839542203.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.15s/it]100%|##########| 2/2 [00:01<00:00,  1.24it/s]100%|##########| 2/2 [00:01<00:00,  1.17it/s]
[I 2025-05-23 20:54:54,886] Trial 3 finished with value: 6.734105866428567 and parameters: {'changepoint_prior_scale': 0.004165940869174288, 'seasonality_prior_scale': 0.021765645080624986, 'n_changepoints': 35}. Best is trial 3 with value: 6.734105866428567.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.33s/it]100%|##########| 2/2 [00:01<00:00,  1.11it/s]100%|##########| 2/2 [00:01<00:00,  1.04it/s]
[I 2025-05-23 20:54:57,687] Trial 4 finished with value: 7.394403584752503 and parameters: {'changepoint_prior_scale': 0.14625204837221106, 'seasonality_prior_scale': 0.03503118858589489, 'n_changepoints': 22}. Best is trial 3 with value: 6.734105866428567.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.20s/it]100%|##########| 2/2 [00:01<00:00,  1.07it/s]100%|##########| 2/2 [00:01<00:00,  1.03it/s]
[I 2025-05-23 20:55:00,656] Trial 5 finished with value: 6.990403839863915 and parameters: {'changepoint_prior_scale': 0.00638738351030553, 'seasonality_prior_scale': 0.615540358687548, 'n_changepoints': 42}. Best is trial 3 with value: 6.734105866428567.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.06s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:13<00:00,  7.96s/it]100%|##########| 2/2 [00:13<00:00,  6.92s/it]
[I 2025-05-23 20:55:15,294] Trial 6 finished with value: 7.131530525435382 and parameters: {'changepoint_prior_scale': 0.0018032307031822618, 'seasonality_prior_scale': 6.141675955608698, 'n_changepoints': 23}. Best is trial 3 with value: 6.734105866428567.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.04s/it]100%|##########| 2/2 [00:01<00:00,  1.28it/s]100%|##########| 2/2 [00:01<00:00,  1.22it/s]
[I 2025-05-23 20:55:17,810] Trial 7 finished with value: 7.053127308949135 and parameters: {'changepoint_prior_scale': 0.00955144815752974, 'seasonality_prior_scale': 0.15946004442542577, 'n_changepoints': 15}. Best is trial 3 with value: 6.734105866428567.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.94s/it]100%|##########| 2/2 [00:02<00:00,  1.19s/it]100%|##########| 2/2 [00:02<00:00,  1.30s/it]
[I 2025-05-23 20:55:21,226] Trial 8 finished with value: 6.968144534638718 and parameters: {'changepoint_prior_scale': 0.01628089165707842, 'seasonality_prior_scale': 0.17427156174588038, 'n_changepoints': 40}. Best is trial 3 with value: 6.734105866428567.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.71s/it]100%|##########| 2/2 [00:02<00:00,  1.05s/it]100%|##########| 2/2 [00:02<00:00,  1.15s/it]
[I 2025-05-23 20:55:24,342] Trial 9 finished with value: 8.38098158770755 and parameters: {'changepoint_prior_scale': 0.37141272515523605, 'seasonality_prior_scale': 0.19341083680745322, 'n_changepoints': 15}. Best is trial 3 with value: 6.734105866428567.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.22s/it]100%|##########| 2/2 [00:01<00:00,  1.09it/s]100%|##########| 2/2 [00:01<00:00,  1.04it/s]
Rendimiento para la combinación BMX_997-BMX_TRADICIONAL-BMX_3207:
  horizon        mse      rmse       mae     mdape     smape  coverage
0 21 days  23.278501  4.824780  4.066972  0.379294  0.573224  0.666667
1 28 days  19.533546  4.419677  3.854770  0.500244  0.466617  0.666667
2 35 days  21.141055  4.597940  4.146260  0.906923  0.547196  0.666667
3 42 days  20.741669  4.554302  4.311024  0.550797  0.546165  0.500000
4 49 days  24.026511  4.901684  4.581564  0.730094  0.619185  0.500000
          ds       yhat  yhat_lower  yhat_upper     y     cutoff
0 2022-10-24   8.943040    5.635091   12.608421   1.0 2022-10-17
1 2022-10-31  11.464814    7.613442   15.288270  13.0 2022-10-17
2 2022-11-07  12.351748    8.776513   15.958751   5.0 2022-10-17
3 2022-11-14  10.566842    6.776401   14.297014   7.0 2022-10-17
4 2022-11-21   9.683127    5.940991   13.523849  12.0 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds    y  day_of_week  week_of_year  month
0   2021-01-04  5.0            0             1      1
1   2021-01-11  3.0            0             2      1
2   2021-01-18  5.0            0             3      1
3   2021-01-25  4.0            0             4      1
4   2021-02-01  2.0            0             5      2
..         ...  ...          ...           ...    ...
151 2023-11-27  0.0            0            48     11
152 2023-12-04  1.5            0            49     12
153 2023-12-11  2.5            0            50     12
154 2023-12-18  3.0            0            51     12
155 2023-12-25  2.0            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:55:27,223] A new study created in memory with name: no-name-63d9c5a2-f54c-4cfb-8322-5366fec71ec4
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.04s/it]100%|##########| 2/2 [00:01<00:00,  1.22it/s]100%|##########| 2/2 [00:01<00:00,  1.18it/s]
[I 2025-05-23 20:55:29,720] Trial 0 finished with value: 2.210113267764408 and parameters: {'changepoint_prior_scale': 0.013397528340082414, 'seasonality_prior_scale': 0.011336846016404615, 'n_changepoints': 14}. Best is trial 0 with value: 2.210113267764408.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.00s/it]100%|##########| 2/2 [00:01<00:00,  1.01it/s]100%|##########| 2/2 [00:01<00:00,  1.01it/s]
[I 2025-05-23 20:55:32,971] Trial 1 finished with value: 2.1347720992409487 and parameters: {'changepoint_prior_scale': 0.008912154648840777, 'seasonality_prior_scale': 0.01196732117446536, 'n_changepoints': 5}. Best is trial 1 with value: 2.1347720992409487.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.02s/it]100%|##########| 2/2 [00:02<00:00,  1.28s/it]100%|##########| 2/2 [00:02<00:00,  1.39s/it]
[I 2025-05-23 20:55:37,314] Trial 2 finished with value: 2.707043159561002 and parameters: {'changepoint_prior_scale': 0.12889300760398556, 'seasonality_prior_scale': 2.8062115824368026, 'n_changepoints': 25}. Best is trial 1 with value: 2.1347720992409487.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.26s/it]100%|##########| 2/2 [00:02<00:00,  1.28s/it]100%|##########| 2/2 [00:02<00:00,  1.42s/it]
[I 2025-05-23 20:55:41,057] Trial 3 finished with value: 2.3950931273878346 and parameters: {'changepoint_prior_scale': 0.12002640515992309, 'seasonality_prior_scale': 0.051486924601804616, 'n_changepoints': 32}. Best is trial 1 with value: 2.1347720992409487.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:03<00:03,  3.09s/it]100%|##########| 2/2 [00:03<00:00,  1.60s/it]100%|##########| 2/2 [00:03<00:00,  1.82s/it]
[I 2025-05-23 20:55:45,492] Trial 4 finished with value: 2.4130507400548913 and parameters: {'changepoint_prior_scale': 0.42040778405878043, 'seasonality_prior_scale': 0.23122351470138006, 'n_changepoints': 33}. Best is trial 1 with value: 2.1347720992409487.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.77s/it]100%|##########| 2/2 [00:02<00:00,  1.10s/it]100%|##########| 2/2 [00:02<00:00,  1.20s/it]
[I 2025-05-23 20:55:48,648] Trial 5 finished with value: 2.5991048771673304 and parameters: {'changepoint_prior_scale': 0.05043038776986988, 'seasonality_prior_scale': 0.4494239836029108, 'n_changepoints': 36}. Best is trial 1 with value: 2.1347720992409487.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.36it/s]100%|##########| 2/2 [00:01<00:00,  1.52it/s]100%|##########| 2/2 [00:01<00:00,  1.50it/s]
[I 2025-05-23 20:55:50,869] Trial 6 finished with value: 2.133375182603473 and parameters: {'changepoint_prior_scale': 0.007326605574603489, 'seasonality_prior_scale': 0.014525109137961859, 'n_changepoints': 5}. Best is trial 6 with value: 2.133375182603473.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.49s/it]100%|##########| 2/2 [00:03<00:00,  1.45s/it]100%|##########| 2/2 [00:03<00:00,  1.61s/it]
[I 2025-05-23 20:55:55,430] Trial 7 finished with value: 2.5045318795342477 and parameters: {'changepoint_prior_scale': 0.14307881187938076, 'seasonality_prior_scale': 0.2189851432877871, 'n_changepoints': 50}. Best is trial 6 with value: 2.133375182603473.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.35s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.22s/it]100%|##########| 2/2 [00:02<00:00,  1.24s/it]
[I 2025-05-23 20:55:59,055] Trial 8 finished with value: 2.4631781622168263 and parameters: {'changepoint_prior_scale': 0.0010592355360385325, 'seasonality_prior_scale': 0.20146611097299105, 'n_changepoints': 20}. Best is trial 6 with value: 2.133375182603473.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.61s/it]100%|##########| 2/2 [00:02<00:00,  1.07s/it]100%|##########| 2/2 [00:02<00:00,  1.15s/it]
[I 2025-05-23 20:56:02,372] Trial 9 finished with value: 2.3357193252028723 and parameters: {'changepoint_prior_scale': 0.08345825884060622, 'seasonality_prior_scale': 0.030444940011388533, 'n_changepoints': 32}. Best is trial 6 with value: 2.133375182603473.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:00<00:00,  1.06it/s]100%|##########| 2/2 [00:01<00:00,  1.42it/s]100%|##########| 2/2 [00:01<00:00,  1.35it/s]
Rendimiento para la combinación BMX_997-BMX_TRADICIONAL-BMX_3402:
  horizon       mse      rmse       mae     mdape     smape  coverage
0 21 days  1.746139  1.321415  1.042115  0.285462  0.582824  1.000000
1 28 days  1.789062  1.337558  0.927864  0.191493  0.296578  0.833333
2 35 days  2.405495  1.550966  1.204646  0.311411  0.346569  0.833333
3 42 days  5.891966  2.427337  2.185497  0.466701  0.572331  0.500000
4 49 days  6.780994  2.604034  2.365861  0.559098  0.815906  0.500000
          ds      yhat  yhat_lower  yhat_upper      y     cutoff
0 2022-10-24  3.667992    1.025829    6.369157  5.833 2022-10-17
1 2022-10-31  3.324633    0.589033    6.118301  3.000 2022-10-17
2 2022-11-07  4.038481    1.342626    6.760619  4.000 2022-10-17
3 2022-11-14  4.038568    1.312329    6.854321  7.000 2022-10-17
4 2022-11-21  3.011957    0.504954    5.956142  1.833 2022-10-17
Contenido de df_prophet antes de model.fit:
            ds      y  day_of_week  week_of_year  month
0   2021-01-04   49.0            0             1      1
1   2021-01-11   34.0            0             2      1
2   2021-01-18   63.0            0             3      1
3   2021-01-25   41.0            0             4      1
4   2021-02-01   32.0            0             5      2
..         ...    ...          ...           ...    ...
151 2023-11-27  131.0            0            48     11
152 2023-12-04   80.0            0            49     12
153 2023-12-11  100.0            0            50     12
154 2023-12-18  132.0            0            51     12
155 2023-12-25  101.0            0            52     12

[156 rows x 5 columns]
[I 2025-05-23 20:56:04,711] A new study created in memory with name: no-name-238632c5-d510-4874-9d2b-e5d59c527076
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.22s/it]100%|##########| 2/2 [00:01<00:00,  1.13it/s]100%|##########| 2/2 [00:01<00:00,  1.07it/s]
[I 2025-05-23 20:56:07,528] Trial 0 finished with value: 25.843935508577996 and parameters: {'changepoint_prior_scale': 0.06331064422679333, 'seasonality_prior_scale': 0.1829847654299315, 'n_changepoints': 13}. Best is trial 0 with value: 25.843935508577996.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.08s/it]100%|##########| 2/2 [00:01<00:00,  1.23it/s]100%|##########| 2/2 [00:01<00:00,  1.17it/s]
[I 2025-05-23 20:56:10,062] Trial 1 finished with value: 36.607669125458855 and parameters: {'changepoint_prior_scale': 0.003733157206079662, 'seasonality_prior_scale': 7.614854109126606, 'n_changepoints': 5}. Best is trial 0 with value: 25.843935508577996.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.42s/it]100%|##########| 2/2 [00:03<00:00,  1.37s/it]100%|##########| 2/2 [00:03<00:00,  1.52s/it]
[I 2025-05-23 20:56:14,265] Trial 2 finished with value: 30.226166505330955 and parameters: {'changepoint_prior_scale': 0.3596802055332909, 'seasonality_prior_scale': 0.5452070192844758, 'n_changepoints': 35}. Best is trial 0 with value: 25.843935508577996.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.33s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:03<00:00,  1.65s/it]100%|##########| 2/2 [00:03<00:00,  1.61s/it]
[I 2025-05-23 20:56:19,492] Trial 3 finished with value: 42.64493919568452 and parameters: {'changepoint_prior_scale': 0.005492423175256367, 'seasonality_prior_scale': 0.1324508959090256, 'n_changepoints': 39}. Best is trial 0 with value: 25.843935508577996.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.41s/it]100%|##########| 2/2 [00:02<00:00,  1.02it/s]100%|##########| 2/2 [00:02<00:00,  1.05s/it]
[I 2025-05-23 20:56:22,608] Trial 4 finished with value: 37.48370145804911 and parameters: {'changepoint_prior_scale': 0.027556398453222865, 'seasonality_prior_scale': 0.05689673701709869, 'n_changepoints': 15}. Best is trial 0 with value: 25.843935508577996.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
Optimization terminated abnormally. Falling back to Newton.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.23s/it]Optimization terminated abnormally. Falling back to Newton.
100%|##########| 2/2 [00:02<00:00,  1.37s/it]100%|##########| 2/2 [00:02<00:00,  1.35s/it]
[I 2025-05-23 20:56:27,169] Trial 5 finished with value: 40.92537351068854 and parameters: {'changepoint_prior_scale': 0.002578839722179169, 'seasonality_prior_scale': 0.015011083190134741, 'n_changepoints': 47}. Best is trial 0 with value: 25.843935508577996.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.30s/it]100%|##########| 2/2 [00:02<00:00,  1.04it/s]100%|##########| 2/2 [00:02<00:00,  1.01s/it]
[I 2025-05-23 20:56:30,305] Trial 6 finished with value: 36.54392787632684 and parameters: {'changepoint_prior_scale': 0.03169239273477994, 'seasonality_prior_scale': 1.9867846746578761, 'n_changepoints': 7}. Best is trial 0 with value: 25.843935508577996.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:02<00:02,  2.10s/it]100%|##########| 2/2 [00:02<00:00,  1.28s/it]100%|##########| 2/2 [00:02<00:00,  1.41s/it]
[I 2025-05-23 20:56:34,309] Trial 7 finished with value: 24.39980683551042 and parameters: {'changepoint_prior_scale': 0.11488195698354182, 'seasonality_prior_scale': 0.14906956131390103, 'n_changepoints': 16}. Best is trial 7 with value: 24.39980683551042.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.06s/it]100%|##########| 2/2 [00:01<00:00,  1.32it/s]100%|##########| 2/2 [00:01<00:00,  1.25it/s]
[I 2025-05-23 20:56:36,732] Trial 8 finished with value: 37.070099109125266 and parameters: {'changepoint_prior_scale': 0.006085632987777861, 'seasonality_prior_scale': 0.18711992887654433, 'n_changepoints': 8}. Best is trial 7 with value: 24.39980683551042.
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:103: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cps = trial.suggest_loguniform("changepoint_prior_scale", 0.001, 0.5)
C:\LocalHost\OptiBack\modulo_demanda\Algoritmo_Prophet\forecast_model.py:104: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  sps = trial.suggest_loguniform("seasonality_prior_scale", 0.01, 10.0)
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.13s/it]100%|##########| 2/2 [00:01<00:00,  1.23it/s]100%|##########| 2/2 [00:01<00:00,  1.16it/s]
[I 2025-05-23 20:56:39,472] Trial 9 finished with value: 42.315533907315825 and parameters: {'changepoint_prior_scale': 0.008940557389891983, 'seasonality_prior_scale': 0.2800656635329431, 'n_changepoints': 22}. Best is trial 7 with value: 24.39980683551042.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|#####     | 1/2 [00:01<00:01,  1.45s/it]100%|##########| 2/2 [00:02<00:00,  1.06it/s]100%|##########| 2/2 [00:02<00:00,  1.02s/it]
Rendimiento para la combinación BMX_997-BMX_TRADICIONAL-BMX_3931:
  horizon         mse       rmse  ...     mdape     smape  coverage
0 21 days  588.797505  24.265150  ...  0.213539  0.190977  0.333333
1 28 days  583.779536  24.161530  ...  0.225179  0.187151  0.333333
2 35 days  285.230205  16.888760  ...  0.139004  0.141110  0.500000
3 42 days  230.756075  15.190657  ...  0.097234  0.126281  0.666667
4 49 days  235.910693  15.359385  ...  0.121048  0.125364  0.666667

[5 rows x 8 columns]
          ds        yhat  yhat_lower  yhat_upper        y     cutoff
0 2022-10-24  132.695788  114.985452  150.564331  120.000 2022-10-17
1 2022-10-31  108.233294   88.945838  125.708357  128.833 2022-10-17
2 2022-11-07  114.040509   95.218114  131.185992  118.667 2022-10-17
3 2022-11-14  119.383781  101.893204  136.627460  125.500 2022-10-17
4 2022-11-21  142.823643  124.560224  160.113851  138.000 2022-10-17
       Fecha  Demanda Real  ...              Canal  Ubicacion
0 2021-01-04         435.0  ...  BMX_AUTOSERVICIOS   BMX_3001
1 2021-01-11         809.0  ...  BMX_AUTOSERVICIOS   BMX_3001
2 2021-01-18         641.0  ...  BMX_AUTOSERVICIOS   BMX_3001
3 2021-01-25         777.0  ...  BMX_AUTOSERVICIOS   BMX_3001
4 2021-02-01         770.0  ...  BMX_AUTOSERVICIOS   BMX_3001

[5 rows x 7 columns]
      Producto              Canal  ... Demanda Predicha        forecast_date
0     BMX_1727  BMX_AUTOSERVICIOS  ...       650.028305  2025-05-23T20:20:13
1     BMX_1727  BMX_AUTOSERVICIOS  ...       673.457559  2025-05-23T20:20:13
2     BMX_1727  BMX_AUTOSERVICIOS  ...       733.765942  2025-05-23T20:20:13
3     BMX_1727  BMX_AUTOSERVICIOS  ...       704.046845  2025-05-23T20:20:13
4     BMX_1727  BMX_AUTOSERVICIOS  ...       697.143165  2025-05-23T20:20:13
...        ...                ...  ...              ...                  ...
2699   BMX_997    BMX_TRADICIONAL  ...       112.359061  2025-05-23T20:20:13
2700   BMX_997    BMX_TRADICIONAL  ...        91.527830  2025-05-23T20:20:13
2701   BMX_997    BMX_TRADICIONAL  ...        98.566350  2025-05-23T20:20:13
2702   BMX_997    BMX_TRADICIONAL  ...       106.720610  2025-05-23T20:20:13
2703   BMX_997    BMX_TRADICIONAL  ...       124.734810  2025-05-23T20:20:13

[2704 rows x 6 columns]
   Producto              Canal Ubicacion      WMAPE      SMAPE
0  BMX_1727  BMX_AUTOSERVICIOS  BMX_3001  18.760564  19.345196
1  BMX_1727  BMX_AUTOSERVICIOS  BMX_3207  31.346873  36.009545
2  BMX_1727  BMX_AUTOSERVICIOS  BMX_3402  33.268504  38.211385
3  BMX_1727  BMX_AUTOSERVICIOS  BMX_3931  23.418616  23.291593
4  BMX_1727          BMX_HOGAR  BMX_3001  27.675940  45.397911
